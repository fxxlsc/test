/*! 
* WeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
* Licensed under Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) 
*/

/*! 
 * WeX5 v3 (http://www.justep.com) 
 * Copyright 2015 Justep, Inc.
 * Licensed under Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) 
 */

/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 1.0.2
 * @codingstandard ftlabs-jsv2
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */

/*!
 * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */

/*!
 * Bootstrap v3.3.2 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

/* ========================================================================
 * Bootstrap: transition.js v3.3.2
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: alert.js v3.3.2
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.3.2
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: carousel.js v3.3.2
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.3.2
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.3.2
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.3.2
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.3.2
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.3.2
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: scrollspy.js v3.3.2
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tab.js v3.3.2
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.3.2
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/*!
* Modified from jQuery MobiScroll v1.0.2
* http://mobiscroll.com
*
* Copyright 2010-2011, Acid Media
* Licensed under the MIT license.
*
*/

/*! 
* BeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
*/

function FastClick(e,t){function r(e,t){return function(){return e.apply(t,arguments)}}var n;t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=e,this.tapDelay=t.tapDelay||200;if(FastClick.notNeeded(e)){window.fastClickNeeded=!1;return}window.fastClickNeeded=!0;var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],s=this;for(var o=0,u=i.length;o<u;o++)s[i[o]]=r(s[i[o]],s);deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,r){var i=Node.prototype.removeEventListener;t==="click"?i.call(e,t,n.hijacked||n,r):i.call(e,t,n,r)},e.addEventListener=function(t,n,r){var i=Node.prototype.addEventListener;t==="click"?i.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),r):i.call(e,t,n,r)}),typeof e.onclick=="function"&&(n=e.onclick,e.addEventListener("click",function(e){n(e)},!1),e.onclick=null)}define("$model/UI2/system/components/justep/common/res",["require","$UI/system/lib/justep","css!../../bootstrap/lib/css/bootstrap","css!../../bootstrap/lib/css/bootstrap-theme","css!./css/forms","css!./css/forms.pc","css!./css/IE/input.ie","css!./css/IE/radio.ie8","css!./css/IE/button.ie9","css!./css/IE/labelEdit.ie9","css!./css/ios"],function(e){var t=e("$UI/system/lib/justep");e("css!../../bootstrap/lib/css/bootstrap").load(),e("css!../../bootstrap/lib/css/bootstrap-theme").load(),e("css!./css/forms").load(),t.Browser.isPC&&e("css!./css/forms.pc").load(),t.Browser.IE&&e("css!./css/IE/input.ie").load(),t.Browser.IE8&&e("css!./css/IE/radio.ie8").load();if(t.Browser.IE8||t.Browser.IE9)e("css!./css/IE/button.ie9").load(),e("css!./css/IE/labelEdit.ie9").load();(t.Browser.isIphone||t.Browser.isIpad)&&e("css!./css/ios").load()}),define("$model/UI2/system/components/justep/windowContainer/windowContainer.config",["require"],function(e){return{properties:{src:"string",routable:"boolean",process:"string",activity:"string",autoLoad:"boolean",useCurrentProcessActivity:"boolean"},events:["onBeforeLoad","onLoad","onLoadError","onViewLoad","onReceive"],binds:{params:"params"}}}),define("$model/UI2/system/components/justep/windowContainer/windowContainer",["require","jquery","$UI/system/lib/justep","$UI/system/lib/base/composition","./windowContainer.config","$UI/system/lib/route/routeUtil"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/lib/base/composition"),i=e.normalizeName("./windowContainer"),s=e("./windowContainer.config"),o=e("$UI/system/lib/route/routeUtil"),u="__inner-model__",a=n.ViewComponent.extend({constructor:function(e){this.__windowContainerInited=!1,this.callParent(e),this.autoLoad=!0,this.curSrc="",this.src="",this.process="",this.activity="",this._composeOK=t.Deferred(),this.routable=!1,this._isFirst=!0,this.useCurrentProcessActivity=!0,this._isloaded=!1,this._callbacks=[]},done:function(e){typeof e=="function"&&(this._isloaded&&e(),this._callbacks[this._callbacks.length]=e)},controlsDescendantBindings:function(){return!0},dispose:function(){if(this._activeHandle){var e=this.getModel();e.off(n.ModelBase.ACTIVE_EVENT,this._activeHandle)}this._callbacks=[],this.callParent()},getConfig:function(){return s},buildTemplate:function(e){var r=t("<div component='"+i+"' __component-context__='block' />");return e&&(this.src=e.src,this.process=e.process,this.activity=e.activity,e.hasOwnProperty("useCurrentProcessActivity")&&(this.useCurrentProcessActivity=e.useCurrentProcessActivity),this.owner=e.owner,e.params&&!n.Util.isString(e.params)&&(this.params=e.params||null,delete e.params),e.xid&&r.attr("xid",e.xid)),r},init:function(e,t){this.__windowContainerInited=!0,this.callParent(e,t);var r=this.params;!this.params&&e&&e.params&&(r=e.params),this.autoLoad?this.refresh(null,r):r&&(this.params=r);var i=this,s=this.getModel();this._activeHandle=function(e){var t=i.getInnerModel();t&&t&&t.fireEvent(n.ModelBase.ACTIVE_EVENT,{source:t})},s.on(n.ModelBase.ACTIVE_EVENT,this._activeHandle)},setSrc:function(e){this.set({src:e})},setProcess:function(e){this.set({process:e})},setActivity:function(e){this.set({activity:e})},doRoute:function(e,t,n){if(!this.routable)return;if(e===""){var r,i,s=this;if(n=="enter")if(o.containeInnerState(t)){var u=o.getParamValue(t);i=o.getInnerStateValue(t);try{r=JSON.parse(u)}catch(a){}this.refresh(r.src,r.params),this._composeOK&&this._composeOK.done(function(){var e=s.getInnerModel();e.postMessage({type:"routeState",newUrl:i})})}else{try{r=JSON.parse(t)}catch(a){}this.refresh(r.src,r.params)}else n!="leave"&&n=="update"&&(i=o.getInnerStateValue(t),this._composeOK&&this._composeOK.done(function(){var e=s.getInnerModel();e.postMessage({type:"routeState",newUrl:i})}))}},addRouteItem:function(e,n){if(!this.routable)return;var r=this.getModel().$routeState,i=this.$domNode.attr("xid");if(e=="load")try{n&&(n=t.extend({},n),delete n.data),r.addState(i,"",JSON.stringify(n)),r.publishState()}catch(s){}else e=="destory"&&(r.removeState(i,"",""),r.publishState())},addRouteInnerItem:function(e,t,n){if(!this.routable)return;var r=this.getModel().$routeState,i=this.$domNode.attr("xid");this.getInnerModel()&&(r.addInnerState(i,"",t),r.publishState(n))},refresh:function(e,t){this._load(e,t,!0)},load:function(e,t){this._load(e,t,!1)},_load:function(e,n,r){if(this.__windowContainerInited){this._composeOK=t.Deferred();var i=e;i&&this.set({src:i}),i=this.get("src");if(i){n=n||this.params;var s={source:this,src:i,params:n,cancel:!1};this.fireEvent(a.BEFORE_LOAD_EVENT,s);if(s.cancel)return;this.params=n,i=this._prepareSrc(i),this.addRouteItem("load",{src:i,params:this.params}),r||this._mustRefresh(i)?this._refresh(i,s.params):(this._doSetParams(s.params),this._composeOK.resolve())}}},_doSetParams:function(e){var t=null;try{t=this.getInnerModel()}catch(n){}t&&t.setParams(e)},_mustRefresh:function(t){if(!this.getInnerModel()||!this.curSrc||!t)return!0;var r=new n.URL(e.toUrl(t)),i=new n.URL(e.toUrl(this.curSrc));if(r.getPathname()==i.getPathname()){for(var s in r.params)if(r.params.hasOwnProperty(s))if(!i.params.hasOwnProperty(s)||r.params[s]!==i.params[s])return!0;for(var s in i.params)if(i.params.hasOwnProperty(s)&&!r.params.hasOwnProperty(s))return!0;return!1}return!0},_refresh:function(e,i){this._isloaded=!1;if(!(this._isFirst&&this.$domNode.children().length>0))for(var s=this.domNode.childNodes.length-1;s>=0;s--)n.Bind.removeNode(this.domNode.childNodes[s]);this._isFirst=!1;if(!e)return;var o=this._addDefaultParams(e),u={activate:!0,params:i,owner:this.owner||this};u.model=o,u.preserveContext=!0;var f=this;u.loadError=function(e){var t={source:f,err:e,cancel:!1};return f.fireEvent(a.LOAD_ERROR_EVENT,t),t.cancel},u.src=o,u.viewLoad=function(){f.curSrc=e;var n=t.Deferred(),r={source:f,cancel:!1,dtd:n,async:!1};return f.fireEvent(a.VIEW_LOAD_EVENT,r),r.async||n.resolve(),n.promise()},this.$domNode.children().length>0&&(u.view=this.$domNode.children()[0]),r.compose(this.domNode,u)},_prepareSrc:function(e){if(e&&this.useCurrentProcessActivity&&e.indexOf("process=")==-1&&e.indexOf("activity=")==-1){var t=this.get("process"),n=this.get("activity");t&&n&&(e+=e.indexOf("?")==-1?"?":"&",e+="process="+t+"&activity="+n)}return e},_addDefaultParams:function(e){var t=this.getModel().getContext();if(e&&t){t.getProcess&&t.getActivity&&this.useCurrentProcessActivity&&(process=t.getProcess(),activity=t.getActivity(),e.indexOf("process=")==-1&&e.indexOf("activity=")==-1&&process&&activity&&(e+=e.indexOf("?")==-1?"?":"&",e+="process="+process+"&activity="+activity));if(t.getExecutor&&e.indexOf("executor=")==-1){var n=t.getExecutor();n&&(e+=e.indexOf("?")==-1?"?":"&",e+="executor="+n)}if(t.getExecuteContext&&e.indexOf("executeContext=")==-1){var r=t.getExecuteContext();r&&(e+=e.indexOf("?")==-1?"?":"&",e+="executeContext="+r)}t.getBSessionID&&t.getBSessionID()&&(e+=e.indexOf("?")==-1?"?":"&",e+="bsessionid="+t.getBSessionID())}return e},getInnerModel:function(){try{return n.Bind.utils.domData.get(this.domNode,u)}catch(e){return}},loaded:function(){this.fireEvent(a.LOAD_EVENT,{source:this}),this._prepareRouteStateChannel(),this._composeOK.resolve();for(var e=0;e<this._callbacks.length;e++)this._callbacks[e]();this._isloaded=!0},_prepareRouteStateChannel:function(){var e=this;this.getInnerModel().off("onRouteStatePublish");var t=function(t){e.routable&&e.addRouteInnerItem("",t.hashbang,t.isReplace),e.fireEvent("onRouteStatePublish",t),e._prepareRouteStateChannel._lastHashbang=t.hashbang};this.getInnerModel().on("onRouteStatePublish",function(e){t(e)},this),t({isReplace:!0,hashbang:this.getInnerModel().$routeState.toHashbang()})},send:function(e){this.isDestroy||this.fireEvent(a.RECEIVE_EVENT,{source:this,data:e})},setParams:function(e){this.params=e}});return n.Component.addOperations(a,{containerRefresh:{label:n.Message.getMessage(n.Message.JUSTEP231007),argsDef:[{name:"url",displayName:"url"},{name:"param",displayName:"param"}],method:function(e){return this.owner.refresh(e.url,e.param)}}}),a.RECEIVE_EVENT="onReceive",a.BEFORE_LOAD_EVENT="onBeforeLoad",a.LOAD_EVENT="onLoad",a.LOAD_ERROR_EVENT="onLoadError",a.VIEW_LOAD_EVENT="onViewLoad",n.Component.register(i,a),a}),define("$model/UI2/system/components/justep/common/utils",["require","jquery","$UI/system/components/justep/windowContainer/windowContainer"],function(e){var t=e("jquery"),n=e("$UI/system/components/justep/windowContainer/windowContainer");return{loadContent:function(e,t,r,i){var s=e.getContent(t);s||(s=e.add({xid:t}));var o=s.$domNode.get(0),u=new n({parentNode:o,src:r,onLoad:function(){i&&i(),s.on("onActive",function(){u.getInnerModel()&&u.getInnerModel().fireEvent("onActive")})},onLoadError:function(e){i&&i(e)}});return s.innerContainer=u,s},attachDoubleClickExitApp:function(e){var n=t.Deferred();return this.attached===!0?n.reject():(this.attached=!0,document.addEventListener("deviceready",function(){var r=0,i=function(){if(e())if(r===0){r++;var i=t('<div style="display: none;z-index:99999;position: fixed;width: 100%;bottom: 25px;text-align: center;"><span style="font-size:18px;border-radius: 3px;padding: 7px;background-color: #383838;color: #F0F0F0;">再按一次退出应用</span></div>').appendTo("body");i.fadeIn(400).delay(2e3).fadeOut(400,function(){r=0,i.remove()})}else r==1&&(n.resolve(),navigator.app.exitApp());else t("html").hasClass("x-focus-in")?t("html").removeClass("x-focus-in"):history.back()};document.addEventListener("backbutton",i,!1),t(window).on("beforeunload",function(){document.removeEventListener("backbutton",i,!1)})},!1)),n.promise()},getShareUrl:function(e){var t=new justep.URL(e||location.href);if(t.getHash()){var n=t.getHash();t.setParam("_shareHash",n),t.setHash()}return t.toString()}}});var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(deviceIsIOS&&e.type==="file"||deviceIsIOS&&e.type==="range"||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){t.fastclickSended=!0;var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},FastClick.prototype.determineEventType=function(e){return deviceIsAndroid&&e.tagName.toLowerCase()==="select"?"mousedown":"click"},FastClick.prototype.focus=function(e){var t;deviceIsIOS&&e.setSelectionRange&&e.type.indexOf("date")!==0&&e.type!=="number"&&e.type!=="time"&&e.type!=="month"&&e.type!=="range"?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,n,r;if(e.targetTouches.length>1)return!0;t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0];if(deviceIsIOS){r=window.getSelection();if(r.rangeCount&&!r.isCollapsed)return!0;if(document.activeElement.contentEditable=="true"&&(document.activeElement==e.target||document.activeElement==e.target.parentNode))return!0;if(!deviceIsIOS4){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},FastClick.prototype.findControl=function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){e.fastclickHandle=!0;var t,n,r,i,s,o=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(s=e.changedTouches[0],o=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),r=o.tagName.toLowerCase();if(r==="label"){t=this.findControl(o);if(t){this.focus(o);if(deviceIsAndroid)return!1;o=t}}else if(this.needsFocus(o)){if(e.timeStamp-n>100||deviceIsIOS&&window.top!==window&&r==="input")return this.targetElement=null,!1;this.focus(o),this.sendClick(o,e);if(!deviceIsIOS||r!=="select")this.targetElement=null,e.preventDefault();return!1}if(deviceIsIOS&&!deviceIsIOS4){i=o.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop)return!0}return this.needsClick(o)||(e.preventDefault(),this.sendClick(o,e)),!1},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):e.target.type==="submit"&&e.detail===0?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){var e=this.layer;deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t,n;if(typeof window.ontouchstart=="undefined")return!0;n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(n){if(!deviceIsAndroid)return!0;t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1)return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}return e.style.msTouchAction==="none"?!0:!1},FastClick.attach=function(e,t){return new FastClick(e,t)},typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("$model/UI2/system/components/justep/lib/fastclick",[],function(){return FastClick}):typeof module!="undefined"&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,define("$model/UI2/system/components/justep/scrollView/lib/iscroll",["require","exports","module"],function(e,t,n){(function(e,n){function _(e){return s===""?e:(e=e.charAt(0).toUpperCase()+e.substr(1),s+e)}var r=Math,i=n.createElement("div").style,s=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,r=e.length;for(;n<r;n++){t=e[n]+"ransform";if(t in i)return e[n].substr(0,e[n].length-1)}return!1}(),o=s?"-"+s.toLowerCase()+"-":"",u=_("transform"),a=_("transitionProperty"),f=_("transitionDuration"),l=_("transformOrigin"),c=_("transitionTimingFunction"),h=_("transitionDelay"),p=/android/gi.test(navigator.appVersion),d=/iphone|ipad/gi.test(navigator.appVersion),v=/hp-tablet/gi.test(navigator.appVersion),m=_("perspective")in i,g="ontouchstart"in e&&!v,y=s!==!1,b=_("transition")in i,w="onorientationchange"in e?"orientationchange":"resize",E=g?"touchstart":"mousedown",S=g?"touchmove":"mousemove",x=g?"touchend":"mouseup",T=g?"touchcancel":"mouseup",N=function(){if(s===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[s]}(),C=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),k=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),L=m?" translateZ(0)":"",A=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),O=function(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1},M=function(t,r){var i=this,s;i.wrapper=typeof t=="object"?t:n.getElementById(t),i.wrapper.style.overflow="hidden",i.scroller=i.wrapper.children[0],i.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},hScrollbar:!0,vScrollbar:!0,fixedScrollbar:p,hideScrollbar:d,fadeScrollbar:d&&m,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){!A&&!O(e.target,this.options.preventDefaultException)&&e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(s in r)i.options[s]=r[s];i.x=i.options.x,i.y=i.options.y,i.options.useTransform=y&&i.options.useTransform,i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar,i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar,i.options.zoom=i.options.useTransform&&i.options.zoom,i.options.useTransition=b&&i.options.useTransition,i.options.zoom&&p&&(L=""),i.scroller.style[a]=i.options.useTransform?o+"transform":"top left",i.scroller.style[f]="0",i.scroller.style[l]="0 0",i.options.useTransition&&(i.scroller.style[c]="cubic-bezier(0.33,0.66,0.66,1)"),i.options.useTransform?i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px)"+L:i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px",i.options.useTransition&&(i.options.fixedScrollbar=!0),i.refresh(),i._bind(w,e),i._bind(E),g||i.options.wheelAction!="none"&&(i._bind("DOMMouseScroll"),i._bind("mousewheel")),i.options.checkDOMChanges&&(i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500))};M.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case E:if(!g&&e.button!==0)return;t._start(e);break;case S:t._move(e);break;case x:case T:t._end(e);break;case w:t._resize();break;case"DOMMouseScroll":case"mousewheel":t._wheel(e);break;case N:t._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var t=this,i;if(!t[e+"Scrollbar"]){t[e+"ScrollbarWrapper"]&&(y&&(t[e+"ScrollbarIndicator"].style[u]=""),t[e+"ScrollbarWrapper"].parentNode.removeChild(t[e+"ScrollbarWrapper"]),t[e+"ScrollbarWrapper"]=null,t[e+"ScrollbarIndicator"]=null);return}t[e+"ScrollbarWrapper"]||(i=n.createElement("div"),t.options.scrollbarClass?i.className=t.options.scrollbarClass+e.toUpperCase():i.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:4px;bottom:1px;left:2px;right:"+(t.vScrollbar?"4":"2")+"px":"width:4px;bottom:"+(t.hScrollbar?"4":"2")+"px;top:2px;right:1px"),i.style.cssText+=";pointer-events:none;"+o+"transition-property:opacity;"+o+"transition-duration:"+(t.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(t.options.hideScrollbar?"0":"1"),t.wrapper.appendChild(i),t[e+"ScrollbarWrapper"]=i,i=n.createElement("div"),t.options.scrollbarClass||(i.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+o+"background-clip:padding-box;"+o+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+o+"border-radius:3px;border-radius:3px"),i.style.cssText+=";pointer-events:none;"+o+"transition-property:"+o+"transform;"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+o+"transition-duration:0;"+o+"transform: translate(0,0)"+L,t.options.useTransition&&(i.style.cssText+=";"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),t[e+"ScrollbarWrapper"].appendChild(i),t[e+"ScrollbarIndicator"]=i),e=="h"?(t.hScrollbarSize=t.hScrollbarWrapper.clientWidth,t.hScrollbarIndicatorSize=r.max(r.round(t.hScrollbarSize*t.hScrollbarSize/t.scrollerW),8),t.hScrollbarIndicator.style.width=t.hScrollbarIndicatorSize+"px",t.hScrollbarMaxScroll=t.hScrollbarSize-t.hScrollbarIndicatorSize,t.hScrollbarProp=t.hScrollbarMaxScroll/t.maxScrollX):(t.vScrollbarSize=t.vScrollbarWrapper.clientHeight,t.vScrollbarIndicatorSize=r.max(r.round(t.vScrollbarSize*t.vScrollbarSize/t.scrollerH),8),t.vScrollbarIndicator.style.height=t.vScrollbarIndicatorSize+"px",t.vScrollbarMaxScroll=t.vScrollbarSize-t.vScrollbarIndicatorSize,t.vScrollbarProp=t.vScrollbarMaxScroll/t.maxScrollY),t._scrollbarPos(e,!0)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},p?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0,t=this.vScroll?t:0,this.options.useTransform?this.scroller.style[u]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+L:(e=r.round(e),t=r.round(t),this.scroller.style.left=e+"px",this.scroller.style.top=t+"px"),this.x=e,this.y=t,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(e,t){var n=this,i=e=="h"?n.x:n.y,s;if(!n[e+"Scrollbar"])return;i=n[e+"ScrollbarProp"]*i,i<0?(n.options.fixedScrollbar||(s=n[e+"ScrollbarIndicatorSize"]+r.round(i*3),s<8&&(s=8),n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"),i=0):i>n[e+"ScrollbarMaxScroll"]&&(n.options.fixedScrollbar?i=n[e+"ScrollbarMaxScroll"]:(s=n[e+"ScrollbarIndicatorSize"]-r.round((i-n[e+"ScrollbarMaxScroll"])*3),s<8&&(s=8),n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px",i=n[e+"ScrollbarMaxScroll"]+(n[e+"ScrollbarIndicatorSize"]-s))),n[e+"ScrollbarWrapper"].style[h]="0",n[e+"ScrollbarWrapper"].style.opacity=t&&n.options.hideScrollbar?"0":"1",n[e+"ScrollbarIndicator"].style[u]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+L},_start:function(t){var n=this,i=g?t.touches[0]:t,s,o,a,f,l;if(!n.enabled)return;n.options.onBeforeScrollStart&&n.options.onBeforeScrollStart.call(n,t),(n.options.useTransition||n.options.zoom)&&n._transitionTime(0),n.moved=!1,n.animating=!1,n.zoomed=!1,n.distX=0,n.distY=0,n.absDistX=0,n.absDistY=0,n.dirX=0,n.dirY=0,n.options.zoom&&g&&t.touches.length>1&&(f=r.abs(t.touches[0].pageX-t.touches[1].pageX),l=r.abs(t.touches[0].pageY-t.touches[1].pageY),n.touchesDistStart=r.sqrt(f*f+l*l),n.originX=r.abs(t.touches[0].pageX+t.touches[1].pageX-n.wrapperOffsetLeft*2)/2-n.x,n.originY=r.abs(t.touches[0].pageY+t.touches[1].pageY-n.wrapperOffsetTop*2)/2-n.y,n.options.onZoomStart&&n.options.onZoomStart.call(n,t));if(n.options.momentum){n.options.useTransform?(s=getComputedStyle(n.scroller,null)[u].replace(/[^0-9\-.,]/g,"").split(","),o=+(s[12]||s[4]),a=+(s[13]||s[5])):(o=+getComputedStyle(n.scroller,null).left.replace(/[^0-9-]/g,""),a=+getComputedStyle(n.scroller,null).top.replace(/[^0-9-]/g,""));if(o!=n.x||a!=n.y)n.options.useTransition?n._unbind(N):k(n.aniTime),n.steps=[],n._pos(o,a),n.options.onScrollEnd&&n.options.onScrollEnd.call(n)}n.absStartX=n.x,n.absStartY=n.y,n.startX=n.x,n.startY=n.y,n.pointX=i.pageX,n.pointY=i.pageY,n.startTime=t.timeStamp||Date.now(),n.options.onScrollStart&&n.options.onScrollStart.call(n,t),n._bind(S,e),n._bind(x,e),n._bind(T,e)},_move:function(e){var t=this,n=g?e.touches[0]:e,i=n.pageX-t.pointX,s=n.pageY-t.pointY,o=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();O(e.target,this.options.preventDefaultException)||e.preventDefault(),t.options.onBeforeScrollMove&&t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&g&&e.touches.length>1){f=r.abs(e.touches[0].pageX-e.touches[1].pageX),l=r.abs(e.touches[0].pageY-e.touches[1].pageY),t.touchesDist=r.sqrt(f*f+l*l),t.zoomed=!0,c=1/t.touchesDistStart*t.touchesDist*this.scale,c<t.options.zoomMin?c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin):c>t.options.zoomMax&&(c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c)),t.lastScale=c/this.scale,o=this.originX-this.originX*t.lastScale+this.x,a=this.originY-this.originY*t.lastScale+this.y,this.scroller.style[u]="translate("+o+"px,"+a+"px) scale("+c+")"+L,t.options.onZoom&&t.options.onZoom.call(t,e);return}t.pointX=n.pageX,t.pointY=n.pageY;if(o>0||o<t.maxScrollX)o=t.options.bounce?t.x+i/2:o>=0||t.maxScrollX>=0?0:t.maxScrollX;if(a>t.minScrollY||a<t.maxScrollY)a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY;t.distX+=i,t.distY+=s,t.absDistX=r.abs(t.distX),t.absDistY=r.abs(t.distY);if(t.absDistX<6&&t.absDistY<6)return;t.options.lockDirection&&(t.absDistX>t.absDistY+5?(a=t.y,s=0):t.absDistY>t.absDistX+5&&(o=t.x,i=0)),t.moved=!0,t._pos(o,a),t.dirX=i>0?-1:i<0?1:0,t.dirY=s>0?-1:s<0?1:0,h-t.startTime>300&&(t.startTime=h,t.startX=t.x,t.startY=t.y),t.options.onScrollMove&&t.options.onScrollMove.call(t,e)},_end:function(t){if(g&&t.touches.length!==0)return;var i=this,s=g?t.changedTouches[0]:t,o,a,l={dist:0,time:0},c={dist:0,time:0},h=(t.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,m,y,b,w;i._unbind(S,e),i._unbind(x,e),i._unbind(T,e),O(t.target,this.options.preventDefaultException)||t.preventDefault(),i.options.onBeforeScrollEnd&&i.options.onBeforeScrollEnd.call(i,t);if(i.zoomed){w=i.scale*i.lastScale,w=Math.max(i.options.zoomMin,w),w=Math.min(i.options.zoomMax,w),i.lastScale=w/i.scale,i.scale=w,i.x=i.originX-i.originX*i.lastScale+i.x,i.y=i.originY-i.originY*i.lastScale+i.y,i.scroller.style[f]="200ms",i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+L,i.zoomed=!1,i.refresh(),i.options.onZoomEnd&&i.options.onZoomEnd.call(i,t);return}if(!i.moved){g&&(i.doubleTapTimer&&i.options.zoom?(clearTimeout(i.doubleTapTimer),i.doubleTapTimer=null,i.options.onZoomStart&&i.options.onZoomStart.call(i,t),i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1),i.options.onZoomEnd&&setTimeout(function(){i.options.onZoomEnd.call(i,t)},200)):this.options.handleClick&&(e.fastClickNeeded?t.fastclickSended||(i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null,o=s.target;while(o.nodeType!=1)o=o.parentNode;o.tagName!="SELECT"&&o.tagName!="INPUT"&&o.tagName!="TEXTAREA"&&(a=n.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!0,t.view,1,s.screenX,s.screenY,s.clientX,s.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),a._fake=!0,o.dispatchEvent(a))},i.options.zoom?250:0)):i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null,o=s.target;while(o.nodeType!=1)o=o.parentNode;o.tagName!="SELECT"&&o.tagName!="INPUT"&&o.tagName!="TEXTAREA"&&(a=n.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!0,t.view,1,s.screenX,s.screenY,s.clientX,s.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),a._fake=!0,o.dispatchEvent(a))},i.options.zoom?250:0))),i._resetPos(400),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l,c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c,p=i.x+l.dist,d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=r.max(r.max(l.time,c.time),10),i.options.snap&&(v=p-i.absStartX,m=d-i.absStartY,r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(p,d),p=b.x,d=b.y,y=r.max(b.time,y))),d<i.maxScrollY&&d<0&&(d=Math.max(d,i.maxScrollY-50)),i.scrollTo(r.round(p),r.round(d),y),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}if(i.options.snap){v=p-i.absStartX,m=d-i.absStartY,r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(i.x,i.y),(b.x!=i.x||b.y!=i.y)&&i.scrollTo(b.x,b.y,b.time)),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){t.moved&&(t.moved=!1,t.options.onScrollEnd&&t.options.onScrollEnd.call(t)),t.hScrollbar&&t.options.hideScrollbar&&(s=="webkit"&&(t.hScrollbarWrapper.style[h]="300ms"),t.hScrollbarWrapper.style.opacity="0"),t.vScrollbar&&t.options.hideScrollbar&&(s=="webkit"&&(t.vScrollbarWrapper.style[h]="300ms"),t.vScrollbarWrapper.style.opacity="0");return}t.scrollTo(n,r,e||0)},_wheel:function(e){var t=this,n,r,i,s,o;if("wheelDeltaX"in e)n=e.wheelDeltaX/12,r=e.wheelDeltaY/12;else if("wheelDelta"in e)n=r=e.wheelDelta/12;else{if(!("detail"in e))return;n=r=-e.detail*3}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0)),o<t.options.zoomMin&&(o=t.options.zoomMin),o>t.options.zoomMax&&(o=t.options.zoomMax),o!=t.scale&&(!t.wheelZoomCount&&t.options.onZoomStart&&t.options.onZoomStart.call(t,e),t.wheelZoomCount++,t.zoom(e.pageX,e.pageY,o,400),setTimeout(function(){t.wheelZoomCount--,!t.wheelZoomCount&&t.options.onZoomEnd&&t.options.onZoomEnd.call(t,e)},400));return}i=t.x+n,s=t.y+r,i>0?i=0:i<t.maxScrollX&&(i=t.maxScrollX),s>t.minScrollY?s=t.minScrollY:s<t.maxScrollY&&(s=t.maxScrollY),t.maxScrollY<0&&t.scrollTo(i,s,0)},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(N),t._startAni()},_startAni:function(){var e=this,t=e.x,n=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift(),s.x==t&&s.y==n&&(s.time=0),e.animating=!0,e.moved=!0;if(e.options.useTransition){e._transitionTime(s.time),e._pos(s.x,s.y),e.animating=!1,s.time?e._bind(N):e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),e._startAni();return}a=(a-i)/s.time-1,o=r.sqrt(1-a*a),f=(s.x-t)*o+t,l=(s.y-n)*o+n,e._pos(f,l),e.animating&&(e.aniTime=C(u))},u()},_transitionTime:function(e){e+="ms",this.scroller.style[f]=e,!e&&A&&(this.scroller.style[f]="0.001s"),this.hScrollbar&&(this.hScrollbarIndicator.style[f]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[f]=e)},_momentum:function(e,t,n,i,s){var o=6e-4,u=r.abs(e)/t,a=u*u/(2*o),f=0,l=0;return e>0&&a>n?(l=s/(6/(a/u*o)),n+=l,u=u*n/a,a=n):e<0&&a>i&&(l=s/(6/(a/u*o)),i+=l,u=u*i/a,a=i),a*=e<0?-1:1,f=u/o,{dist:a,time:r.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return e!=this.wrapper&&(t*=this.scale,n*=this.scale),{left:t,top:n}},_snap:function(e,t){var n=this,i,s,o,u,a,f;o=n.pagesX.length-1;for(i=0,s=n.pagesX.length;i<s;i++)if(e>=n.pagesX[i]){o=i;break}o==n.currPageX&&o>0&&n.dirX<0&&o--,e=n.pagesX[o],a=r.abs(e-n.pagesX[n.currPageX]),a=a?r.abs(n.x-e)/a*500:0,n.currPageX=o,o=n.pagesY.length-1;for(i=0;i<o;i++)if(t>=n.pagesY[i]){o=i;break}return o==n.currPageY&&o>0&&n.dirY<0&&o--,t=n.pagesY[o],f=r.abs(t-n.pagesY[n.currPageY]),f=f?r.abs(n.y-t)/f*500:0,n.currPageY=o,u=r.round(r.max(a,f))||200,{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var t=this;t.scroller.style[u]="",t.hScrollbar=!1,t.vScrollbar=!1,t._scrollbar("h"),t._scrollbar("v"),t._unbind(w,e),t._unbind(E),t._unbind(S,e),t._unbind(x,e),t._unbind(T,e),t.options.hasTouch||(t._unbind("DOMMouseScroll"),t._unbind("mousewheel")),t.options.useTransition&&t._unbind(N),t.options.checkDOMChanges&&clearInterval(t.checkDOMTime),t.options.onDestroy&&t.options.onDestroy.call(t)},refresh:function(e){var t=this,n,i,s,o,u=0,a=0;t.scale<t.options.zoomMin&&(t.scale=t.options.zoomMin),t.wrapperW=t.wrapper.clientWidth||1,t.wrapperH=t.wrapper.clientHeight||1,t.minScrollY=-t.options.topOffset||0,t.scrollerW=r.round(t.scroller.offsetWidth*t.scale),t.scrollerH=r.round((t.scroller.offsetHeight+t.minScrollY)*t.scale),t.maxScrollX=t.wrapperW-t.scrollerW,t.maxScrollY=t.wrapperH-t.scrollerH+t.minScrollY,t.dirX=0,t.dirY=0,t.options.onRefresh&&t.options.onRefresh.call(t),t.hScroll=t.options.hScroll&&t.maxScrollX<0,t.vScroll=t.options.vScroll&&(!t.options.bounceLock&&!t.hScroll||t.scrollerH>t.wrapperH),t.hScrollbar=t.hScroll&&t.options.hScrollbar,t.vScrollbar=t.vScroll&&t.options.vScrollbar&&t.scrollerH>t.wrapperH,n=t._offset(t.wrapper),t.wrapperOffsetLeft=-n.left,t.wrapperOffsetTop=-n.top;if(typeof t.options.snap=="string"){t.pagesX=[],t.pagesY=[],o=t.scroller.querySelectorAll(t.options.snap);for(i=0,s=o.length;i<s;i++)u=t._offset(o[i]),u.left+=t.wrapperOffsetLeft,u.top+=t.wrapperOffsetTop,t.pagesX[i]=u.left<t.maxScrollX?t.maxScrollX:u.left*t.scale,t.pagesY[i]=u.top<t.maxScrollY?t.maxScrollY:u.top*t.scale}else if(t.options.snap){t.pagesX=[];while(u>=t.maxScrollX)t.pagesX[a]=u,u-=t.wrapperW,a++;t.maxScrollX%t.wrapperW&&(t.pagesX[t.pagesX.length]=t.maxScrollX-t.pagesX[t.pagesX.length-1]+t.pagesX[t.pagesX.length-1]),u=0,a=0,t.pagesY=[];while(u>=t.maxScrollY)t.pagesY[a]=u,u-=t.wrapperH,a++;t.maxScrollY%t.wrapperH&&(t.pagesY[t.pagesY.length]=t.maxScrollY-t.pagesY[t.pagesY.length-1]+t.pagesY[t.pagesY.length-1])}t._scrollbar("h"),t._scrollbar("v"),t.zoomed||(t.scroller.style[f]="0",t._resetPos(e?0:400))},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop(),s.length||(s=[{x:e,y:t,time:n,relative:r}]);for(o=0,u=s.length;o<u;o++)s[o].relative&&(s[o].x=i.x-s[o].x,s[o].y=i.y-s[o].y),i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0});i._startAni()},scrollToElement:function(e,t){var n=this,i;e=e.nodeType?e:n.scroller.querySelector(e);if(!e)return;i=n._offset(e),i.left+=n.wrapperOffsetLeft,i.top+=n.wrapperOffsetTop,i.left=i.left>0?0:i.left<n.maxScrollX?n.maxScrollX:i.left,i.top=i.top>n.minScrollY?n.minScrollY:i.top<n.maxScrollY?n.maxScrollY:i.top,t=t===undefined?r.max(r.abs(i.left)*2,r.abs(i.top)*2):t,n.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n,r.options.onScrollStart&&r.options.onScrollStart.call(r),r.options.snap?(e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e,t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t,e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e,t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t,r.currPageX=e,r.currPageY=t,i=r.pagesX[e],s=r.pagesY[t]):(i=-r.wrapperW*e,s=-r.wrapperH*t,i<r.maxScrollX&&(i=r.maxScrollX),s<r.maxScrollY&&(s=r.maxScrollY)),r.scrollTo(i,s,n)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(S,e),this._unbind(x,e),this._unbind(T,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(N):k(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=!0,r=r===undefined?200:r,e=e-i.wrapperOffsetLeft-i.x,t=t-i.wrapperOffsetTop-i.y,i.x=e-e*s+i.x,i.y=t-t*s+i.y,i.scale=n,i.refresh(),i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x,i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y,i.scroller.style[f]=r+"ms",i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+L,i.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},i=null,typeof t!="undefined"?t.iScroll=M:e.iScroll=M})(window,document)}),define("$model/UI2/system/components/justep/scrollView/lib/iScrollLite",["require","exports","module","$UI/system/lib/jquery/transition","jquery"],function(e,t,n){function s(e,t,n){return function(){var r=arguments,i=function(){e.__timeout=undefined,e.apply(n,r)};e.__timeout&&clearTimeout(e.__timeout),e.__timeout=setTimeout(i,t)}}function o(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=r(window).height()&&t.right<=r(window).width()}e("$UI/system/lib/jquery/transition");var r=e("jquery"),i=function(e,t){this.domNode=e,this.$rootEle=r(e),this.$scrollEle=this.$rootEle.find(">.x-scroll"),this.$scrollCEle=this.$scrollEle.find(">.x-scroll-content"),this.$pdEle=this.$scrollEle.find(">.x-pull-down"),this.$puEle=this.$scrollEle.find(">.x-pull-up"),this.eventNamespace=(new Date).getTime()+"",this.options=t||{topOffset:50},this.options=r.extend({onRefresh:null,onScrollMove:null,onScrollEnd:null},this.options),this.init(),this.optimizePerformanceForKeyboard()};return i.prototype.init=function(){var e=this;this.pullDown(),this.refresh().done(function(){e.maxScrollY===0?e.options.onScrollEnd&&e.refresh().done(function(){e.maxScrollY===0&&e.options.onScrollEnd("scroll"),e.bindScroll()}):e.bindScroll()})},i.prototype.bindScroll=function(){var e=this;this.$scrollEle.on("scroll",function(t){e.y=e.$scrollEle.scrollTop()*-1,e.options.onScrollMove&&e.options.onScrollMove.call(e,t),s(e.onScrollEnd,200,e)("scroll")})},i.prototype.onScrollEnd=function(e){var t=this;this.options.recycleSelector!==""&&this.calculateUnit(),this.refresh().done(function(){t.options.onScrollEnd&&t.options.onScrollEnd.apply(t,[e])})},i.prototype.optimizePerformanceForKeyboard=function(){var e=this;r(window).on("keyboardshow."+this.eventNamespace,function(){r(e.unInViewEles).hide()}).on("keyboardhide."+this.eventNamespace,function(){r(e.unInViewEles).show()})},i.prototype.calculateUnit=function(){var e=this;this.inViewEles=[],this.unInViewEles=[],s(function(){e.$scrollCEle.find(e.options.recycleSelector).each(function(t,n){o(n)?e.inViewEles.push(r(n).children()):e.unInViewEles.push(r(n).children())})},1e3,e)()},i.prototype.refresh=function(){var e=r.Deferred(),t=this;return this.options.onRefresh&&this.options.onRefresh.call(t),this.$scrollEle.transition(300),this.$scrollEle.transitionEnd(function(){t.$scrollEle.transition(0)}),this.$scrollEle.transform("translate3d(0,0,0)"),setTimeout(function(){t.maxScrollY=-1*(t.$scrollEle.get(0).scrollHeight-t.$scrollEle.height()),t.y=t.$scrollEle.scrollTop()*-1,e.resolve()},300),e.promise()},i.prototype.scrollTo=function(e){justep.Browser.isX5App&&justep.Browser.isIOS?this._scrollTo(e):this.$scrollEle.scrollTop(e)},i.prototype._scrollTo=function(e){function n(e){function s(e){return--e*e*e+1}function o(){var u=Date.now(),a=Math.min(1,(u-n)/r),f=s(a);i!=e&&(t.scrollTop=parseInt(f*(e-i)+i,10)),a<1&&window.requestAnimationFrame(o)}var n=Date.now(),r=550,i=t.scrollTop;if(i===e)return;window.requestAnimationFrame(o)}var t=this.$scrollEle.get(0);n(e)},i.prototype.scrollToElement=function(e){e.scrollIntoView&&e.scrollIntoView()},i.prototype.scrollNextArea=function(){this._scrollTo(this.$scrollEle.scrollTop()+this.$rootEle.height())},i.prototype.scrollPrevArea=function(){this._scrollTo(this.$scrollEle.scrollTop()-this.$rootEle.height())},i.prototype.supportContentTouchMove=function(){var e=!1,t,n={},i,s,o,u,a,f=this,l=!0;this.$scrollEle.on("touchstart mousedown",function(t){t instanceof r.Event&&(t=t.originalEvent),e=!1,i=!0,l=!0,n.x=t.type==="touchstart"?t.targetTouches[0].pageX:t.pageX,n.y=t.type==="touchstart"?t.targetTouches[0].pageY:t.pageY,a=(new Date).getTime(),f.$scrollEle.transition(0)}),this.$scrollEle.on("touchmove mousemove",function(t){t instanceof r.Event&&(t=t.originalEvent);if(t.hasStopedPropagation===!0)return;if(t.type==="touchmove"&&t.targetTouches.length>1)return;var a=t.type==="touchmove"?t.targetTouches[0].pageX:t.pageX,c=t.type==="touchmove"?t.targetTouches[0].pageY:t.pageY;s=Math.abs(a-n.x),o=Math.abs(c-n.y),u=c-n.y,l&&o>s&&f.$scrollEle.scrollTop()===0&&u>0&&(i=!1,e=!0),i===!1&&e===!0&&u>0&&(t.hasStopedPropagation=!0,t.preventDefault(),f.$scrollEle.transform("translate3d(0,"+Math.pow(u,.85)+"px,0)"),f.y=Math.pow(u,.85)-f.options.topOffset,f.options.onScrollMove&&f.options.onScrollMove.call(f,t)),l&&o>s&&f.$scrollEle.get(0).scrollHeight-f.$scrollEle.height()-f.$scrollEle.scrollTop()===0&&u<0&&(f.options.autoPullUp==1&&f.$scrollEle.get(0).scrollHeight-f.$scrollEle.height()==0||f.options.autoPullUp==0||f.options.autoPullUp==1&&f.noMoreElement===!0)&&(l=!1,i=!1,e=!0),i===!1&&e===!0&&u<0&&(t.hasStopedPropagation=!0,t.preventDefault(),f.$scrollEle.transform("translate3d(0,-"+Math.pow(u*-1,.85)+"px,0)"),f.y=-Math.pow(u*-1,.85)-(f.$scrollEle.get(0).scrollHeight-f.$scrollEle.height()),f.options.onScrollMove&&f.options.onScrollMove.call(f,t)),l=!1}),this.$scrollEle.on("touchcancel touchend mouseup",function(t){t instanceof r.Event&&(t=t.originalEvent);if(i===!1&&e===!0){var n="pullDown";u<0&&(n="pullUp"),f.onScrollEnd(n),!f.$pdEle.hasClass("x-flip")&&!f.$pdEle.hasClass("x-restore")&&f.refresh()}i=!0,e===!1,l=!1})},i.prototype.pullDown=function(){if(this.$pdEle.length===0&&this.$puEle.length===0)return;this.supportContentTouchMove()},i.prototype.destroy=function(){r(window).off("."+this.eventNamespace)},i}),define("$model/UI2/system/components/bootstrap/lib/js/bootstrap",["require"],function(e){if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t();if(!e.support.transition)return;e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}})}(jQuery),+function(e){function r(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})}var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.VERSION="3.3.2",n.TRANSITION_DURATION=150,n.prototype.close=function(t){function o(){s.detach().trigger("closed.bs.alert").remove()}var r=e(this),i=r.attr("data-target");i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var s=e(i);t&&t.preventDefault(),s.length||(s=r.closest(".alert")),s.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o()};var i=e.fn.alert;e.fn.alert=r,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=i,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.isLoading=!1};t.VERSION="3.3.2",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var n="disabled",r=this.$element,i=r.is("input")?"val":"html",s=r.data();t+="Text",s.resetText==null&&r.data("resetText",r[i]()),setTimeout(e.proxy(function(){r[i](s[t]==null?this.options[t]:s[t]),t=="loadingText"?(this.isLoading=!0,r.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,r.removeClass(n).removeAttr(n))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");n.prop("type")=="radio"&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));e&&this.$element.toggleClass("active")};var r=e.fn.button;e.fn.button=n,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=r,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=e(t.target);r.hasClass("btn")||(r=r.closest(".btn")),n.call(r,"toggle"),t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("bs.carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})}var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.options.pause=="hover"&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(e){if(/input|textarea/i.test(e.target.tagName))return;switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},t.prototype.getItemForDirection=function(e,t){var n=this.getItemIndex(t),r=e=="prev"&&n===0||e=="next"&&n==this.$items.length-1;if(r&&!this.options.wrap)return t;var i=e=="prev"?-1:1,s=(n+i)%this.$items.length;return this.$items.eq(s)},t.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(e>this.$items.length-1||e<0)return;return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(this.sliding)return;return this.slide("next")},t.prototype.prev=function(){if(this.sliding)return;return this.slide("prev")},t.prototype.slide=function(n,r){var i=this.$element.find(".item.active"),s=r||this.getItemForDirection(n,i),o=this.interval,u=n=="next"?"left":"right",a=this;if(s.hasClass("active"))return this.sliding=!1;var f=s[0],l=e.Event("slide.bs.carousel",{relatedTarget:f,direction:u});this.$element.trigger(l);if(l.isDefaultPrevented())return;this.sliding=!0,o&&this.pause();if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=e(this.$indicators.children()[this.getItemIndex(s)]);c&&c.addClass("active")}var h=e.Event("slid.bs.carousel",{relatedTarget:f,direction:u});return e.support.transition&&this.$element.hasClass("slide")?(s.addClass(n),s[0].offsetWidth,i.addClass(u),s.addClass(u),i.one("bsTransitionEnd",function(){s.removeClass([n,u].join(" ")).addClass("active"),i.removeClass(["active",u].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(h)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(i.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(h)),o&&this.cycle(),this};var r=e.fn.carousel;e.fn.carousel=n,e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=r,this};var i=function(t){var r,i=e(this),s=e(i.attr("data-target")||(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(!s.hasClass("carousel"))return;var o=e.extend({},s.data(),i.data()),u=i.attr("data-slide-to");u&&(o.interval=!1),n.call(s,o),u&&s.data("bs.carousel").to(u),t.preventDefault()};e(document).on("click.bs.carousel.data-api","[data-slide]",i).on("click.bs.carousel.data-api","[data-slide-to]",i),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){function n(t){var n,r=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(r)}function r(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(s.toggle=!1),i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.$trigger=e(this.options.trigger).filter('[href="#'+n.id+'"], [data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};t.VERSION="3.3.2",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var n,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(i&&i.length){n=i.data("bs.collapse");if(n&&n.transitioning)return}var s=e.Event("show.bs.collapse");this.$element.trigger(s);if(s.isDefaultPrevented())return;i&&i.length&&(r.call(i,"hide"),n||i.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var u=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return u.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][a])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var n=e.Event("hide.bs.collapse");this.$element.trigger(n);if(n.isDefaultPrevented())return;var r=this.dimension();this.$element[r](this.$element[r]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return i.call(this);this.$element[r](0).one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(t.TRANSITION_DURATION)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,r){var i=e(r);this.addAriaAndCollapsedClass(n(i),i)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var i=e.fn.collapse;e.fn.collapse=r,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var i=e(this);i.attr("data-target")||t.preventDefault();var s=n(i),o=s.data("bs.collapse"),u=o?"toggle":e.extend({},i.data(),{trigger:this});r.call(s,u)})}(jQuery),+function(e){function i(r){if(r&&r.which===3)return;e(t).remove(),e(n).each(function(){var t=e(this),n=s(t),i={relatedTarget:this};if(!n.hasClass("open"))return;n.trigger(r=e.Event("hide.bs.dropdown",i));if(r.isDefaultPrevented())return;t.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",i)})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}function o(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})}var t=".dropdown-backdrop",n='[data-toggle="dropdown"]',r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.2",r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",u)}return!1},r.prototype.keydown=function(t){if(!/(38|40|27|32)/.test(t.which)||/input|textarea/i.test(t.target.tagName))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o&&t.which!=27||o&&t.which==27)return t.which==27&&i.find(n).trigger("focus"),r.trigger("click");var u=" li:not(.divider):visible a",a=i.find('[role="menu"]'+u+', [role="listbox"]'+u);if(!a.length)return;var f=a.index(t.target);t.which==38&&f>0&&f--,t.which==40&&f<a.length-1&&f++,~f||(f=0),a.eq(f).trigger("focus")};var u=e.fn.dropdown;e.fn.dropdown=o,e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=u,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n,r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',r.prototype.keydown)}(jQuery),+function(e){function n(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})}var t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var r=this,i=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented())return;this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.options.backdrop&&r.adjustBackdrop(),r.adjustDialog(),i&&r.$element[0].offsetWidth,r.$element.addClass("in").attr("aria-hidden",!1),r.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:n});i?r.$element.find(".modal-dialog").one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(s)})},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n);if(!this.isShown||n.isDefaultPrevented())return;this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!n)return;s?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){r.removeBackdrop(),n&&n()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):o()}else n&&n()},t.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},t.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=e(this),i=r.attr("href"),s=e(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},s.data(),r.data());r.is("a")&&t.preventDefault(),s.one("show.bs.modal",function(e){if(e.isDefaultPrevented())return;s.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),n.call(s,o,this)})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focusin",a=o=="hover"?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n&&n.$tip&&n.$tip.is(":visible")){n.hoverState="in";return}n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var n=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(n);var r=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(n.isDefaultPrevented()||!r)return;var i=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var u=typeof this.options.placement=="function"?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,f=a.test(u);f&&(u=u.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var l=this.getPosition(),c=s[0].offsetWidth,h=s[0].offsetHeight;if(f){var p=u,d=this.options.container?e(this.options.container):this.$element.parent(),v=this.getPosition(d);u=u=="bottom"&&l.bottom+h>v.bottom?"top":u=="top"&&l.top-h<v.top?"bottom":u=="right"&&l.right+c>v.width?"left":u=="left"&&l.left-c<v.left?"right":u,s.removeClass(p).addClass(u)}var m=this.getCalculatedOffset(u,l,c,h);this.applyPlacement(m,u);var g=function(){var e=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,e=="out"&&i.leave(i)};e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(t.TRANSITION_DURATION):g()}},t.prototype.applyPlacement=function(t,n){var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),t.top=t.top+o,t.left=t.left+u,e.offset.setOffset(r[0],e.extend({using:function(e){r.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),r.addClass("in");var a=r[0].offsetWidth,f=r[0].offsetHeight;n=="top"&&f!=s&&(t.top=t.top+s-f);var l=this.getViewportAdjustedDelta(n,t,a,f);l.left?t.left+=l.left:t.top+=l.top;var c=/top|bottom/.test(n),h=c?l.left*2-i+a:l.top*2-s+f,p=c?"offsetWidth":"offsetHeight";r.offset(t),this.replaceArrow(h,r[0][p],c)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(n){function o(){r.hoverState!="in"&&i.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),n&&n()}var r=this,i=this.tip(),s=e.Event("hide.bs."+this.type);this.$element.trigger(s);if(s.isDefaultPrevented())return;return i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],r=n.tagName=="BODY",i=n.getBoundingClientRect();i.width==null&&(i=e.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var s=r?{top:0,left:0}:t.offset(),o={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},u=r?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},i,o,u,s)},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,n,r){var i={top:0,left:0};if(!this.$viewport)return i;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var u=t.top-s-o.scroll,a=t.top+s-o.scroll+r;u<o.top?i.top=o.top-u:a>o.top+o.height&&(i.top=o.top+o.height-a)}else{var f=t.left-s,l=t.left+s+n;f<o.left?i.left=o.left-f:l>o.width&&(i.left=o.left+o.width-l)}return i},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.getUID=function(e){do e+=~~(Math.random()*1e6);while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type)})};var r=e.fn.tooltip;e.fn.tooltip=n,e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=r,this}}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.2",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?typeof n=="string"?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var r=e.fn.popover;e.fn.popover=n,e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=r,this}}(jQuery),+function(e){function t(n,r){var i=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(n).is("body")?e(window):e(n),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",i),this.refresh(),this.process()}function n(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s=typeof n=="object"&&n;i||r.data("bs.scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})}t.VERSION="3.3.2",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",n=0;e.isWindow(this.$scrollElement[0])||(t="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var r=this;this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#./.test(i)&&e(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+n,i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){r.offsets.push(this[0]),r.targets.push(this[1])})},t.prototype.process=function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.getScrollHeight(),n=this.options.offset+t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;this.scrollHeight!=t&&this.refresh();if(e>=n)return s!=(o=i[i.length-1])&&this.activate(o);if(s&&e<r[0])return this.activeTarget=null,this.clear();for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=r,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})}var t=function(t){this.element=e(t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;var i=n.find(".active:last a"),s=e.Event("hide.bs.tab",{relatedTarget:t[0]}),o=e.Event("show.bs.tab",{relatedTarget:i[0]});i.trigger(s),t.trigger(o);if(o.isDefaultPrevented()||s.isDefaultPrevented())return;var u=e(r);this.activate(t.closest("li"),n),this.activate(u,u.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})},t.prototype.activate=function(n,r,i){function u(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=r.find("> .active"),o=i&&e.support.transition&&(s.length&&s.hasClass("fade")||!!r.find("> .fade").length);s.length&&o?s.one("bsTransitionEnd",u).emulateTransitionEnd(t.TRANSITION_DURATION):u(),s.removeClass("in")};var r=e.fn.tab;e.fn.tab=n,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=r,this};var i=function(t){t.preventDefault(),n.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.VERSION="3.3.2",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,n,r){var i=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(n!=null&&this.affixed=="top")return i<n?"top":!1;if(this.affixed=="bottom")return n!=null?i+this.unpin<=s.top?!1:"bottom":i+o<=e-r?!1:"bottom";var u=this.affixed==null,a=u?i:s.top,f=u?o:t;return n!=null&&i<=n?"top":r!=null&&a+f>=e-r?"bottom":!1},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=this.$element.height(),r=this.options.offset,i=r.top,s=r.bottom,o=e("body").height();typeof r!="object"&&(s=i=r),typeof i=="function"&&(i=r.top(this.$element)),typeof s=="function"&&(s=r.bottom(this.$element));var u=this.getState(o,n,i,s);if(this.affixed!=u){this.unpin!=null&&this.$element.css("top","");var a="affix"+(u?"-"+u:""),f=e.Event(a+".bs.affix");this.$element.trigger(f);if(f.isDefaultPrevented())return;this.affixed=u,this.unpin=u=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(a).trigger(a.replace("affix","affixed")+".bs.affix")}u=="bottom"&&this.$element.offset({top:o-n-s})};var r=e.fn.affix;e.fn.affix=n,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=r,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),r=t.data();r.offset=r.offset||{},r.offsetBottom!=null&&(r.offset.bottom=r.offsetBottom),r.offsetTop!=null&&(r.offset.top=r.offsetTop),n.call(t,r)})})}(jQuery)}),define("$model/UI2/system/components/justep/bar/bar.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/bar/bar",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./bar.config","css!./css/bar"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./bar"),s=e("./bar.config");e("css!./css/bar").load();var o=r.extend({getUrl:function(){return i},constructor:function(e){this.callParent(e)},buildTemplate:function(e){return n.format("<div class='x-bar' xid='{0}' componet='{1}'></div>",e.xid)},getConfig:function(){return s},init:function(){this.callParent()}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/toolBar/toolBar.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/toolBar/toolBar",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./toolBar.config","css!./css/toolBar"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./toolBar"),i=e("./toolBar.config");e("css!./css/toolBar").load();var s=n.ViewComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/button.config",["require"],function(e){return{properties:{label:"string",icon:"string",target:"string",disabled:"boolean"},events:["onClick"],binds:{}}}),define("$model/UI2/system/components/justep/button/button",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./button.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./buttonGroup"),i=e.normalizeName("./button"),s=e("./button.config"),o=n.BindComponent.extend({constructor:function(e){this.callParent(e),this.opDisabled=!1,this.icon="",this.label="",this.target="",this.opIcon="",this.opLabel="",this.isImgIcon=!1,this.imgIcon=["",""],this.on(n.Component.OPERATION_CHANGED,function(e){this.getModel().componentPromise(this.domNode).done(function(t){t._doOperationChanged(e)})},this)},getConfig:function(){return s},dispose:function(){this.$domNode.off("touchstart"),this.$domNode.off("click"),this._unBindTargetEvent(this.target),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="btn btn-default"),"<a class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+i+"' "+" ><i class='"+(this.isImgIcon?"":e.icon)+"'/>"+(this.isImgIcon?"<img src='"+this.imgIcon[this.disabled?1:0]+"'/>":"")+"<span>"+(e.label?e.label:"")+"</span></a>"},doInit:function(e,n){this.$domNode.on("click",t.proxy(this._doClick,this)),this.target&&this._bindTargetEvent(this.target)},_bindTargetEvent:function(e){var t=this.getModel(),n=this;t.componentPromise(e).done(function(e){e.on("onActive",n._doActiveTarget,n),e.on("onInactive",n._doInactiveTarget,n),typeof e["isActive"]=="function"&&e.isActive()&&n.addClass("active")});var r=this._getButtonGroup();(!r||!r.tabbed)&&this.on("onClick",this._doClickActiveTarget,this)},_unBindTargetEvent:function(e){if(e){var t=this.getModel(),n=this;t.componentPromise(e).done(function(e){e.off("onActive",n._doActiveTarget,n),e.off("onInactive",n._doInactiveTarget,n)}),this.off("onClick",this._doClickActiveTarget,this)}},_getButtonGroup:function(){var e=this.$domNode.parent();if(r==e.attr("component")){var t=this.getModel();return t?t.comp(e[0]):null}},_doActiveTarget:function(e){var t=this._getButtonGroup();t&&t.each(function(e){e.removeClass("active")}),this.addClass("active")},_doInactiveTarget:function(e){this.removeClass("active")},_doClickActiveTarget:function(e){var t=this.getModel(),n=t.comp(this.target);n&&typeof n["active"]=="function"&&n.active()},_doOperationPropChanged:function(e){e.property=="label"?this.set({opLabel:e.value}):e.property=="icon"?this.set({opIcon:e.value}):e.property=="enable"&&this.set({opDisabled:!e.value})},_doOperationChanged:function(e){if("onClick"==e.eventName){var n,r=this;this.operation&&(n=this.operation,this.getModel().componentPromise(n.owner).done(function(e){e.unOpChange(n.name,r._doOperationPropChanged,r)}));var i=this.getEventOperation("onClick");t.isArray(i)&&(i=i.length>0?i[0]:null),i&&(n=this._getOperation(i.operation),n&&n.owner&&(this.operation=n,i.operation=n,this.getModel().componentPromise(n.owner).done(function(e){e.onOpChange(n.name,r._doOperationPropChanged,r);var t={};t.opIcon=e.getOperationIcon(n.name),t.opLabel=e.getOperationLabel(n.name),t.opDisabled=!e.getOperationEnable(n.name),r.set(t)})))}},_execEventOperation:function(e,t){if(this.isDisabled())return;this.callParent(e,t)},_getLabelNode:function(){return this.$domNode.children("span")},_getIconNode:function(){return this.$domNode.children("i")},_getImgNode:function(){return this.$domNode.children("img")},isDisabled:function(){return this.callParent()||this.opDisabled},disabledRender:function(){var e=this.isDisabled();this.isImgIcon&&this.$domNode&&this._getImgNode().attr("src",this.imgIcon[e?1:0]),e?this.$domNode.attr("disabled",!0):this.$domNode.removeAttr("disabled")},propertyChangedHandler:function(e,t,n){switch(e){case"label":case"opLabel":t!=n&&this.$domNode&&this._getLabelNode().text(this.label||this.opLabel);break;case"target":t!=n&&this._inited&&(this._unBindTargetEvent(t),n&&this._bindTargetEvent(n));break;case"icon":case"opIcon":if(t!=n){this._setIcon(this.icon||this.opIcon);if(this.$domNode)if(!this.isImgIcon)t&&this._getIconNode().removeClass(t),n&&this._getIconNode().addClass(this.icon||this.opIcon),this._getImgNode().remove();else if(n){var r=this._getImgNode();r.size()<=0&&this._getLabelNode().before("<img/>"),this._getImgNode().attr("src",this.imgIcon[this.isDisabled()?1:0]),this._getIconNode().removeAttr("class")}}break;case"opDisabled":t!=n&&this.disabledRender();break;default:this.callParent(e,t,n)}},_setIcon:function(t){if(typeof t=="string"&&0===t.indexOf("img:")){this.isImgIcon=!0;var n=t.indexOf("|");n<0&&(n=t.length),this.imgIcon[0]=e.toUrl(t.slice(4,n)),this.imgIcon[1]=e.toUrl(t.slice(n+1,t.length))}else this.isImgIcon=!1},_doClick:function(e){if(this.isDisabled())return;this.fireEvent("onClick",{source:this})},render:function(){this.callParent()}});return n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/button/buttonGroup.config",["require"],function(e){return{properties:{tabbed:"boolean",selected:"string",disabled:"boolean"},events:["onSelect"],binds:{}}}),define("$model/UI2/system/components/justep/button/buttonGroup",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./button","./buttonGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("./button"),i=e.normalizeName("./buttonGroup"),s=e("./buttonGroup.config"),o=n.BindComponent.extend({constructor:function(e){this.callParent(e),this.tabbed=!1,this.selected=null},dispose:function(){this.$domNode.off("click"),this.callParent()},getConfig:function(){return s},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="btn-group"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+i+"' "+" ></div>"},doInit:function(e,n){this.$domNode.on("click",t.proxy(this._doClick,this))},propertyChangedHandler:function(e,t,n){switch(e){case"tabbed":if(t!=n&&this._inited){typeof n=="string"&&(n=n=="true");var r=n?"addClass":"removeClass";this.$domNode[r](e)}break;case"selected":t!=n&&this.select(n);break;default:this.callParent(e,t,n)}},_doClick:function(e){if(this.tabbed){var t=this._getBtn(e.target);this.select(t)}},_getBtn:function(e){if(e==this.domNode)return null;var t=n.Component.getComponent(e);return t instanceof r?t:this._getBtn(e.parentNode)},select:function(e){if("string"==typeof e){var t=this.getModel(),n=e;e=t.comp(n),e||t.componentPromise(n).done(function(e){e.addClass("active")})}if(e instanceof r){if(this.hasListener("onSelect")){var i={source:this,item:e,cancel:!1};this.fireEvent("onSelect",i);if(i.cancel)return}this.each(function(t){var n=t!==e,r=n?"removeClass":"addClass";t[r]("active"),n&&"function"==typeof e._doClickActiveTarget&&e._doClickActiveTarget()},this)}},each:function(e,t){typeof e=="function"&&this.$domNode.children("a.btn").each(function(){var i=n.Component.getComponent(this);i instanceof r&&e.call(t||window,i)})},render:function(){this.callParent();var e=["tabbed"];for(var t=0;t<e.length;t++){var n=this[e[t]]?"addClass":"removeClass";this.$domNode[n](e[t])}}});return n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/button/radio.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/radio",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./radio.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./radio"),i=e("./radio.config"),s=n.BindComponent.extend({_defaultClass:"x-radio",_type:"radio",getConfig:function(){return i},constructor:function(e){this.callParent(e),this.label=null,this.name=null,this.checkedValue=undefined,this.uncheckedValue=undefined,this.value=null,this.checked=!1,this.on(n.ViewComponent.DATA_CHANGED,function(e){if("ref"==e.name)return;var t={};t[e.name]=e.value,this.set(t)},this)},dispose:function(){this._getInput().off("change",this._clickHandle),this.callParent()},val:function(){if(arguments.length===0)return this.value;this.value=arguments[0],this._getInput().prop("checked",this.checkedValue===undefined?!!this.value:this.checkedValue==this.value).val(this.value)},_buildInput:function(e){var n=t("<input"+(e.name?" name='"+e.name+"'":"")+(e.checked?" checked":"")+" type='"+this._type+"'/>");return undefined!==e.value&&n.attr("value",e.value),n},_buildLabel:function(e){var n=t("<label></label>");return e.label&&n.text(e.label),n},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]=this._defaultClass);var n=t("<span"+(e["class"]?" class='"+e["class"]+"'":"")+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"'>"+"</span>");return n.append(this._buildInput(e)),n.append(this._buildLabel(e)),n},doInit:function(e,t){var r=this._getLabel(),i=this._getInput(),s=i.attr("id");s||i.attr("id",n.UUID.createUUID()),r.attr("for",i.attr("id")).click(function(e){e.stopPropagation()}),this._clickHandle=this._doClick.bind(this),i.on("change",this._clickHandle);var o=this.$domNode.attr("name");o&&i.attr("name",o);if(e&&!e.hasOwnProperty("ref")){var u={};n.Bind.isObservable(e.value)&&(u.value=e.value.get()),n.Bind.isObservable(e.label)&&(u.label=e.label.get()),this.set(u)}},doUpdate:function(e,t){e&&(e.hasOwnProperty("ref")?(this.updateValue(e.ref),this.updateReadonly(e.ref)):this.updateReadonly(e.value))},_doClick:function(e){var t=this._getInput()[0].checked;this.value=this.checkedValue===undefined?t:t?this.checkedValue:this.uncheckedValue!==undefined?this.uncheckedValue:null,this.fireEvent("onChange",{source:this,checked:t,value:this.value}),this.val2ref()},_getInput:function(){return this.$domNode.children("input")},_getLabel:function(){return this.$domNode.children("label")},get:function(e){return"checked"===e?this._getInput().prop("checked"):this.callParent(e)},disabledRender:function(){this.$domNode&&this._getInput().attr("disabled",this.isDisabled())},propertyChangedHandler:function(e,t,n){switch(e){case"label":t!=n&&this.$domNode&&this._getLabel().text(n);break;case"value":t!=n&&this.$domNode&&this.val(n);break;case"checked":t!=n&&this.$domNode&&this._getInput().prop("checked",n);break;default:this.callParent(e,t,n)}}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/checkbox.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/checkbox",["require","$UI/system/lib/justep","./radio","./checkbox.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./radio"),r=e.normalizeName("./checkbox"),i=e("./checkbox.config"),s=n.extend({_defaultClass:"x-checkbox",_type:"checkbox",getConfig:function(){return i},getDisplayHtml:function(e){return s.getDisplayHtml(e)}}),o=function(e){var t=e.getParam("checkedValue");return t===undefined&&(t=1),t},u=function(e){var t=e.comp;return function(n){var r=n.target||n.srcElement,i=t.getDataRow(r),s=o(e);if(i){var u=e.readonly||i.data.getReadonly(e.colDef.name,i);$(r).attr("readonly",u);if(u)return n.preventDefault(),!1;i.val(e.colDef.name,$(r).prop("checked")?s:null)}}};return s.getDisplayHtml=function(e){if(!e)return;var n="",r=e.row&&e.row.data,i=e.readonly||(r?r.getReadonly(e.colDef.name,e.row):!1);if((e.type=="grid"||e.type=="dataTables")&&!e.readonly){var s="__checkbox_fn__"+e.colDef.name;if(!e.comp[s]){var a=e.comp.getModel(),f="_"+t.UUID.createUUID();e.comp[s]=f,a[f]=u(e)}n="justep.callModelFn({domNode:event.target||event.srcElement,fn:'"+e.comp[s]+"'},event)"}var l=o(e),c=e.row.val(e.colDef.name)==l,h="c"+t.UUID.createUUID(),p='<span class="x-checkbox"><input id="'+h+'" type="checkbox" '+(i?"readonly":"")+(n?' onclick="'+n+'"':"")+(c?" checked":"")+'/><label for="'+h+'"/></span>';return p},t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/toggle.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/button/toggle",["require","$UI/system/lib/justep","./radio","jquery","./toggle.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./radio"),r=e("jquery"),i=e.normalizeName("./toggle"),s=e("./toggle.config"),o=n.extend({constructor:function(e){this.callParent(e),this.type="checkbox",this._defaultClass="x-toggle"},getConfig:function(){return s},doInit:function(e,n){this.callParent(e,n);if(t.Browser.isIOS){var r=this._getLabel();r.children("span").on("click",function(e){r.trigger("click")})}},_buildInput:function(e){var t=r("<input "+(e.name?" name='"+e.name+"'":"")+(e.checked?" checked='checked'":"")+" type='"+e.type+"' class='"+this._defaultClass+"'/>");return undefined!==e.value&&t.attr("value",e.value),t},_buildLabel:function(e){var t=r("<label></label>");return t.attr("data-on",e.label&&e.label.on?e.label.on:"ON"),t.attr("data-off",e.label&&e.label.off?e.label.off:"OFF"),t.append("<span/>"),t},propertyChangedHandler:function(e,t,n){switch(e){case"type":t!=n&&this._inited&&this._getInput().attr("type",n);break;case"label":this._inited&&(n||(n={}),n.on||(n.on="ON"),n.off||(n.off="OFF"),this._getLabel().attr("data-on",n.on).attr("data-off",n.off));break;default:this.callParent(e,t,n)}}});return t.Component.register(i,o),o}),define("$model/UI2/system/components/justep/contents/contents.config",["require"],function(e){return{properties:{active:"number",interval:"number",routable:"boolean",slidable:"boolean",swipe:"boolean",wrap:"boolean"},events:["onActiveChange","onActiveChanged"],binds:{}}}),define("$model/UI2/system/components/justep/contents/content.config",["require"],function(e){return{events:["onActive","onInactive"],binds:{}}}),define("$model/UI2/system/components/justep/contents/content",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./content.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e("jquery"),s=e.normalizeName("./content"),o=e("./content.config"),u=r.extend({constructor:function(e){this.xid="",this.callParent(e)},getConfig:function(){return o},buildTemplate:function(e){e.xid=e.xid||"",e.body=e.body||"";var t=n.format("<div component='$model/UI2/system/components/justep/contents/content' class='x-contents-content' >{0}</div>",e.body);return t=i(t),t.attr("xid",e.xid),this.owner=e.owner,this.owner.$el.append(t),this.xid=e.xid,t},getIndex:function(){return this.$domNode.index()},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.owner.contents.push(this),this.xid=this.$domNode.attr("xid"),this.callParent(e,n)},get:function(e){if(this[e]!==undefined)return this[e];e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.getIndex())},set:function(e,t){this[e]=t;if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.getIndex(),t)},onAfterSelect:function(){this.owner.to(this.getIndex())},isActive:function(){return this.xid===this.owner.getActiveXid()},active:function(){this.owner.to(this.xid)},dispose:function(){this.owner=null,this.callParent()},doRoute:function(e,t,n){if(!this.owner.routable)return;n=="enter"&&this.active()}});return t.register(s,u),u}),define("$model/UI2/system/components/justep/contents/contents",["require","$UI/system/lib/jquery/transition","$UI/system/lib/base/component","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./content","./contents.config","$UI/system/components/justep/common/res","css!./css/contents"],function(e){e("$UI/system/lib/jquery/transition");var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/justep"),r=e("$UI/system/lib/base/string"),i=e("$UI/system/lib/base/viewComponent"),s=e("jquery"),o=e.normalizeName("./contents"),u=e("./content"),a=e("./contents.config");e("$UI/system/components/justep/common/res"),e("css!./css/contents").load();var f="x-contents",l=i.extend({getConfig:function(){return a},constructor:function(e){this.active=0,this.interval=0,this.contents=[],this.EOF=!0,this.wrap=!0,this.swipe=Modernizr.touch,this.slidable=Modernizr.touch&&!n.Browser.isYuanXin,this.routable=!0,this.eventNamespace=(new Date).getTime()+"",this.callParent(e)},optimizePerformanceForKeyboard:function(){var e=this;s(window).on("keyboardshow."+this.eventNamespace,function(){e.$domNode.removeClass("slidable")}).on("keyboardhide."+this.eventNamespace,function(){e.$domNode.addClass("slidable")})},optimizePerformance:function(){var e=this,t="x-content-on-remoting-sibling";this.on("onActiveChange",function(e){var n=e.to,r=this.$el.find(">.x-contents-content");s(r[n]).removeClass(t)}),this.on("onActiveChanged",function(){setTimeout(function(){e.$el&&e._optimizePerformance(t)},1)}),this._optimizePerformance(t)},_optimizePerformance:function(e){var t=this.$el.find(">.x-contents-content"),n=t.length,r=-1;t.each(function(t,n){s(n).hasClass("active")?(r=t,s(n).removeClass(e)):s(n).addClass(e)}),r!=-1&&this.swipe&&(r===0?(s(t[1]).removeClass(e),this.wrap&&s(t[n-1]).removeClass(e)):r==t.length-1?(this.wrap&&s(t[0]).removeClass(e),s(t[n-2]).removeClass(e)):(s(t[r-1]).removeClass(e),s(t[r+1]).removeClass(e)))},buildTemplate:function(e){e.slidable=e.slidable!==undefined?e.slidable:!0,e.wrap=e.wrap!==undefined?e.wrap:!0,e.swipe=e.swipe!==undefined?e.swipe:!0;var t="";return r.format("<div xid='{0}' class='{1}' component='{2}'>{3}</div>",e.xid,f,o,t)},init:function(e,t){this.callParent(e,t);var r=this;this.$el=s(this.domNode);var i=this.getModel(),o=[],u=[];s(">.x-contents-content",this.$el).each(function(){o.push(s(this).attr("xid"))}),n.Array.each(o,function(e){u.push(i.componentPromise(e))});var a=i.getLoadedDeferred();s.when.apply(s,u).done(function(){r.to(r.active,function(){r.beginInterval(),a.resolve()}),r.inited()}),this.swipe&&this.supportContentsTouchMove();if(this.swipe||this.slidable)s(this.domNode).addClass("slidable"),this.optimizePerformanceForKeyboard();return this.optimizePerformance(),this.fixWebkitBug(),{dependence:!0}},fixWebkitBug:function(){var e=this;n.Browser.isX5App&&n.Browser.isIOS&&this.on("onActiveChanged",function(t){var n=t.to,r=e.contents[n];if(r&&r.$domNode){var i=r.$domNode.css("zIndex");r.$domNode.css("zIndex",100),r.$domNode.get(0).clientWidth,r.$domNode.css("zIndex",i)}})},beginInterval:function(){if(this.interval){var e=this;this.intervaler=setInterval(function(){e.next()},this.interval)}},addRouteItem:function(e){if(!this.routable)return;var t=e.attr("xid"),n=this.getModel().$routeState;for(var r=0;r<this.contents.length;r++){var i=this.contents[r];i.xid!=t&&n.removeState(i.xid,"")}n.addState(t,"",""),n.publishState()},canSwipe:function(e){var t=this.swipe;return t&&typeof this.swipe=="string"&&(t=this.swipe==e),t},supportContentsTouchMove:function(){var e=!1,t={},n,r,i,o,u,a,f,l,c,h=this,p=!0,d=0,v=!1,m,g,y;this.$el.on("touchstart",function(r){a=h.$el.width(),r instanceof s.Event&&(r=r.originalEvent),e=!1,n=!1,p=!0,t.x=r.type==="touchstart"?r.targetTouches[0].pageX:r.pageX,t.y=r.type==="touchstart"?r.targetTouches[0].pageY:r.pageY,u=(new Date).getTime(),f=h.$el.find(">.x-contents-content.active"),m=h.getActiveIndex(),g=m-1,y=m+1;var i=h.$el.find(">.x-contents-content");l=s(i[m-1]),c=s(i[m+1]),h.wrap&&i.length>1&&(l.length===0&&(l=i.last(),g=i.length-1),c.length===0&&(c=i.first(),y=0)),v=!1,v=t.x-h.$domNode.offset().left<d,v||(v=h.$domNode.width()-t.x<d)}),this.$el.on("touchmove",function(u){u instanceof s.Event&&(u=u.originalEvent),h.sliding&&(n=!0),u.target&&"INPUT"==u.target.tagName&&u.target.getAttribute("type")=="range"&&(n=!0);var d=u.type==="touchmove"?u.targetTouches[0].pageX:u.pageX,v=u.type==="touchmove"?u.targetTouches[0].pageY:u.pageY;r=Math.abs(d-t.x),i=Math.abs(v-t.y);if(n===!0&&r>i){u.hasStopedPropagation=!0;return}if(u.hasStopedPropagation===!0)return;if(u.touches.length>1)return;o=d-t.x;if(p&&r>i){var m=f.find(".x-scroll-h");f.hasClass("x-scroll-h")&&(m=f);if(m.length===0)u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1;else{var g=m.get(0).offsetWidth,y=m.get(0).scrollWidth,b=m.get(0).scrollLeft;if(o>0){if(!(b===0&&g<y)){e=!1,n=!0;return}u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1}else{if(b+g!=y){u.hasStopedPropagation=!0,e=!1,n=!0;return}u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1}}}else{if(p){e=!1,n=!0;return}!p&&!n?(u.preventDefault(),u.hasStopedPropagation=!0):!p&&n&&r>i&&(u.hasStopedPropagation=!0)}var w=o/a,E=w*100+"%",S=(-1+w)*100+"%",x=(1+w)*100+"%";if(o>0&&l.length>0)f.transform("translate3d("+E+",0,0)"),f.css("opacity",1-.5*Math.abs(w)),l.addClass("x-content-on-left").removeClass("x-content-on-right"),l.transform("translate3d("+S+",0,0)"),l.css("opacity",.5+.5*Math.abs(w));else{if(!(o<0&&c.length>0)){u.hasStopedPropagation=!1;return}f.transform("translate3d("+E+",0,0)"),f.css("opacity",1-.5*Math.abs(w)),c.addClass("x-content-on-right").removeClass("x-content-on-left"),c.transform("translate3d("+x+",0,0)"),c.css("opacity",.5+.5*Math.abs(w))}}),this.$el.on("touchend",function(t){if(n||!e){e=!1,n=!1,f.transform("").css({opacity:"1"}),l.transform("").css({opacity:""}),c.transform("").css({opacity:""});return}e=!1,n=!1,t instanceof s.Event&&(t=t.originalEvent);var r=(new Date).getTime()-u;if(r<300&&Math.abs(o)>10||r>=300&&Math.abs(o)>a/2){var i=Math.abs(o/a*100);if(o>0&&l.length>0){f.transitionEnd(function(){f.transition(0),l.transition(0),f.addClass("x-content-on-right").removeClass("active"),l.addClass("active").removeClass("x-content-on-left"),f.transform(""),l.transform(""),h.addRouteItem(l),h.active=g,h.EOF=!h.hasNext(),h.contents[g].fireEvent("onActive",{source:h,index:g}),h.getModel().fireEvent("onResize",{source:this}),h.fireEvent("onActiveChanged",{source:h,to:g,from:m,type:"next"}),h.getModel().fireEvent("reflow",l.get(0))}),h.fireEvent("onActiveChange",{source:h,to:g,from:m,type:"next"}),h.contents[m].fireEvent("onInactive",{source:h,index:m}),f.transition(i),l.transition(i),l.transform("translate3d(0,0,0)"),l.css("opacity","1"),f.transform("translate3d(100%,0,0)");return}if(o<0&&c.length>0){f.transitionEnd(function(){f.transition(0),c.transition(0),f.addClass("x-content-on-left").removeClass("active"),c.addClass("active").removeClass("x-content-on-right"),f.transform(""),c.transform(""),h.addRouteItem(c),h.active=y,h.EOF=!h.hasNext(),h.contents[y].fireEvent("onActive",{source:h,index:y}),h.getModel().fireEvent("onResize",{source:this}),h.fireEvent("onActiveChanged",{source:h,to:y,from:m,type:"next"}),h.getModel().fireEvent("reflow",c.get(0))}),h.fireEvent("onActiveChange",{source:h,to:y,from:m,type:"next"}),h.contents[m].fireEvent("onInactive",{source:h,index:m}),f.transition(i),c.transition(i),c.transform("translate3d(0,0,0)"),c.css("opacity","1"),f.transform("translate3d(-100%,0,0)");return}}f.transform("").css({opacity:"1"}),l.transform("").css({opacity:""}),c.transform("").css({opacity:""})})},getActiveIndex:function(){return this.$active=this.$el.find(">.x-contents-content.active"),this.$active.length===0?-1:s(">.x-contents-content",this.$el).index(this.$active)},getIndexByXid:function(e){for(var t=0;t<this.contents.length;t++){var n=this.contents[t];if(n.xid==e)return t}return-1},has:function(e){return this.getIndexByXid(e)!=-1},getActiveXid:function(){return this.$active=this.$el.find(">.x-contents-content.active"),this.$active.attr("xid")},to:function(e,t){if(this.sliding){t&&t();return}typeof e=="string"&&(e=this.getIndexByXid(e));var n=this.getActiveIndex();if(e>s(">.x-contents-content",this.$el).length-1||e<0){t&&t();return}if(n==e){t&&t();if(!this._inited){var r=this.$el.find(">.x-contents-content.active");this.addRouteItem(r),this.contents[e]&&this.contents[e].fireEvent("onActive",{source:this,index:e}),this._inited=!0}return}return this.slide(e>n?"next":"prev",s(s(">.x-contents-content",this.$el)[e]),t)},next:function(e){if(this.sliding)return;return this.slide("next",null,e)},prev:function(e){if(this.sliding)return;return this.slide("prev",null,e)},slide:function(e,t,n){var r=this.$el.find(">.x-contents-content.active"),i=t||r[e](),o=e=="next"?"left":"right",u=e=="next"?"first":"last",a=this;if(!i.length){if(!this.wrap)return;i=this.$el.find(">.x-contents-content")[u]()}var f=i.parent().children().index(i),l=this.contents[f],c=r.parent().children().index(r);if(this.sliding===!0)return;this.sliding=!0;var h=s.Event("slide.container",{relatedTarget:i[0],direction:o});this.fireEvent("onActiveChange",{source:this,to:f,from:c,type:e}),c>=0&&this.contents[c]&&this.contents[c].fireEvent&&this.contents[c].fireEvent("onInactive",{source:this,index:c});if(i.hasClass("active")){this.sliding=!1;return}if(c!=-1&&this._inited&&this.slidable&&s.support.transition){this.$el.trigger(h);if(h.isDefaultPrevented())return;o=="right"?(r.animationEnd(function(){window.requestAnimationFrame(function(){i.addClass("active").removeClass("x-left-to-center"),i.transition(0),i.transform(""),i.css("opacity",1),r.addClass("x-content-on-right").removeClass("active x-center-to-right"),a.sliding=!1,a.active=f,a.EOF=!a.hasNext(),a.getModel().fireEvent("reflow",i.get(0)),a.$el.trigger("slide.container"),a.getModel().fireEvent("onResize",{source:a}),a.addRouteItem(i),a.fireEvent("onActiveChanged",{source:a,to:f,from:c,type:e}),n&&n(),l&&l.fireEvent&&l.fireEvent("onActive",{source:a,index:f})})}),i.addClass("x-left-to-center").removeClass("x-content-on-right x-content-on-left"),r.addClass("x-center-to-right")):(r.animationEnd(function(){window.requestAnimationFrame(function(){i.addClass("active").removeClass("x-right-to-center"),i.transition(0),i.transform(""),i.css("opacity",1),r.addClass("x-content-on-left").removeClass("active x-center-to-left"),a.sliding=!1,a.active=f,a.EOF=!a.hasNext(),a.getModel().fireEvent("reflow",i.get(0)),a.$el.trigger("slide.container"),a.getModel().fireEvent("onResize",{source:a}),a.addRouteItem(i),a.fireEvent("onActiveChanged",{source:a,to:f,from:c,type:e}),n&&n(),l&&l.fireEvent&&l.fireEvent("onActive",{source:a,index:f})})}),i.addClass("x-right-to-center").removeClass("x-content-on-right x-content-on-left"),r.addClass("x-center-to-left"))}else{this.$el.trigger(h);if(h.isDefaultPrevented())return;o=="right"?r.addClass("x-content-on-right").removeClass("active"):r.addClass("x-content-on-left").removeClass("active"),i.removeClass("x-content-on-left x-content-on-right").addClass("active"),this.sliding=!1,a.active=f,a.EOF=!a.hasNext(),this.$el.trigger("slide.container"),this.getModel().fireEvent("onResize",{source:this}),a.addRouteItem(i),this.fireEvent("onActiveChanged",{source:this,to:f,from:c,type:e}),n&&n(),l&&l.fireEvent&&l.fireEvent("onActive",{source:a,index:f}),this._inited=!0,this.getModel().fireEvent("reflow",i.get(0))}return this},add:function(e){return e||(e={}),e.owner=this,e.parentNode=this.$el.get(0),new u(e)},remove:function(e,r){e===undefined&&(e=this.active),typeof e=="string"&&(e=this.getIndexByXid(e)),typeof r=="string"&&(r=this.getIndexByXid(r));var i=this.getLength();if(i>1){var s=this;this.to(r||0,function(){var r=s.contents[e];n.Array.remove(s.contents,r),t.removeComponent(r)})}else{var o=this.contents[e];n.Array.remove(this.contents,o),t.removeComponent(o),delete this.active}},removeOther:function(){var e=this.contents[this.active];for(var n=0;n<this.contents.length;n++){if(n==this.active)continue;var r=this.contents[n];t.removeComponent(r)}this.contents=[e],this.active=0,this.EOF=!this.hasNext()},removeAll:function(){for(var e=0;e<this.contents.length;e++){var n=this.contents[e];t.removeComponent(n)}this.contents=[],this.active=-1,this.EOF=!this.hasNext()},getLength:function(){return s(">.x-contents-content",this.$el).length},propertyChangedHandler:function(e,t,n){switch(e){case"slidable":typeof n=="string"&&(n=n=="true"),this.slidable=!!n,this.slidable&&s(this.domNode).addClass("slidable")}},getContent:function(e){for(var t=0;t<this.contents.length;t++)if(this.contents[t].xid==e)return this.contents[t]},dispose:function(){this.intervaler&&clearInterval(this.intervaler);for(var e=this.contents.length-1;e>=0;e--)t.removeComponent(this.contents[e]);this.contents=null,this.$el=null,s(window).off("."+this.eventNamespace),this.callParent()},hasNext:function(){return this.contents&&this.contents.length>0&&this.active<this.contents.length-1}});return n.Component.addOperations(l,{to:{label:"",argsDef:[{name:"xid",displayName:"切换的content xid",required:!0}],method:function(e){return this.owner.to(e.xid)}},next:{label:"",argsDef:[],method:function(){return this.owner.next()}},prev:{label:"",argsDef:[],method:function(){return this.owner.prev()}}}),t.register(o,l),l}),define("$model/UI2/system/components/justep/controlGroup/controlGroup.config",["require"],function(e){return{properties:{title:"string",collapsible:"boolean",collapsed:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/controlGroup/controlGroup",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./controlGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./controlGroup"),r=e("./controlGroup.config"),i=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.title="",this.collapsible=!1,this.collapsed=!1,this.callParent(e)},dispose:function(){this.callParent()},doInit:function(e,t){this._inited=!0,this.callParent(e,t),this.title||this._getTitleNode().hide();var n=this;this._getTitleNode().on("click",function(e){n.collapsible&&(n.collapsed?n.expand():n.collapse())}),this.collapsible&&this.collapsed&&this.collapse()},collapse:function(){this.$domNode.addClass("x-collapsed").children(":not(.x-control-group-title)").slideUp("fast"),this.collapsed=!0},expand:function(){this.$domNode.removeClass("x-collapsed").children(":not(.x-control-group-title)").removeClass("hide").slideDown("fast"),this.collapsed=!1},propertyChangedHandler:function(e,t,n){switch(e){case"title":if(t!==n&&this._inited){var r=n?"show":"hide",i=this._getTitleNode(),s=i.children("span");s.length>0?s.text(n):i.text(n),i[r]()}break;case"collapsed":t!==n&&(n?this.collapse():this.expand());break;default:this.callParent(e,t,n)}},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-control-group"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" >"+"<div class='x-control-group-title'><span>"+(e.title?e.title:"")+"</span></div>"+"</div>"},_getTitleNode:function(){return this.$domNode.find("div.x-control-group-title:first")}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/dialog/dialog.config",["require"],function(e){return{properties:{showTitle:"boolean",title:"string",status:"string",width:"string",height:"string",top:"string",left:"string",routable:"boolean",resizable:"boolean"},events:["onOpen","onClose"],binds:{}}}),define("$model/UI2/system/components/justep/dialog/dialog",["require","$UI/system/components/justep/common/res","css!./css/dialog","$UI/system/lib/base/layerManager","jquery","$UI/system/lib/justep","./dialog.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/dialog").load();var t=e("$UI/system/lib/base/layerManager"),n=e("jquery"),r=e("$UI/system/lib/justep"),i=e.normalizeName("./dialog"),s=e("./dialog.config"),o=r.BindComponent.extend({getConfig:function(){return s},constructor:function(e){this.callParent(e),this.showTitle=!1,this.title="",this.status="maximize",this.opened=!1,this.width="80%",this.height="80%",this.resizable=!1,this.top=null,this.left=null,this.routable=!1},dispose:function(){r.Browser.isIOS&&r.Util.fixedIosPanel(this.domNode,!1),n(window).off("resize",this.__resizeHandle),this.callParent()},doInit:function(e,t){this._createResizeBar();var r=this;this.$domNode.on("mousewheel",function(e){r.opened&&e.stopPropagation()}),this._getTitleNode().mousedown(function(e){r._dragStart(e)}),this.__dragMoveHandle=this._dragMove.bind(this),this.__dragEndHandle=this._dragEnd.bind(this),this.__closeHandle=this.close.bind(this),this.__resizeHandle=this.doResize.bind(this),this.$domNode.mousemove(this.__dragMoveHandle).mouseup(this.__dragEndHandle).find(".x-dialog-title:first > button.close").on("click",this.__closeHandle),n(window).on("resize",this.__resizeHandle)},_createResizeBar:function(){var e=this._getDialogNode();e.append('<div class="x-resizeBar x-resizeBar-right"/><div class="x-resizeBar x-resizeBar-bottom"/>');var t=this;e.children(".x-resizeBar")[this.resizable?"removeClass":"addClass"]("hide").mousedown(function(e){t._resizeStart(e)}),this.__resizeMoveHandle=this._resizeMove.bind(this),this.__resizeEndHandle=this._resizeEnd.bind(this),this.$domNode.mousemove(this.__resizeMoveHandle).mouseup(this.__resizeEndHandle)},_resizeStart:function(e){var t=e.target,r=n(t);r.is(".x-resizeBar-right")?(this._resizing=!0,this.$domNode.addClass("x-dialog-resize-v"),this._createDragContext(e),this._dragContext.resizeType="right"):r.is(".x-resizeBar-bottom")&&(this._resizing=!0,this.$domNode.addClass("x-dialog-resize-h"),this._createDragContext(e),this._dragContext.resizeType="bottom")},_createDragContext:function(e){var t=this._getDialogNode();this._dragContext={onselectstart:document.onselectstart,x:e.clientX,y:e.clientY,dlg:t.offset(),height:t.innerHeight(),width:t.innerWidth()},document.onselectstart=function(){return!1}},_clsDragContext:function(){this._dragContext&&(document.onselectstart=this._dragContext.onselectstart),this._dragContext=null},_resizeMove:function(e){if(this._resizing&&this.resizable&&this._dragContext){var t,n;this._dragContext.resizeType=="bottom"?(t=e.clientY-this._dragContext.y+this._dragContext.height,n="height"):(t=e.clientX-this._dragContext.x+this._dragContext.width,n="width"),this._getDialogNode().css(n,t),this._resized=!0}},_resizeEnd:function(e){this.$domNode.removeClass("x-dialog-resize-h").removeClass("x-dialog-resize-v"),this._resizing=!1,this._clsDragContext()},_dragStart:function(e){if(this._canMove()){var t=e.target;!n(t).is("button.close")&&!n(t).parent().is("button.close")&&(this.$domNode.addClass("x-dialog-drag"),this._moving=!0,this._createDragContext(e))}},_canMove:function(){return this.status!="maximize"},_dragMove:function(e){if(this._moving&&this._dragContext){var t=e.clientX-this._dragContext.x+this._dragContext.dlg.left,n=e.clientY-this._dragContext.y+this._dragContext.dlg.top;this._getDialogNode().offset({top:n,left:t}),this._moved=!0}},_dragEnd:function(e){this.$domNode.removeClass("x-dialog-drag"),this._moving=!1,this._clsDragContext()},doRoute:function(e,t,n){if(!this.routable)return;e===""&&(n=="enter"?this.open():n=="leave"&&this.close())},addRouteItem:function(e){if(!this.routable)return;var t=this.getModel().$routeState,n=this.$domNode.attr("xid");e=="open"?(t.addState(n,"",""),t.publishState()):e=="close"&&(t.removeState(n,"",""),t.publishState(!0))},doResize:function(){this.opened&&this.render()},buildTemplate:function(e){e||(e={});var t=e.xid||r.UUID.createUUID();return this.set(e),n('<span xid="'+t+'" component="'+i+'">'+'<div class="x-dialog-overlay">'+"</div>"+'<div class="x-dialog" style="display:none;" showTitle="'+!!e.showTitle+'">'+'<div class="x-dialog-title">'+'<button type="button" class="close"><span>×</span></button>'+'<h4 class="x-dialog-title-text">'+(e.title?e.title:"")+"</h4>"+"</div>"+'<div class="x-dialog-body">'+(e.content?e.content:"")+"</div>"+"</div>"+"</span>")},propertyChangedHandler:function(e,t,n){switch(e){case"showTitle":this._inited&&this._getDialogNode()[n?"attr":"removeAttr"]("showTitle","true");break;case"title":t!=n&&this._inited&&this._getTitleTextNode().text(n);break;case"resizable":t!=n&&this._inited&&this._getDialogNode().children(".children")[n?"removeClass":"addClass"]("hide");break;case"status":case"width":case"height":t!=n&&(this.needRender=this._inited);break;default:this.callParent(e,t,n)}},_getDialogNode:function(){return this.$domNode.find("div.x-dialog:first")},_getOverlayNode:function(){return this.$domNode.find("div.x-dialog-overlay:first")},_getTitleTextNode:function(){return this.$domNode.find(".x-dialog-title-text:first")},_getTitleNode:function(){return this.$domNode.find(".x-dialog-title:first")},_getBodyNode:function(){return this.$domNode.find(".x-dialog-body:first")},close:function(){this._getDialogNode().removeClass("x-dialog-in").hide(),this._getOverlayNode().removeClass("x-dialog-overlay-visible"),n("body").removeClass("x-dialog-body-overflow-hidden"),r.Browser.isIOS&&r.Util.fixedIosPanel(this.domNode,!1),this.opened=!1,t.removeLayerIndex(this._getDialogNode()),this.fireEvent("onClose",{source:this}),this.addRouteItem("close")},setContent:function(e){this._getBodyNode().html(e)},render:function(){this.callParent();var e=n(window),t={height:e.height(),width:e.width()},r={height:this.height,width:this.width};this._getOverlayNode().css(t);if(!this._resized){var i=this._getDialogNode();this.status==="maximize"?i.css(t).removeClass("x-dialog-normal"):i.css(r).addClass("x-dialog-normal")}this.opened&&this._setDialogTopLeft()},_setDialogTopLeft:function(){if(this._moved)return;var e=n(window),t=this._getDialogNode(),r=t.outerHeight(),i=e.height(),s=t.outerWidth(),o=e.width(),u=this.top===null?r>=i?10:(i-r)/2:this.top,a=this.left===null?s>=o?0:(o-s)/2:this.left;this.status==="maximize"&&(u=0,a=0),t.css({top:u,left:a})},open:function(e){r.Browser.isMobile&&n("body").addClass("x-dialog-body-overflow-hidden");var i=this._getDialogNode();this._getOverlayNode().addClass("x-dialog-overlay-visible"),this.render(),i.show().addClass("x-dialog-in"),this._setDialogTopLeft(),r.Browser.isIOS&&r.Util.fixedIosPanel(this.domNode,!0),this.addRouteItem("open",e),this.opened=!0,this.fireEvent("onOpen",{source:this}),t.setLayerIndex(i)}});return r.Component.addOperations(o,{open:{label:"",method:function(e){return this.owner.open()}},close:{label:"",method:function(e){return this.owner.close()}}}),r.Component.register(i,o),o}),define("$model/UI2/system/components/justep/input/js/datePicker",["require","jquery","$UI/system/lib/justep","$UI/system/resources/system.res","css!../css/datePicker"],function(e){function r(e,r,i){var f=this,l,c,h,p=!1;this.settings=i,this.values=null,this.val=null,this.temp=null,this.setDefaults=function(e){t.extend(S,e)},this.formatDate=function(e,t,r){return t?n.Date.toString(t,e):null},this.parseDate=function(e,t,r){var i=new Date;return!e||!t?i:n.Date.fromString(t,e)},this.setValue=function(n){n===undefined&&(n=!0);var r=this.formatResult();this.val=r,this.values=this.temp.slice(0),n&&t(e).is("input")&&t(e).val(r).change()},this.getDate=function(){var e=this.values,t=this.settings,n;if(t.preset=="date")return new Date(e[l],e[c],e[h]);if(t.preset=="time")return n=t.ampm&&e[t.seconds?3:2]=="PM"&&e[0]-0<12?e[0]-0+12:e[0],new Date(1970,0,1,n,e[1],t.seconds?e[2]:null);if(t.preset=="datetime")return n=t.ampm&&e[t.seconds?6:5]=="PM"&&e[3]-0<12?e[3]-0+12:e[3],new Date(e[l],e[c],e[h],n,e[4],t.seconds?e[5]:null)},this.setDate=function(e,t){var n=this.settings,r;n.preset.match(/date/i)&&(this.temp[l]=e.getFullYear(),this.temp[c]=e.getMonth(),this.temp[h]=e.getDate()),n.preset=="time"&&(r=e.getHours(),this.temp[0]=n.ampm?r>12?r-12:r===0?12:r:r,this.temp[1]=e.getMinutes(),n.seconds&&(this.temp[2]=e.getSeconds()),n.ampm&&(this.temp[n.seconds?3:2]=r>11?"PM":"AM")),n.preset=="datetime"&&(r=e.getHours(),this.temp[3]=n.ampm?r>12?r-12:r===0?12:r:r,this.temp[4]=e.getMinutes(),n.seconds&&(this.temp[2]=e.getSeconds()),n.ampm&&(this.temp[n.seconds?6:5]=r>11?"PM":"AM")),this.setValue(t)},this.parseValue=function(e){var t=this.settings;if(this.preset){var r=[],i,s;if(t.preset=="date"){try{i=this.parseDate(t.dateFormat,e,t)}catch(o){i=new Date}r[l]=i.getFullYear(),r[c]=i.getMonth(),r[h]=i.getDate()}else if(t.preset=="time"){try{i=this.parseDate(t.timeFormat,e,t)}catch(o){i=new Date}s=i.getHours(),r[0]=t.ampm?s>12?s-12:s===0?12:s:s,r[1]=i.getMinutes(),t.seconds&&(r[2]=i.getSeconds()),t.ampm&&(r[t.seconds?3:2]=s>11?"PM":"AM")}else if(t.preset=="datetime"){try{i=this.parseDate(n.Date.STANDART_FORMAT,e,t)}catch(o){i=new Date}s=i.getHours(),r[l]=i.getFullYear(),r[c]=i.getMonth(),r[h]=i.getDate(),r[3]=t.ampm?s>12?s-12:s===0?12:s:s,r[4]=i.getMinutes(),t.seconds&&(r[5]=i.getSeconds()),t.ampm&&(r[t.seconds?6:5]=s>11?"PM":"AM")}return r}return t.parseValue(e)},this.formatResult=function(){var e=this.settings,t=this.temp,n;if(this.preset){if(e.preset=="date")return this.formatDate(e.format,new Date(t[l],t[c],t[h]),e);if(e.preset=="datetime")return n=e.ampm?t[e.seconds?6:5]=="PM"&&t[3]-0<12?t[3]-0+12:t[e.seconds?6:5]=="AM"&&t[3]==12?0:t[3]:t[3],this.formatDate(e.format,new Date(t[l],t[c],t[h],n,t[4],e.seconds?t[5]:null),e);if(e.preset=="time")return n=e.ampm?t[e.seconds?3:2]=="PM"&&t[0]-0<12?t[0]-0+12:t[e.seconds?3:2]=="AM"&&t[0]==12?0:t[0]:t[0],this.formatDate(e.format,new Date(1970,0,1,n,t[1],e.seconds?t[2]:null),e)}return e.formatResult(t)},this.formatDisplayResult=function(){var e=this.settings,t=this.temp,n;if(this.preset){if(e.preset=="date")return this.formatDate(e.dispalyFormat,new Date(t[l],t[c],t[h]),e);if(e.preset=="datetime")return n=e.ampm?t[e.seconds?6:5]=="PM"&&t[3]-0<12?t[3]-0+12:t[e.seconds?6:5]=="AM"&&t[3]==12?0:t[3]:t[3],this.formatDate(e.dispalyFormat,new Date(t[l],t[c],t[h],n,t[4],e.seconds?t[5]:null),e);if(e.preset=="time")return n=e.ampm?t[e.seconds?3:2]=="PM"&&t[0]-0<12?t[0]-0+12:t[e.seconds?3:2]=="AM"&&t[0]==12?0:t[0]:t[0],this.formatDate(e.dispalyFormat,new Date(1970,0,1,n,t[1],e.seconds?t[2]:null),e)}return e.formatResult(t)},this._validate=function(){var e=this.settings;if(e.startDate||e.endDate){var t=e.startDate?e.startDate.getFullYear():0,n=e.startDate?e.startDate.getMonth():0,i=e.startDate?e.startDate.getDate():1,s=e.endDate?e.endDate.getFullYear():0,o=e.endDate?e.endDate.getMonth():11,u=e.endDate?e.endDate.getDate():31;t==this.temp[l]||s==this.temp[l]?(this._caclRange(r,c,t==this.temp[l]?n:0,s==this.temp[l]?o:11,e.fx),n==this.temp[c]||o==this.temp[c]?this._caclRange(r,h,n==this.temp[c]?i:1,o==this.temp[c]?u:31,e.fx,!0):this._caclRange(r,h,1,31,e.fx,!0)):(this._caclRange(r,c,0,11,e.fx),this._caclRange(r,h,1,31,e.fx,!0))}},this._caclRange=function(e,n,r,i,s,o){var u=t("ul:eq("+n+")",e);t("li",u).show(),t("li:lt("+(r-(o?1:0))+")",u).hide(),t("li:gt("+(i-(o?1:0))+")",u).hide(),this.temp[n]<r?(this.temp[n]=r,this._caclPos(u,this.temp[n]-r,s)):r>=0&&this.temp[n]>=r&&this._caclPos(u,this.temp[n]-r,s),this.temp[n]>i?(this.temp[n]=i,this._caclPos(u,this.temp[n]-r,s)):this.temp[n]<=i&&this._caclPos(u,this.temp[n]-r,s)},this._caclPos=function(e,t,n){n?e.animate({top:o*(u-t-1)+"px"},"fast"):e.css({top:o*(u-t-1)})},this.validate=function(e){var n=this.settings;if(this.preset&&n.preset.match(/date/i)&&(e==l||e==c)){var i=32-(new Date(this.temp[l],this.temp[c],32)).getDate()-1,s=t("ul:eq("+h+")",r);t("li",s).show(),t("li:gt("+i+")",s).hide(),this.temp[h]>i&&(this._caclPos(s,i,n.fx),this.temp[h]=t("li:visible:eq("+i+")",s).data("val"))}else x.validate(e);this._validate()},this.hide=function(){n.Util.enableTouchMove(document.body),this.settings.onClose(this.val,this),t(e).blur(),r.hide(),s.hide(),p=!1,this.preset&&(this.settings.wheels=null),t(window).off("resize.dw")},this.show=function(){n.Util.disableTouchMove(document.body);var i,d=this.settings;d.beforeShow(e,this),o=d.height,u=Math.round(d.rows/2),a=this,this.init();if(this.values!==null)this.temp=this.values.slice(0);else{var v=n.Component.getComponent(e),m=v.val?v.val():"",g=n.Date.fromString(m,n.Date.STANDART_FORMAT_SHOT);d.startDate&&d.startDate>g&&(m=n.Date.toString(d.startDate,n.Date.STANDART_FORMAT_SHOT)),d.endDate&&d.endDate<g&&(m=n.Date.toString(d.endDate,n.Date.STANDART_FORMAT_SHOT)),this.temp=this.parseValue(m),this.setValue(!1)}var y=parseInt(this.temp[0],10);d.startYear=y-20,d.startDate&&d.startDate.getFullYear()>d.startYear&&(d.startYear=d.startDate.getFullYear()),d.endYear=y+20,d.endDate&&d.endDate.getFullYear()<d.endYear&&(d.endYear=d.endDate.getFullYear());if(this.preset){d.wheels=[];var b={};if(d.preset.match(/date/i)){for(var w=0;w<3;w++)if(w==l){b[d.yearText]={};for(i=d.startYear;i<=d.endYear;i++)b[d.yearText][i]=d.dateOrder.search(/yy/i)<0?i.toString().substr(2,2):i.toString()}else if(w==c){b[d.monthText]={};for(i=0;i<12;i++)b[d.monthText][i]=d.dateOrder.search(/MM/)<0?d.dateOrder.search(/M/)<0?d.dateOrder.search(/mm/)<0?i+1:i<9?"0"+(i+1):i+1:d.monthNamesShort[i]:d.monthNames[i]}else if(w==h){b[d.dayText]={};for(i=1;i<32;i++)b[d.dayText][i]=d.dateOrder.search(/dd/i)<0?i:i<10?"0"+i:i}d.wheels.push(b)}if(d.preset.match(/time/i)){d.stepHour=d.stepHour<1?1:parseInt(d.stepHour,10),d.stepMinute=d.stepMinute<1?1:parseInt(d.stepMinute,10),d.stepSecond=d.stepSecond<1?1:parseInt(d.stepSecond,10),b={},b[d.hourText]={};for(i=0;i<(d.ampm?13:24);i+=d.stepHour)b[d.hourText][i]=i<10?"0"+i:i;b[d.minuteText]={};for(i=0;i<60;i+=d.stepMinute)b[d.minuteText][i]=i<10?"0"+i:i;if(d.seconds){b[d.secText]={};for(i=0;i<60;i+=d.stepSecond)b[d.secText][i]=i<10?"0"+i:i}d.ampm&&(b[d.ampmText]={},b[d.ampmText].AM="AM",b[d.ampmText].PM="PM"),d.wheels.push(b)}}t(".dwc",r).remove();for(i=0;i<d.wheels.length;i++){var S=t('<div class="dwc '+(d.showLabel?"showl":"")+'"><div class="dwwc"><div class="clear" style="clear:both;"></div></div>').insertBefore(t(".dwbc",r));for(var x in d.wheels[i]){var T=t(".dwwc .clear",S),N=t('<div class="dwwl">'+(d.showLabel?'<div class="dwl">'+x+"</div>":"")+'<div class="dww"><ul></ul><div class="dwwo"></div></div><div class="dwwol"></div></div>').insertBefore(T);for(var C in d.wheels[i][x])t('<li class="val_'+C+'">'+d.wheels[i][x][C]+"</li>").data("val",C).appendTo(t("ul",N))}}t(".dww ul",r).each(function(e){var n=t("li",this).index(t("li.val_"+f.temp[e],this));while(n<0&&--f.temp[e]>=0)n=t("li",this).index(t("li.val_"+f.temp[e],this));var r=o*(u-(n<0?0:n)-1);t(this).css("top",r)}),t(".dwv",r).html(this.formatDisplayResult()),t("#dw_set",r).addClass(d.btnClass+" btn-default").text(d.setText).unbind().bind("click",function(e){return f.setValue(),d.onSelect(f.val,a),f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),t("#dw_cls",r).addClass(d.btnClass+" btn-default").text(d.clsText).unbind().bind("click",function(n){return t(e).val("").change(),f.values=null,d.onSelect(f.val,a),f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),t("#dw_cancel",r).addClass(d.btnClass+" btn-default").text(d.cancelText).unbind().bind("click",function(e){return f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),this._validate(),s.show(),r.attr("class","dw "+d.theme).show(),p=!0,t(".dww, .dwwl",r).height(d.rows*o),t(".dww",r).each(function(){t(this).width(t(this).parent().width()<d.width?d.width:t(this).parent().width())}),t(".dww li",r).css({height:o,lineHeight:o+"px"}),t(".dwwc",r).each(function(){var e=0;t(".dwwl",this).each(function(){e+=t(this).outerWidth(!0)}),t(this).width(e)}),t(".dwc",r).each(function(){t(this).width(t(".dwwc",this).outerWidth(!0))}),t(window).on("resize.dw",function(){f.pos()}),window.setTimeout(function(){f.pos()},10)},this.pos=function(){var e=0,n=0,i=t(window).width(),o=t(window).height(),u=t(window).scrollTop(),a,f;t(".dwc",r).each(function(){a=t(this).outerWidth(!0),e+=a,n=a>n?a:n}),a=e>i?n:e,r.width(a),a=r.outerWidth(),f=r.outerHeight(),r.css({left:(i-a)/2,top:u+(o-f)/2}),s.height(0),s.height(t(document).height())},this.init=function(){var e=this.settings,t=e.dateOrder.search(/y/i),n=e.dateOrder.search(/m/i),r=e.dateOrder.search(/d/i);l=t<n?t<r?0:1:t<r?1:2,c=n<t?n<r?0:1:n<r?1:2,h=r<t?r<n?0:1:r<n?1:2,this.preset=e.wheels===null},this.init(),t(e).is("input")?t(e).attr("readonly","readonly").data("readonly",t(e).attr("readonly")):!1,t(e).addClass("scroller").off("click.dw").bind("click.dw",function(n){if(E)return t(e).blur(),setTimeout(function(){t(e).removeClass("ui-focus")},50),!1;!f.settings.disabled&&f.settings.showOnFocus&&!p&&f.show()})}var t=e("jquery"),n=e("$UI/system/lib/justep");e("$UI/system/resources/system.res"),e("css!../css/datePicker").load();var i,s,o,u,a,f={},l=new Date,c=l.getTime(),h=!1,p=null,d,v,m,g="ontouchstart"in window,y=g?"touchstart":"mousedown",b=g?"touchmove":"mousemove",w=g?"touchend":"mouseup",E=!1,S={width:80,height:40,rows:3,fx:!1,disabled:!1,showOnFocus:!0,showOnTap:!0,wheels:null,theme:"",preset:"date",dateFormat:"yyyy-MM-dd",dateOrder:"yyyymmdd",ampm:!0,seconds:!1,timeFormat:"hh:mm:ss",startDate:null,endDate:null,startYear:l.getFullYear()-10,endYear:l.getFullYear()+10,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],shortYearCutoff:"+10",showLabel:!1,monthText:(new n.Message(n.Message.JUSTEP231502)).getMessage(),dayText:(new n.Message(n.Message.JUSTEP231503)).getMessage(),yearText:(new n.Message(n.Message.JUSTEP231504)).getMessage(),hourText:(new n.Message(n.Message.JUSTEP231505)).getMessage(),minuteText:(new n.Message(n.Message.JUSTEP231506)).getMessage(),secText:(new n.Message(n.Message.JUSTEP231507)).getMessage(),ampmText:"&nbsp;",setText:(new n.Message(n.Message.JUSTEP231500)).getMessage(),clsText:(new n.Message(n.Message.JUSTEP231508)).getMessage(),cancelText:(new n.Message(n.Message.JUSTEP231501)).getMessage(),btnClass:"btn btn-sm",stepHour:1,stepMinute:1,stepSecond:1,beforeShow:function(){},onClose:function(){},onSelect:function(){},formatResult:function(e){var t="";for(var n=0;n<e.length;n++)t+=(n>0?" ":"")+e[n];return t},parseValue:function(e){return e.split(" ")}},x={init:function(e){var n=t.extend({},S,e);if(t(".dwo").length)s=t(".dwo"),i=t(".dw");else{s=t('<div class="dwo"></div>').hide().appendTo("body"),i=t('<div class="dw"><div class="dwv">&nbsp;</div><div class="dwbc" style="clear:both;"><a id="dw_set" href="#"></a><a id="dw_cls" href="#"></a><a id="dw_cancel" href="#"></a></div></div>'),i.hide().appendTo("body"),t(document).bind(b,function(e){if(h)return v=g?e.originalEvent.changedTouches[0].pageY:e.pageY,p.css("top",m+v-d+"px"),e.preventDefault(),e.stopPropagation(),!1});var l=function(e,n,r){n=n>(u-1)*o?(u-1)*o:n,n=n<u*o-t("li:visible",e).length*o?u*o-t("li:visible",e).length*o:n;var s=t("ul",i).index(e);a.temp[s]=t("li:visible:eq("+(u-1-n/o)+")",e).data("val"),a.validate(s),t(".dwv",i).html(a.formatDisplayResult());if(a.settings.preset!="time"&&0===s){var f,l=a.settings,c=parseInt(a.temp[s],10),h=l.wheels[0];if(r&&l.endYear-c<=5){var p=l.endYear;l.endYear=c+15,l.endDate&&l.endDate.getFullYear()<l.endYear&&(l.endYear=l.endDate.getFullYear());for(f=p+1;f<=l.endYear;f++)h[l.yearText][f]=l.dateOrder.search(/yy/i)<0?f.toString().substr(2,2):f.toString(),t('<li class="val_'+f+'">'+h[l.yearText][f]+"</li>").data("val",f).appendTo(t(e))}else if(!r&&c-l.startYear<=5){var d=l.startYear;l.startYear=c-15,l.startDate&&l.startDate.getFullYear()>l.startYear&&(l.startYear=l.startDate.getFullYear());for(f=d+1;f>=l.startYear;f--)h[l.yearText][f]=l.dateOrder.search(/yy/i)<0?f.toString().substr(2,2):f.toString(),t('<li class="val_'+f+'">'+h[l.yearText][f]+"</li>").data("val",f).prependTo(t(e)),n-=o}}a.settings.fx?e.stop(!0,!0).animate({top:n+"px"},"fast"):e.css("top",n)};t(document).bind(w,function(e){if(h){var n=Math.round((m+v-d)/o)*o;n=n>(u-1)*o?(u-1)*o:n,n=n<u*o-t("li:visible",p).length*o?u*o-t("li:visible",p).length*o:n,l(p,n,v-d<0),h=!1,p=null,e.preventDefault(),e.stopPropagation()}}),t(document).on(y,".dwwl",function(e){h||(h=!0,p=t("ul",this),m=p.css("top").replace(/px/i,"")-0,d=g?e.originalEvent.changedTouches[0].pageY:e.pageY,v=d,e.preventDefault(),e.stopPropagation())})}return this.each(function(){this.id||(c+=1,this.id="scoller"+c),f[this.id]=new r(this,i,n)})},validate:function(){},enable:function(){return this.each(function(){f[this.id]&&(f[this.id].settings.disabled=!1)})},disable:function(){return this.each(function(){f[this.id]&&(f[this.id].settings.disabled=!0)})},isDisabled:function(){if(f[this[0].id])return f[this[0].id].settings.disabled},option:function(e,n){return this.each(function(){f[this.id]&&(typeof e=="object"?t.extend(f[this.id].settings,e):f[this.id].settings[e]=n,f[this.id].init())})},setValue:function(e,t){return t===undefined&&(t=!1),this.each(function(){f[this.id]&&(f[this.id].temp=e,f[this.id].setValue(e,t))})},getValue:function(){if(f[this[0].id])return f[this[0].id].values},setDate:function(e,t){return t===undefined&&(t=!1),this.each(function(){f[this.id]&&f[this.id].setDate(e,t)})},getDate:function(){if(f[this[0].id])return f[this[0].id].getDate()},show:function(){if(f[this[0].id])return f[this[0].id].show()},hide:function(){return this.each(function(){f[this.id]&&f[this.id].hide()})},destroy:function(){return this.each(function(){f[this.id]&&(t(this).unbind("focus.dw").removeClass("scroller"),t(this).is("input")?t(this).attr("readonly",t(this).data("readonly")):!1,delete f[this.id])})}};t.fn.datePicker=function(e){if(x[e])return x[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return x.init.apply(this,arguments);t.error("Unknown method")},t.datePicker=new r(null,null,S)}),define("$model/UI2/system/components/justep/input/js/decimalFormat",["require"],function(e){var t=function(e){this.applyPattern(e)};return t.SPECIAL_CHARS=["0",".","-",",","E","%","¤","‰"],t.prototype.applyPattern=function(e){function n(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}e===undefined&&(e="");for(var r=0;r<e.length;r++)if(!n(t.SPECIAL_CHARS,e.charAt(r)))return;this.pattern=e},t.prototype.format=function(e){if(isNaN(e))return e;var t=this.pattern;if(!t)return e;var n=""+e,r=parseFloat(e),i=!1;r<0&&(i=!0),i&&(n=n.substring(1,n.length),r=-r);var s=t.indexOf("%"),o=t.indexOf(",");if(s!=-1||o!=-1&&s!=-1)return e;var u,a,f,l;if(s!=-1){if(s!=t.length-1)return e;t=t.substring(0,t.length-1),r=parseFloat(e)*100,n=""+r,i&&(n=n.substring(1,n.length),r=-r)}u=t.indexOf("."),a=n.indexOf(".");var c="";u!=-1?(a==-1&&(a=n.length-1),f=t.length-u,l=parseFloat(n).toFixed(f-1),i?c="-"+l:c=l):(a==-1&&(a=n.length-1),l=parseFloat(n).toFixed(),i?c="-"+l:c=l),s!=-1&&(c+="%");var h="",p=0;if(o!=-1&&c.length){u=c.indexOf(".");for(var d=c.length-1;d>=0;d--){var v=c.charAt(d);u!=-1&&d>=u?h=v+h:(p==3&&v!="-"?(p=1,h=","+h):p++,h=v+h)}c=h}return c},t}),define("$model/UI2/system/components/justep/input/input.config",["require"],function(e){return{properties:{dataType:"string",placeHolder:"string",pattern:"string",format:"string",min:"string",max:"string",maxLength:"integer",autoFocus:"boolean",autoComplete:"boolean",disabled:"boolean",readonly:"boolean",valueUpdateMode:"string"},events:["onChange","onRender","onFocus","onBlur"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/input",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./js/datePicker","./js/decimalFormat","./input.config"],function(require){require("$UI/system/components/justep/common/res");var $=require("jquery"),justep=require("$UI/system/lib/justep");require("./js/datePicker");var DecimalFormat=require("./js/decimalFormat"),url=require.normalizeName("./input"),ComponentConfig=require("./input.config"),TypeRegExp={Integer:/(^-?$)|(^-?[0-9]*$)/,Long:/(^-?$)|(^-?[0-9]*$)/,Decimal:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/,Float:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/,Double:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/},getAfterPressText=function(e,t){var n=e,r,i,s,o;if(justep.Browser.IE&&!justep.Browser.IE11){var u=document.selection.createRange();i=u.text,s=n.createTextRange(),r=s.text,u.setEndPoint("StartToStart",s),o=u.text}else i=window.getSelection().toString(),"number"!=$(n).attr("type")?s=n.selectionEnd:s=n.value.length,r=n.value,o=n.value.substring(0,s);var a=t,f=r.substr(o.length),l=o.substr(0,o.length-i.length)+a+f;return l},Input=justep.BindComponent.extend({getConfig:function(){return ComponentConfig},constructor:function(e){this.callParent(e),this.readonly=!1,this.placeHolder="",this.value="",this.format="",this.pattern="",this.autoFocus=!1,this.autoComplete=!1,this.min=null,this.max=null,this.minLength=1,this.maxLength=null,this.dataType="String",this.valueUpdateMode=null},dispose:function(){this.$domNode.off("change focus blur keypress paste touchstart"),this.$domNode.datePicker&&this.$domNode.datePicker("destroy"),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+url+"' "+" ></input>"},_doDataTypeChange:function(){if(justep.Bind.isObservable(this.ref)&&this.ref.define){var e=this.ref.define.defCol,t=e.type,n=e.size,r={},i=!1;t!==this.dataType&&(r.dataType=t,i=!0),n&&(r.maxLength=n,i=!0),i&&this.set(r)}},_showMobileDatePicker:function(){var e=this;(e.dataType=="DateTime"||e.dataType=="Date"||e.dataType=="Time")&&e._datePickerPromise.done(function(t){t._input=e;var n={type:e.dataType.toLowerCase()};e.min&&(n.min=e._doCalcDateExpr(e.min)),e.max&&(n.max=e._doCalcDateExpr(e.max)),t.set(n),t.show();var r=e.val();r?r=e.dataType=="DateTime"?justep.Date.fromString(r,"yyyy-MM-ddThh:mm:ss.fff"):e.dataType=="Date"?justep.Date.fromString(r,justep.Date.STANDART_FORMAT_SHOT):justep.Date.fromString(r,justep.Date.STANDART_TIME_FORMAT):r=new Date,r instanceof Date&&(n.min instanceof Date&&r.getTime()<n.min.getTime()?r=n.min:n.max instanceof Date&&r.getTime()>n.max.getTime()&&(r=n.max)),t.setValue(r)})},_createMobileDatePicker:function(){var e=this;if(e.dataType=="DateTime"||e.dataType=="Date"||e.dataType=="Time")if("mobiscroll"!==Input.mobileDatePickerType){var t=this.getModel();t.__justep__||(t.__justep__={});var n=t.__justep__._input_g_datepicker_,r=$.Deferred();this._datePickerPromise=r.promise(),n?r.resolve(n):require(["$UI/system/components/justep/datePicker/datePicker"],function(i){n=t.__justep__._input_g_datepicker_;if(!n){if(!t.isDestroyed&&(e.dataType=="DateTime"||e.dataType=="Date"||e.dataType=="Time")){n=new i({parentNode:t.getRootNode(),onOK:function(e){var t=e.source._input;if(t instanceof Input){var n=e.source.getValue();n=t.dataType=="DateTime"?justep.Date.toString(n,justep.Date.STANDART_FORMAT):t.dataType=="Date"?justep.Date.toString(n,justep.Date.STANDART_FORMAT_SHOT):justep.Date.toString(n,justep.Date.STANDART_TIME_FORMAT),t.val(n),$(t.domNode).change()}e.source._input=null}});var s=$('<button class="btn btn-link x-btn-clear">'+justep.Message.getMessage(justep.Message.JUSTEP231508)+" </button>");s.on("click",function(){var e=n._input;e instanceof Input&&(e.clear(),$(e.domNode).change(),n.hide())}),n.getHeader$().prepend(s),t.__justep__._input_g_datepicker_=n,r.resolve(n)}}else r.resolve(n)}),e.$domNode.on("click.datapicker",function(){e._showMobileDatePicker()})}},_bindDataType:function(){if(this.dataType=="DateTime"||this.dataType=="Date"||this.dataType=="Time"){this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss"));var e=this,t=this.dataType.toLowerCase(),n=justep.Date.STANDART_FORMAT;t=="date"?n=justep.Date.STANDART_FORMAT_SHOT:t=="time"&&(n="hh:mm:ss"),this.$domNode.addClass(t).attr("readonly",justep.Browser.isMobile);if(justep.Browser.isMobile)"mobiscroll"!==Input.mobileDatePickerType?this._createMobileDatePicker():this.$domNode.datePicker({preset:t,seconds:!0,ampm:!1,format:n,dispalyFormat:this.format,beforeShow:function(t,n){e.min&&(n.settings.startDate=e._doCalcDateExpr(e.min)),e.max&&(n.settings.endDate=e._doCalcDateExpr(e.max))}});else{var r=this;this.$domNode.on("click.datapicker",function(){require(["./js/datePickerPC"],function(e){(r.dataType=="DateTime"||r.dataType=="Date"||r.dataType=="Time")&&e.show(r,t==="date"?0:t==="time"?4:3,!0)})})}}else this.dataType&&this.$domNode.addClass(this.dataType.toLowerCase())},_updateType:function(){var e=this.$domNode.attr("type");e!="email"&&e!="url"&&e!="password"&&e!="range"&&e!="search"&&e!="color"&&(this.dataType=="Integer"||this.dataType=="Long"||this.dataType=="Decimal"||this.dataType=="Float"||this.dataType=="Double"?this.$domNode.attr("type",justep.Browser.isMobile?"number":"tel"):this.$domNode.attr("type","text")),this._isRestoreType=!1},_restoreType:function(){var e=this.$domNode.attr("type");(e=="number"||e=="tel")&&this.$domNode.attr("type","text"),this._isRestoreType=!0},_unbindDataType:function(e){this.$domNode&&(this.$domNode.removeClass((""+e).toLowerCase()),(e=="DateTime"||e=="Date"||e=="Time")&&this.$domNode.attr("readonly",this.readonly).off("click.datapicker").datePicker("destroy"))},_doCalcDateExpr:function(e){var t=this._doCalcExpr(e);justep.Bind.isObservable(t)&&(t=t.get());if(t instanceof Date)return t;if("string"==typeof t)return justep.Date.fromString(t,justep.Date.STANDART_FORMAT_SHOT);var n=new justep.Message(justep.Message.JUSTEP231090);throw justep.Error.create(n)},_doCalcExpr:function(e){this._expr=this._expr||{},this._expr[e]||(this._expr[e]=new justep.Express(e));var t=justep.Bind.contextFor(this.domNode);return justep.Express.eval(this._expr[e],t.$object,t)},doInit:function(e,t,n){var r=this,i=function(){r._updateType();if(!r.$domNode.prop("readonly")&&r.value!=r.$domNode.val())if("DateTime"===r.dataType){var e=r.value,t=e instanceof Date?e:justep.Date.fromString(e,justep.Date.STANDART_FORMAT);t instanceof Date&&r.$domNode.val(justep.Date.toString(t,"yyyy-MM-dd hh:mm:ss"))}else r.$domNode.val(r.value)},s=$.proxy(this.doChange,this);this.$domNode.on("change",s).on("touchstart",function(){if(r._focusin)return;i(),r._restoreHandle&&clearTimeout(r._restoreHandle),r._restoreHandle=setTimeout(justep.Util.bindModelFn(r.getModel(),function(){r.$domNode&&!r._focusin&&(r._restoreType(),r.render())}),1e3)}).on("focus",function(){r.fireEvent("onFocus",{source:this}),r._focusin=!0,r._isRestoreType&&i()}).on("blur",function(){r._focusin=!1,justep.Browser.IE&&r.doChange(),r._restoreType(),r.render(),r.fireEvent("onBlur",{source:this})}).on("keypress paste",function(e){return r._doKeypress(e)}),typeof this.valueUpdateMode=="string"&&(this.valueUpdateMode=this.valueUpdateMode.split(",")),$.isArray(this.valueUpdateMode)&&$.each(this.valueUpdateMode,function(e,t){t&&r.$domNode.on(t,s)}),this._bindDataType()},isDisabled:function(){return this.readonly||this.callParent()},_doKeypress:function(evt){if(13===evt.keyCode){justep.Browser.IE>=9&&!this.isDisabled()&&!this.$domNode.prop("readonly")&&!this.$domNode.prop("disabled")&&this.doChange(evt);return}var regExp=TypeRegExp[this.dataType],ok,keyCode,afterPressText;if(justep.Browser.FF&&(evt.key!=="MozPrintableKey"||evt.key==="MozPrintableKey"&&evt.ctrlKey))return;var cbd=window.clipboardData||evt.clipboardData||evt.originalEvent.clipboardData;evt.type==="paste"&&cbd?keyCode=cbd.getData("text"):keyCode=String.fromCharCode(justep.Browser.FF?evt.which:evt.keyCode);if(regExp||this.pattern)afterPressText=getAfterPressText(this.domNode,keyCode);regExp&&(ok=regExp.test(afterPressText));if((ok||ok===undefined)&&this.pattern)try{regExp=eval("/"+this.pattern+"/"),regExp&&(ok=regExp.test(afterPressText))}catch(e){}return this.maxLength&&afterPressText&&afterPressText.length>this.maxLength&&(ok=!1),evt.returnValue=ok,!justep.Browser.FF&&!evt.returnValue&&(evt.keyCode=0),evt.returnValue},doUpdate:function(e,t,n){this._doDataTypeChange(),this.callParent(e,t,n)},propertyChangedHandler:function(e,t,n){switch(e){case"format":this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss")),t!=n&&(this.needRender=this._inited);break;case"value":t!=n&&this._inited&&(this.val2ref(),this.fireEvent("onChange",{source:this,originalValue:t,value:n})),this.needRender=this._inited&&!this._focusin;break;case"dataType":t!=n&&(this.needRender=this._inited,this._dataTypeChanged=!0,this._unbindDataType(t));break;default:this.callParent(e,t,n)}},render:function(){this.callParent(),this._dataTypeChanged&&(this._bindDataType(),this._dataTypeChanged=!1);var e=this.value,t;e&&("DateTime"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,"yyyy-MM-ddThh:mm:ss.fff"),e=t instanceof Date?justep.Date.toString(t,this.format):e):"Date"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,justep.Date.STANDART_FORMAT_SHOT),e=t instanceof Date?justep.Date.toString(t,this.format):e):"Time"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,"hh:mm:ss"),e=t instanceof Date?justep.Date.toString(t,this.format):e):this.format&&("Integer"==this.dataType||"Long"==this.dataType||"Float"==this.dataType||"Double"==this.dataType||"Decimal"==this.dataType)&&(e=(new DecimalFormat(this.format)).format(e)));if(e===undefined||e===null)e="";var n={source:this,value:this.value,text:e};this.fireEvent("onRender",n),this.$domNode.val(n.text)},val:function(e){if(arguments.length===0)return this.value;this.set({value:e})},doChange:function(e){var t=this.$domNode.val();if(t&&"DateTime"==this.dataType){var n=justep.Date.fromString(t,justep.Date.STANDART_FORMAT);if(!n){n=justep.Date.fromString(t,"yyyy-MM-dd hh:mm:ss"),n||(n=justep.Date.fromString(t,this.format)),n||(n=justep.Date.fromString(t,justep.Date.STANDART_FORMAT_SHOT));if(!n){justep.Util.hint({text:justep.Message.getMessage(justep.Message.JUSTEP231516),type:"danger",delay:8e3});return}t=justep.Date.toString(n,justep.Date.STANDART_FORMAT)}}this.set({value:t})},clear:function(){this.set({value:null}),this.$domNode.val("")}});return justep.Component.register(url,Input),Input}),define("$model/UI2/system/components/justep/input/password.config",["require"],function(e){return{properties:{data:"string",relation:"string",placeHolder:"string",disabled:"boolean",readonly:"boolean",valueUpdateMode:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/password",["require","$UI/system/lib/justep","./input","./password.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./input"),r=e.normalizeName("./password"),i=e("./password.config"),s=n.extend({getConfig:function(){return i},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' type='password'"+" ></input>"}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/input/range.config",["require"],function(e){return{properties:{data:"string",relation:"string",min:"number",max:"number",disabled:"boolean"},events:["onChange","onRender"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/range",["require","$UI/system/lib/justep","./input","./range.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./input"),r=e.normalizeName("./range"),i=e("./range.config"),s=n.extend({constructor:function(e){this.callParent(e),this.min=0,this.max=100},getConfig:function(){return i},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]=""),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' type='range'"+" ></input>"}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/input/js/datePickerPC",["require","jquery","$UI/system/lib/justep","$UI/system/resources/system.res","css!../css/datePickerPC"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep");e("$UI/system/resources/system.res"),e("css!../css/datePickerPC").load();var r=n.Object.extend({constructor:function(e,r,i,s,o,u,a,f){var l=this;this.element=t("body").append("<ul/>").children().last().addClass(r).get(0),this.move=0,this.input=i,n.Browser.hasTouch&&(this.input.readOnly=!0),this.min=s,this.max=o,this.minlength=u||1,t(i).bind("keypress",function(e){l.hide();if(e.keyCode<48||e.keyCode>57){e.returnValue=!1;return}}).bind("paste",function(e){e.returnValue=!1}).bind("click",function(e){l.show(),i.select()}).bind("change",function(e){var n=parseInt(t(i).val());n<l.min&&t(i).val(l.min),n>l.max&&t(i).val(l.max)}),this.setParam(s,o,u,a,f)},setParam:function(e,n,r,i,s){t(this.element).empty();var o=this;this.min=e,this.max=n,i=i||7,this.canShowAll=this.max-this.min+1<=i,this.canShowAll||this.createChild("-",function(){o.isFocus=!0,o.start(-1)},function(){o.isFocus=!1,o.stop(),t(o.input).focus()}),this.showItem=i,this.canShowAll&&(this.showItem=this.max-this.min+1);var u=function(e){o.isFocus=!0},a=function(e){var n=t(e.target).text(),r=t(o.input).val(n);o.input.readOnly||r.focus(),o.isFocus=!1,o.hide(),t(o.input).change(),s&&s(n)};for(var f=0;f<this.showItem;f++)this.createChild(" ",u,a);this.canShowAll||this.createChild("+",function(){o.isFocus=!0,o.start(1)},function(){o.isFocus=!1,o.stop(),t(o.input).focus()}),this.hide()},hideEvent:function(e){var t=e.target||e.srcElement,n=r.activeObj;n&&t.parentElement!=n.element&&n.hide()},show:function(){var e=this.input;this.current=parseInt(e.value||this.min),this.refresh();var n=t(e),i=t(this.element);i.css({top:-3e3,left:-3e3}).show();var s=n.offset(),o=s.top-i.outerHeight(!0),u=t(document).height()<s.top+n.outerHeight(!0)+i.outerHeight(!0)&&o>0;i.css({top:u?s.top-i.outerHeight(!0):s.top+n.outerHeight(!0),left:s.left}),r.activeObj=this,t("body").bind("mousedown touchstart",this.hideEvent)},hide:function(){t("body").unbind("mousedown touchstart",this.hideEvent),r.activeObj=null,t(this.element).hide()},createChild:function(e,i,s){var o=t(this.element).append("<li/>").children().last().get(0);t(o).text(e),r.initHover(o),s?n.Browser.hasTouch?t(o).bind("click",function(e){i(e),s(e)}):(t(o).bind("mousedown",i),t(o).bind("mouseup",s)):t(o).bind("click",i)},refresh:function(){var e=t(this.element).children(),n,r,i;if(this.canShowAll){n=this.min;var s=function(e,t){this.element.scrollTop=e.outerHeight()*(t-3)};for(r=0;r<=this.max-this.min;r++){t(e.get(r)).removeClass("hover"),i=n++ +"";for(;i.length<this.minlength;i="0"+i);t(e.get(r)).text(i);if(n==this.current&&r>3){var o=t(e.get(r)),u=r;window.setTimeout(s.bind(this,o,u),10)}}}else{var a=parseInt(this.showItem/2),f=this.current;f>=this.max-a?f=this.max-a:f<=this.min+a&&(f=this.min+a),n=f-a-1;for(r=1;r<this.showItem+1;r++){t(e.get(r)).removeClass("hover"),i=n+r+"";for(;i.length<this.minlength;i="0"+i);t(e.get(r)).text(i)}}},start:function(e){this.move=e,r.current=this,this.run()},stop:function(){this.move=0},run:function(){if(this.move>0&&this.current+3<this.max||this.move<0&&this.current-3>this.min)this.current+=this.move,this.refresh(),setTimeout(function(){r.current.run()},60)}});r.current=null,r.initHover=function(e){t(e).hover(function(e){t(e.srcElement||e.target).addClass("hover")},function(e){t(e.srcElement||e.target).removeClass("hover")})};var i=n.Object.extend({constructor:function(){var e=document.getElementsByTagName("body")[0];this.element=t("table[name='_calendar_']").size()<=0?t(e).append(i.HTML()).children().last().get(0):t("table[name='_calendar_']").get(0),this.modalCover=t("div[name='_modal_cover_']").size()<=0?t(e).append("<div name='_modal_cover_' class='modalCover'/>").children().last().get(0):t("div[name='_modal_cover_']").get(0),t(e).bind("mousedown touchstart",function(e){var t=i.get(),n=t.element;if(n.style.display!="none"){var r=e.srcElement||e.target;if(r.parentElement==t.monthList.element||r.parentElement==t.yearList.element||r.parentElement==t.hourList.element||r.parentElement==t.minList.element||r.parentElement==t.secList.element)return;for(;r&&r!=n;r=r.parentNode);r||i.get().hide()}});var s=function(){var e=i.get(),r=e.inputYear.value,s=e.inputMonth.value-1,o=e.day;r<1900&&(r=1900),r>2099&&(r=2099),s<0&&(s=0),s>11&&(s=11);var u=new Date;u.setDate(1),u.setYear(r),u.setMonth(s),u.setDate(o),e.input.focus&&e.input.focus();if(e.isTimestamp){var a=e.inputHour.value,f=e.inputMin.value,l=e.inputSec.value;a>23&&(a=23),f>59&&(f=59),l>59&&(l=59),u.setMinutes(f),u.setHours(a),u.setSeconds(l);var c=e.isTime?n.Date.toString(u,n.Date.STANDART_TIME_FORMAT):n.Date.toString(u,n.Date.STANDART_FORMAT);"function"==typeof e.input.val?e.input.val(c):t(e.input).val(c)}else"function"==typeof e.input.val?e.input.val(n.Date.toString(u,n.Date.STANDART_FORMAT_SHOT)):t(e.input).val(n.Date.toString(u,n.Date.STANDART_FORMAT_SHOT));i.hide()};t(this.element).find("button[name='_calendar_prev_year_']").bind("click",function(){i.get().gotoYear(-1)}),t(this.element).find("button[name='_calendar_prev_month_']").bind("click",function(){i.get().gotoMonth(-1)}),this.inputYear=t(this.element).find("input[name='_calendar_year_']").bind("keyup",function(e){i.get().refresh(),e.keyCode==13&&s()}).bind("change",function(e){i.get().refresh()}).get(0),this.inputMonth=t(this.element).find("input[name='_calendar_month_']").bind("change",function(e){i.get().refresh()}).bind("keyup",function(e){i.get().refresh(),e.keyCode==13&&s()}).get(0),t(this.element).find("button[name='_calendar_next_year_']").bind("click",function(){i.get().gotoYear(1)}),t(this.element).find("button[name='_calendar_next_month_']").bind("click",function(){i.get().gotoMonth(1)});var o=function(e){var r=t(e.target).text(),s=i.get();if(r!==""){s.day=r;if(s.type!=i.ONLY_DATE)s.refresh();else{var o=s.inputYear.value,u=s.inputMonth.value-1,a=s.day,f=new Date;f.setDate(1),f.setYear(o),f.setMonth(u),f.setDate(a),s.input.focus&&s.input.focus();if(s.isTimestamp){f.setSeconds(s.inputSec.value),f.setMinutes(s.inputMin.value),f.setHours(s.inputHour.value);var l=s.isTime?n.Date.toString(f,n.Date.STANDART_TIME_FORMAT):n.Date.toString(f,n.Date.STANDART_FORMAT);"function"==typeof s.input.val?(s.input.val(l),t(s.input.domNode).change()):t(s.input).val(l).change()}else"function"==typeof s.input.val?(s.input.val(n.Date.toString(f,n.Date.STANDART_FORMAT_SHOT)),t(s.input.domNode).change()):t(s.input).val(n.Date.toString(f,n.Date.STANDART_FORMAT_SHOT)).change();s.input.blur&&s.input.blur(),i.hide()}}};t(this.element).find(".day").each(function(){t(this).bind("click",o)}),this.inputHour=t(this.element).find("input[name='_calendar_hour_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),this.inputMin=t(this.element).find("input[name='_calendar_min_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),this.inputSec=t(this.element).find("input[name='_calendar_sec_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),t(this.element).find("button[name='_calendar_ok_']").bind("click",function(){s()}),t(this.element).find("button[name='_calendar_cancel_']").bind("click",function(){i.hide()}),t(this.element).find("button[name='_calendar_clear_']").bind("click",function(){var e=i.get();"function"==typeof e.input.val?e.input.val(""):t(e.input).val(""),i.hide()});var u=n.Browser.hasTouch?"x-desktop-datePicker-list x-touch-datePicker-list":"x-desktop-datePicker-list";this.monthList=new r(t(this.inputYear).parent().get(0),u,this.inputMonth,1,12,1,12),this.yearList=new r(t(this.inputYear).parent().get(0),u,this.inputYear,1900,2099,1,n.Browser.hasTouch?200:null),this.hourList=new r(t(this.inputYear).parent().get(0),u,this.inputHour,0,23,2,n.Browser.hasTouch?24:null),this.minList=new r(t(this.inputYear).parent().get(0),u,this.inputMin,0,59,2,n.Browser.hasTouch?60:null),this.secList=new r(t(this.inputYear).parent().get(0),u,this.inputSec,0,59,2,n.Browser.hasTouch?60:null),this.hide()},today:function(){this.refreshControls(new Date)},refreshControls:function(e){this.day=e.getDate(),this.inputMonth.value=e.getMonth()+1,this.inputYear.value=e.getYear()<1e3?1900+e.getYear():e.getYear(),this.isTimestamp&&(this.inputHour.value=n.String.zeros(e.getHours(),2),this.inputMin.value=this.type>=i.MINUTES?n.String.zeros(e.getMinutes(),2):"00",this.inputSec.value=this.type>=i.SECONDS?n.String.zeros(e.getSeconds(),2):"00"),this.refresh()},hide:function(){this.monthList.hide(),this.yearList.hide(),this.hourList.hide(),this.minList.hide(),this.secList.hide(),t(this.element).hide(),t(this.modalCover).hide()},getFirstDay:function(){var e=this.inputYear.value,t=this.inputMonth.value-1;e<1900&&(e=1900),e>2099&&(e=2099),t<0&&(t=0),t>11&&(t=11);var n=new Date;return n.setDate(1),n.setMonth(t),n.setYear(e),n.getDay()},getDaysOfMonth:function(){var e=this.inputYear.value,t=this.inputMonth.value-1;return e<1900&&(e=1900),e>2099&&(e=2099),t<0&&(t=0),t>11&&(t=11),t!=1||0!==e%4||0===e%100&&0!==e%400?i.daysOfMoth[t]:29},refresh:function(){var e=new Date;this.currentDay=e.getDate(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear();var n=this.getFirstDay(),i=this.getDaysOfMonth(),s=0,o=1,u=this.inputMonth.value-1==this.currentMonth&&this.inputYear.value==this.currentYear,a=this;t(this.element).children("tbody").children().each(function(){var e=this,f=!1;for(var l=0;l<7;l++,s++){var c=t(e.childNodes[l]);c.removeClass("hover"),u&&o==a.currentDay?c.addClass("today"):c.removeClass("today"),l===6||l===0?c.addClass("weekend"):c.removeClass("weekend");var h="";s>=n&&s<n+i?(f=!0,h=o++,r.initHover(c.get(0))):c.unbind("mouseout mouseover"),c.text(h+""),h==a.day&&!isNaN(parseInt(h))?c.addClass("selected"):c.removeClass("selected")}e.style.display=f?"":"none"})},gotoYear:function(e){var t=parseInt(this.inputYear.value)+e;t<1900&&(t=1900),t>2099&&(t=2099),this.inputYear.value=t,this.refresh()},gotoMonth:function(e){var t=parseInt(this.inputMonth.value)+e;if(t<1||t>12){var n=parseInt(this.inputYear.value)+e;n>=1900?(t=e<0?12:1,this.inputYear.value=n):t=e<0?1:12}this.inputMonth.value=t,this.refresh()}});return i.HTML=function(){return'<table name="_calendar_" class="x-desktop-datePicker '+(n.Browser.hasTouch?"x-datePicker-touch":"")+'" cellpadding="0" cellspacing="0">'+'<thead><tr valign="middle"><td class="title" colspan="7" align="center"><button name="_calendar_prev_year_" class="prev-year"/><button name="_calendar_prev_month_" class="prev-month"/><input name="_calendar_year_" class=" x-desktop-datePicker-input x-desktop-datePicker-year" maxlength="4" /><input class=" x-desktop-datePicker-input x-desktop-datePicker-" readonly="" value="-" /><input name="_calendar_month_" class=" x-desktop-datePicker-input x-desktop-datePicker-month" maxlength="2" /><button name="_calendar_next_month_" class="next-month"/><button name="_calendar_next_year_" class="next-year"/></td></tr><tr class="names"><td class="name">'+(new n.Message(n.Message.JUSTEP231509)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231510)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231511)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231512)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231513)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231514)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231515)).getMessage()+"</td></tr></thead>"+'<tbody><tr><td class="day weekend"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day weekend">1</td></tr><tr><td class="day weekend">2</td><td class="day">3</td><td class="day">4</td><td class="day">5</td><td class="day">6</td><td class="day">7</td><td class="day weekend">8</td></tr><tr><td class="day weekend">9</td><td class="day">10</td><td class="day selected">11</td><td class="day">12</td><td class="day">13</td><td class="day">14</td><td class="day weekend">15</td></tr><tr><td class="day weekend">16</td><td class="day">17</td><td class="day today">18</td><td class="day">19</td><td class="day">20</td><td class="day">21</td><td class="day weekend">22</td></tr><tr><td class="day weekend">23</td><td class="day">24</td><td class="day">25</td><td class="day">26</td><td class="day">27</td><td class="day">28</td><td class="day weekend">29</td></tr><tr><td class="day weekend   ">30</td><td class="day">31</td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day weekend"></td></tr></tbody>'+'<tfoot><tr><td colspan="7"><input name="_calendar_hour_" maxlength="2" class=" x-desktop-datePicker-input"/>:<input name="_calendar_min_" class=" x-desktop-datePicker-input" maxlength="2"/>:<input name="_calendar_sec_" class=" x-desktop-datePicker-input" maxlength="2"/></td></tr><tr><td colspan="7"><button name="_calendar_ok_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231500)).getMessage()+'</button><button name="_calendar_cancel_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231501)).getMessage()+'</button><button name="_calendar_clear_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231508)).getMessage()+"</button></td></tr></tfoot>"+"</table>"},i.get=function(){return i.instance||(i.instance=new i),i.instance},i.daysOfMoth=[31,28,31,30,31,30,31,31,30,31,30,31],i.ONLY_DATE=0,i.HOURS=1,i.MINUTES=2,i.SECONDS=3,i.TIME=4,i.show=function(e,r,s){var o=i.get();r||(r=i.ONLY_DATE),s=!!s,o.yearList.element.onclick=o.monthList.element.onclick=o.hourList.element.onclick=o.minList.element.onclick=o.secList.element.onclick=o.element.onclick=function(e){(e||event).cancelBubble=s},o.input=e,o.type=r,o.isTime=r==i.TIME,o.isTimestamp=r!=i.ONLY_DATE,o.isTimestamp?t(o.element).find("tfoot tr:first-child").show():t(o.element).find("tfoot tr:first-child").hide();var u;try{var a="function"==typeof e.val?e.val():t(e).val();u=o.isTimestamp?n.Date.fromString(a,"yyyy-MM-ddThh:mm:ss"):n.Date.fromString(a,n.Date.STANDART_FORMAT_SHOT)}catch(f){u=new Date}u?o.refreshControls(u):o.today();var l=t(e.domNode?e.domNode:e),f=t(o.element);f.css({top:-3e3,left:-3e3}).show();var c=l.offset(),h=c.top-f.outerHeight(!0),p=t(document).height()<c.top+l.outerHeight(!0)+f.outerHeight(!0)&&h>0,d=p?h:c.top+l.outerHeight(!0);d<0&&(d=0);var v=l.offset().left;v<0&&(v=0);var m=t(document).width(),g=f.outerHeight(!0);m<v+g&&(v-=v+g-m),v<0&&(v=0),f.css({top:d,left:v})},i.hide=function(){i.get().hide()},i}),define("$model/UI2/system/components/justep/labelEdit/labelEdit.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/labelEdit/labelEdit",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./labelEdit.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./labelEdit"),r=e("./labelEdit.config"),i=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-label-edit"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" ></div>"}});return t.Component.register(n,i),i}),function(){function e(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function t(e,t){return e.x*t.x+e.y*t.y}function n(n,r){var i=e(n)*e(r);if(i===0)return 0;var s=t(n,r)/i;return s>1&&(s=1),Math.acos(s)}function r(e,t){return e.x*t.y-t.x*e.y}function i(e,t){var i=n(e,t);return r(e,t)>0&&(i*=-1),i*180/Math.PI}function o(e,t){var n=new s(e);return n.add(t),n}var s=function(e){this.handlers=[],this.el=e};s.prototype.add=function(e){this.handlers.push(e)},s.prototype.del=function(e){e||(this.handlers=[]);for(var t=this.handlers.length;t>=0;t--)this.handlers[t]===e&&this.handlers.splice(t,1)},s.prototype.dispatch=function(){for(var e=0,t=this.handlers.length;e<t;e++){var n=this.handlers[e];typeof n=="function"&&n.apply(this.el,arguments)}};var u=function(e,t){this.element=typeof e=="string"?document.querySelector(e):e,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this),this.element.addEventListener("touchstart",this.start,!1),this.element.addEventListener("touchmove",this.move,!1),this.element.addEventListener("touchend",this.end,!1),this.element.addEventListener("touchcancel",this.cancel,!1),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;var n=function(){};this.rotate=o(this.element,t.rotate||n),this.touchStart=o(this.element,t.touchStart||n),this.multipointStart=o(this.element,t.multipointStart||n),this.multipointEnd=o(this.element,t.multipointEnd||n),this.pinch=o(this.element,t.pinch||n),this.swipe=o(this.element,t.swipe||n),this.tap=o(this.element,t.tap||n),this.doubleTap=o(this.element,t.doubleTap||n),this.longTap=o(this.element,t.longTap||n),this.singleTap=o(this.element,t.singleTap||n),this.pressMove=o(this.element,t.pressMove||n),this.twoFingerPressMove=o(this.element,t.twoFingerPressMove||n),this.touchMove=o(this.element,t.touchMove||n),this.touchEnd=o(this.element,t.touchEnd||n),this.touchCancel=o(this.element,t.touchCancel||n),this._cancelAllHandler=this.cancelAll.bind(this),window.removeEventListener("scroll",this._cancelAllHandler),window.addEventListener("scroll",this._cancelAllHandler),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}};u.prototype={start:function(t){if(!t.touches)return;this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(t),this.preTapPosition.x!==null&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var n=this.preV,r=t.touches.length;if(r>1){this._cancelLongTap(),this._cancelSingleTap();var i={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};n.x=i.x,n.y=i.y,this.pinchStartLen=e(n),this.multipointStart.dispatch(t)}this._preventTap=!1,this.longTapTimeout=setTimeout(function(){this.longTap.dispatch(t),this._preventTap=!0}.bind(this),750)},move:function(t){if(!t.touches)return;var n=this.preV,r=t.touches.length,s=t.touches[0].pageX,o=t.touches[0].pageY;this.isDoubleTap=!1;if(r>1){var u=t.touches[1].pageX,a=t.touches[1].pageY,f={x:t.touches[1].pageX-s,y:t.touches[1].pageY-o};n.x!==null&&(this.pinchStartLen>0&&(t.zoom=e(f)/this.pinchStartLen,this.pinch.dispatch(t)),t.angle=i(f,n),this.rotate.dispatch(t)),n.x=f.x,n.y=f.y,this.x2!==null&&this.sx2!==null?(t.deltaX=(s-this.x2+u-this.sx2)/2,t.deltaY=(o-this.y2+a-this.sy2)/2):(t.deltaX=0,t.deltaY=0),this.twoFingerPressMove.dispatch(t),this.sx2=u,this.sy2=a}else this.x2!==null?(t.deltaX=s-this.x2,t.deltaY=o-this.y2):(t.deltaX=0,t.deltaY=0),this.pressMove.dispatch(t);this.touchMove.dispatch(t),this._cancelLongTap(),this.x2=s,this.y2=o,r>1&&t.preventDefault()},end:function(e){if(!e.changedTouches)return;this._cancelLongTap();var t=this;e.touches.length<2&&this.multipointEnd.dispatch(e),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(e.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout(function(){t.swipe.dispatch(e)},0)):(this.tapTimeout=setTimeout(function(){t._preventTap||t.tap.dispatch(e),t.isDoubleTap&&(t.doubleTap.dispatch(e),clearTimeout(t.singleTapTimeout),t.isDoubleTap=!1)},0),t.isDoubleTap||(t.singleTapTimeout=setTimeout(function(){t.singleTap.dispatch(e)},250))),this.touchEnd.dispatch(e),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null},cancelAll:function(){this._preventTap=!0,clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout)},cancel:function(e){this.cancelAll(),this.touchCancel.dispatch(e)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_cancelSingleTap:function(){clearTimeout(this.singleTapTimeout)},_swipeDirection:function(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"Left":"Right":n-r>0?"Up":"Down"},on:function(e,t){this[e]&&this[e].add(t)},off:function(e,t){this[e]&&this[e].del(t)},destroy:function(){return this.singleTapTimeout&&clearTimeout(this.singleTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.twoFingerPressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=this.twoFingerPressMove=null,null}},typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("$model/UI2/system/components/justep/list/js/alloy_finger",[],function(){return u}):typeof module!="undefined"&&typeof exports=="object"?module.exports=u:window.AlloyFinger=u}(),define("$model/UI2/system/components/justep/list/list.config",["require"],function(e){return{properties:{limit:"number",filter:"string",data:"string",autoLoad:"boolean",disablePullToRefresh:"boolean",disableInfiniteLoad:"boolean",rownum:"number"},events:["onAfterRender","onLongTap"],binds:{}}}),define("$model/UI2/system/components/justep/list/list",["require","css!./css/list","jquery","$UI/system/lib/justep","../data/data","./js/alloy_finger","./list.config"],function(require){require("css!./css/list").load();var $=require("jquery"),justep=require("$UI/system/lib/justep"),Express=justep.Express,Bind=justep.Bind,Data=require("../data/data"),AlloyFinger=require("./js/alloy_finger"),url=require.normalizeName("./list"),ComponentConfig=require("./list.config"),List=justep.BindComponent.extend({getConfig:function(){return ComponentConfig},constructor:function(e){this.filter="",this.pageIndex=Bind.observable(-1),this.limit=-1,this.data="",this.hasMore=!1,this.autoLoad=!0,this._canLoadData=!1,this.disablePullToRefresh=!1,this.disableInfiniteLoad=!1,this.callParent(e),this.rownum=-1},dispose:function(){var e=this.getModel();this.alloyFinger&&(this.alloyFinger=this.alloyFinger.destroy()),this._pullUpHandle&&e.off("onPullUp",this._pullUpHandle),this._pullDownHandle&&e.off("onPullDown",this._pullDownHandle),this.callParent()},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="x-list");var t=e.xid||justep.UUID.createUUID(),n=$("<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(t?" xid='"+t+"' ":"")+" component='"+url+"' "+" >"+"</div>");e.template&&n.append(e.template);var r=n.hasClass("x-list-template")?n:n.find(".x-list-template:first");if(e.data){var i="$model.foreach_"+t+"($element)",s="$model.foreach_afterRender_"+t+".bind($model,$element)";r.addClass("hide").attr("bind-foreach","{data:"+i+",afterRender:"+s+"}")}return n},getData:function(){return this.getDataByExpr(this.data)},doInit:function(e,t){this._bindEvent(),this._createForeachData();if(this.autoLoad){var n=this.getModel();justep.ModelBase.MODEL_STATUS_CONSTRUCT_DONE>n.getStatus()?n.on(justep.ModelBase.MODEL_CONSTRUCT_DONE_EVENT,this.refresh.bind(this,!1)):justep.Bind.utils.domNodeReady.addReadyCallback(this.domNode,this.refresh.bind(this,!1))}},_bindEvent:function(){var e=this;justep.Browser.hasTouch&&(this.alloyFinger=new AlloyFinger(this.domNode,{longTap:function(t){e.fireEvent("onLongTap",{source:this,originalEvent:t})}}));var t=this.getModel();this._pullDownHandle=function(e){!this.disablePullToRefresh&&this._isSelfRefresh(e.source)&&(this.hasListener("onPullToRefresh")&&this.fireEvent("onPullToRefresh",{source:this}),this._refreshDtd=$.Deferred(),e.dtd=this._refreshDtd.promise(),this.refresh(!0))},t.on("onPullDown",this._pullDownHandle,this),this._pullUpHandle=function(e){if(!this.disableInfiniteLoad&&this._isSelfRefresh(e.source)){this._refreshDtd=$.Deferred(),e.dtd=this._refreshDtd.promise(),this.loadNextPage();if(this.hasListener("onInfiniteLoad")){var t={source:this,hasMore:this.hasMore};this.fireEvent("onInfiniteLoad",t),this.hasMore=t.hasMore}e.noMoreLoad=!this.hasMore}},t.on("onPullUp",this._pullUpHandle,this);var n=this._getForeachNode();"function"==typeof window.addEventListener?n.each(function(){this.addEventListener("click",function(t){e._doRowClick(t)},!0)}):n("click",{comp:this},function(e){return e.data.comp._doRowClick(e),!0})},_isSelfRefresh:function(e){return this._getForeachNode().parents(".x-scroll")[0]==e.domNode},_doRowClick:function(e){var t=e.target||e.srcElement,n=$(t);for(;n.length>0&&!n.hasClass("x-list-template");n=n.parent())t=n[0];var r=Bind.contextFor(t);if(r){var i=r.$object;i instanceof Data.Row&&i.data.to(i)}},_createForeachData:function(){var e=this.getModel(),t=this;"function"!=typeof e["foreach_"+this.$domNode.attr("xid")]&&(e["foreach_"+this.$domNode.attr("xid")]=function(e){var n=justep.Component.getComponent(e);if(!n||!(n instanceof List))n=justep.Component.getComponent($(e).parents("[component='"+t.componentName+"']:first")[0]);return n._computedForeach()}),"function"!=typeof e["foreach_afterRender_"+this.$domNode.attr("xid")]&&(e["foreach_afterRender_"+this.$domNode.attr("xid")]=function(e,n,r){var i=justep.Component.getComponent(e);if(!i||!(i instanceof List))i=justep.Component.getComponent($(e).parents("[component='"+t.componentName+"']:first")[0]);return i._afterRenderForeach(e,n,r)})},_rowNumRender:function(){if(this.rownum>0){this.$domNode.addClass("x-list-in-one-line x-scroll-h");var e=this._getForeachNode().children("li").length;if(e>0){e=Math.ceil(e/this.rownum);var t=$(this._getForeachNode().children("li")[0]).css("width");t=parseInt(t),t>0&&this._getForeachNode().css("width",String(e*t)+"px")}}else this.$domNode.removeClass("x-list-in-one-line x-scroll-h")},_afterRenderForeach:function(e,t,n){this._refreshDtd&&"pending"==this._refreshDtd.state()&&this._refreshDtd.resolve(),this._getForeachNode().trigger("afterRenderList"),this._rowNumRender(),this.fireEvent("onAfterRender",{bindingContext:Bind.contextFor(e),elements:t,$object:n,source:this})},_computedForeach:function(){if(!this.__computed){this.__computed=!0;try{return this.bindingObjects=this.getForeachData(),$.isArray(this.bindingObjects)&&this.bindingObjects.length===0&&this._refreshDtd&&"pending"==this._refreshDtd.state()&&this._refreshDtd.resolve(),this.bindingObjects}finally{this.__computed=!1}}},_getForeachNode:function(){return this.$domNode.hasClass("x-list-template")?this.$domNode:this.$domNode.find(".x-list-template:first")},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n)},getBindingObjects:function(){return this.bindingObjects?this.bindingObjects:[]},getForeachData:function(){if(this.pageIndex.get()==-1)return[];if(this.data){var data=this.getData();data||alert("list没有绑定数据！");var ctx,ret,i,j,b;if(data instanceof Data){var datas=data.datas.get(),list_limit=-1==this.limit?data.limit:this.limit,size=datas.length,offset=-1==this.limit?size:list_limit*this.pageIndex.get(),total=data.getTotal();this.hasMore=offset<size||size>0&&total>0&&offset-(-1==this.limit?0:list_limit)<total;if(data.limit!=list_limit||this.filter){this.filter&&"string"==typeof this.filter&&(this.filter=new Express(this.filter)),ret=[],ctx=Bind.contextFor(this.domNode);for(i=0,j=0;i<offset&&j<size;j++)b=!0,this.filter instanceof Express&&(ctx.$row=datas[j],b=Express.eval(this.filter,ctx.$object,ctx)),b&&(ret.push(datas[j]),i++);return delete ctx.$row,i<offset&&size<total&&this._canLoadData&&data.loaded&&data.loadNextPageData({append:!0,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,datas,size)}),ret}return offset<=size?datas:data.loaded&&size<total&&this._canLoadData?(data.loadNextPageData({append:!0,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,datas,size)}),datas):datas}ctx=Bind.contextFor(this.domNode);var dataExpr;with(this.getModel())with(ctx)dataExpr=eval("("+this.data+")");var temps;"function"==typeof dataExpr?temps=dataExpr.call(ctx.$model):temps=dataExpr;if(Bind.isObservable(temps)||Bind.isComputed(temps))temps=temps.get();if(-1!==this.limit&&$.isArray(temps)){this.filter&&"string"==typeof this.filter&&(this.filter=new Express(this.filter)),ret=[],ctx=Bind.contextFor(this.domNode);var len=temps.length,listOffset=this.limit*this.pageIndex.get();this.hasMore=len>listOffset;for(i=0,j=0;i<listOffset&&j<len;j++)b=!0,this.filter instanceof Express&&(ctx.$row=temps[j],b=Express.eval(this.filter,ctx.$object,ctx)),b&&(ret.push(temps[j]),i++);return delete ctx.$row,ret}return temps}return[]},loadNextPage:function(){if(this.hasMore)if(-1==this.limit)this.getData().loadNextPageData({append:!0});else{var e=this.pageIndex.get();this._canLoadData=!0;try{this.pageIndex.set(e+1)}finally{this._canLoadData=!1}}},refresh:function(e){if(this.data){this.pageIndex.set(-1);var t=this.getData(),n=function(){this._canLoadData=!0;try{this.pageIndex.set(1)}finally{this._canLoadData=!1}t instanceof Data&&t.first()}.bind(this);t instanceof Data&&(e||!t.autoLoad&&!t.isLoaded())?t.refreshData({async:!0,onSuccess:n}):n()}this._getForeachNode().removeClass("hide")}});return justep.Component.addOperations(List,{refresh:{label:"",argsDef:[{name:"refreshData",displayName:"刷新数据集"}],method:function(e){var t=!1;return e&&e.refreshData&&e.refreshData=="true"&&(t=!0),this.owner.refresh(t)}}}),justep.Component.register(url,List),List}),define("$model/UI2/system/components/justep/tree/tree.config",["require"],function(e){return{properties:{limit:"number",filter:"string",data:"string",labelColumn:"string",rootLabel:"string",autoLoad:"boolean",disablePullToRefresh:"boolean",disableInfiniteLoad:"boolean"},events:["onAfterRender","onBeforeLoadChildren","onCustomLoadChildren"],binds:{}}}),define("$model/UI2/system/components/justep/tree/tree",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","../list/list","../data/data","./tree.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=t.Component,r=t.Bind,i=t.Express,s=e("../list/list"),o=e("../data/data"),u=e.normalizeName("./tree"),a=e("./tree.config"),f=s.extend({getConfig:function(){return a},constructor:function(e){this.labelColumn=null,this.rootLabel=t.Message.getMessage(t.Message.JUSTEP231085),this.contexts={},this.context=r.observable({pageIndex:-1,row:null,datas:null}),this.callParent(e)},dispose:function(){var e=this.getData(),t=this.getBar();e&&e.off("onAfterRefresh",this._doDataRefresh),t&&t.off("onClick",this._doBarClick),this.callParent()},clsContexts:function(){this.contexts={};var e=this.context.get();e.pageIndex=-1,e.row=null,e.datas=null},clear:function(){this.clsContexts(),this.getBar().clear();var e=this.getBar();e.push({label:this.rootLabel})},updateContext:function(e){var t=this.getData(),n=this.contexts[e?t.getRowID(e):undefined];n?this.context.set(n):(n={pageIndex:1,row:e,datas:e?e.rows:this.getData().datas},this.context.set(n));var r=this.getScroll();r&&r.refresh()},saveContext:function(){var e=this.context.get(),t=this.getData();this.contexts[e?t.getRowID(e.row):null]=e},doInit:function(e,t){this.callParent(e,t)},_getForeachNode:function(){return this.$domNode.find(".x-tree-template:first")},_bindEvent:function(){var e=this.getData();e.on("onAfterRefresh",this._doDataRefresh,this),e.on("onDataChange",this._doDataClear,this);var t=this;this.getModel().componentPromise(this.$domNode.find(".x-tree-head .breadcrumb")[0]).done(function(e){e.on("onClick",t._doBarClick,t),e.push({label:t.rootLabel})}),this._getForeachNode().on("click",".x-tree-link",{comp:this},function(e){return e.data.comp._doRowLinkClick(e)}).on("click",{comp:this},function(e){return e.data.comp._doRowClick(e),!0}),this.callParent()},_doRowLinkClick:function(e){this.saveContext();var t=r.contextFor(e.target||e.srcElement),n=t.$object,i=this.getData(),s={source:this,bindingContext:t,row:n,data:i,forcedTo:!1,cancel:!1},o=!0;this.fireEvent("onBeforeLoadChildren",s);if(!s.cancel&&!i.isLeaf(n)){var u=!1,a=function(e,t,n){t&&(t.rows&&t.rows.get().length>0||n)&&(t.rows&&t.rows.get().length>0&&e.to(t.rows.get()[0]),this.updateContext(t),this.getBar().push({label:t.val(this.labelColumn),row:t}),o=!1)}.bind(this,i,n,s.forcedTo);i.isLoaded(n)?a():this.hasListener("onCustomLoadChildren")?(s={source:this,bindingContext:t,row:n,data:i,async:u,asyncCallBack:a},this.fireEvent("onCustomLoadChildren",s),s.async||a()):i.loadNextPageData({append:!1,parent:n,onSuccess:a})}return o},_doBarClick:function(e){this.saveContext();var t=e.source.popTo(e.data);t&&t.length>0&&this.getData().to(t[t.length-1].row),this.updateContext(e.data.row)},_doDataClear:function(e){e.selfChanged&&e.type=="clear"&&!e.parent&&this.clear()},_doDataRefresh:function(e){e.options.parent||this.refresh()},getBar:function(){return n.getComponent(this.$domNode.find(".x-tree-head .breadcrumb")[0])},getScroll:function(){return n.getComponent(this.$domNode.find(".x-scroll:first")[0])},getForeachData:function(){var e=this.context.get();if(e.pageIndex==-1)return[];if(e.datas){var t=this.getData();if(t instanceof o){var n=e.datas.get(),s=-1==this.limit?t.limit:this.limit,u=n.length,a=-1==this.limit?u:s*e.pageIndex,f=t.getTotal(e.row);this.hasMore=a<u||u>0&&f>0&&a-(-1==this.limit?0:s)<f;if(t.limit!=s||this.filter){this.filter&&"string"==typeof this.filter&&(this.filter=new i(this.filter));var l=[],c=r.contextFor(this.domNode);for(var h=0,p=0;h<a&&p<u;p++){var d=!0;this.filter instanceof i&&(c.$row=n[p],d=i.eval(this.filter,c.$object,c)),d&&(l.push(n[p]),h++)}return delete c.$row,h<a&&u<f&&this._canLoadData&&t.loaded&&t.loadNextPageData({append:!0,parent:e.row,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,n,u)}),l}return a<=u?n:t.loaded&&u<f&&this._canLoadData?(t.loadNextPageData({append:!0,parent:e.row,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,n,u)}),n):n}}return[]},propertyChangedHandler:function(e,t,n){"rootLabel"==e&&(this._inited?this.getBar().setLabel(0,n):this.callParent(e,t,n))},loadNextPage:function(){if(this.hasMore){var e=this.context.get();if(-1==this.limit)this.getData().loadNextPageData({append:!0,parent:e.row});else{this._canLoadData=!0;try{e.pageIndex++,this.context.set(e)}finally{this._canLoadData=!1}}}},refresh:function(e){if(this.data){var t=this.context.get(),n=this.getData(),r=t.row;(e&&n instanceof o||!n.autoLoad&&!n.isLoaded())&&n.refreshData({parent:r}),this._canLoadData=!0;try{t={pageIndex:1,row:r,datas:r?r.rows:this.getData().datas},this.context.set(t)}finally{this._canLoadData=!1}n.first()}this._getForeachNode().removeClass("hide")}});return n.register(u,f),f}),define("$model/UI2/system/components/justep/messageDialog/messageDialog.config",["require"],function(e){return{properties:{type:"string",title:"string",message:"string",inputValue:"string",width:"string",height:"string"},events:["onClose","onOK","onCancel","onYes","onNo"],binds:{}}}),define("$model/UI2/system/components/justep/messageDialog/messageDialog",["require","$UI/system/components/justep/common/res","css!./css/messageDialog","jquery","$UI/system/lib/justep","./messageDialog.config","$UI/system/lib/base/layerManager"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/messageDialog").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("./messageDialog.config"),i=e.normalizeName("./messageDialog"),s=e("$UI/system/lib/base/layerManager"),o=(new n.Message(n.Message.JUSTEP231079)).getMessage(),u=(new n.Message(n.Message.JUSTEP231080)).getMessage(),a=(new n.Message(n.Message.JUSTEP231081)).getMessage(),f=(new n.Message(n.Message.JUSTEP231082)).getMessage(),l=null;return l=n.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e),this.type=l.type.OK,this.title="",this.message="",this.inputValue=null,this.width="",this.height=""},dispose:function(){this.callParent()},doInit:function(e,t){this._getButtonsNode().on("click",this._doClick.bind(this)),this._getInputNode().on("change",this._doInputChange.bind(this))},buildTemplate:function(e){return e||(e={}),e.type||(e.type=l.type.OK),this.set(e),'<span component="'+i+'" type="'+e.type+'">'+'<div class="x-modal-overlay"></div>'+'<div class="x-modal">'+'<div class="x-modal-inner">'+'<div class="x-modal-title">'+e.title+"</div>"+'<div class="x-modal-text">'+e.message+"</div>"+'<input type="text" class="x-modal-prompt-input" value="'+(e.inputValue||"")+'"></div>'+'<div class="x-modal-buttons">'+'<a class="x-modal-button x-modal-button-bold OK" value="ok">'+o+"</a>"+'<a class="x-modal-button x-modal-button-bold Yes" value="yes">'+a+"</a>"+'<a class="x-modal-button x-modal-button-bold No" value="no">'+f+"</a>"+'<a class="x-modal-button x-modal-button-bold Cancel" value="cancel">'+u+"</a>"+"</div>"+"</div>"+"</span>"},propertyChangedHandler:function(e,t,n){switch(e){case"title":t!=n&&this.$domNode&&this._getTitleNode().text(n);break;case"message":if(t!=n&&this.$domNode){var r=n?(""+n).replace(/\n/g,"<br/>"):"";this._getTextNode().html(r)}break;case"inputValue":if(t!=n&&this.$domNode){var i=n!==null&&n!==undefined?n:"";this._getInputNode().val(i)}break;default:this.callParent(e,t,n)}},_getDialogNode:function(){return this.$domNode.find("div.x-modal")},_getOverlayNode:function(){return this.$domNode.find("div.x-modal-overlay")},_getTitleNode:function(){return this.$domNode.find("div.x-modal-title")},_getTextNode:function(){return this.$domNode.find("div.x-modal-text")},_getButtonsNode:function(){return this.$domNode.find("div.x-modal-buttons")},_getInputNode:function(){return this.$domNode.find("input.x-modal-prompt-input")},_doInputChange:function(){this.inputValue=this._getInputNode().val()},_doClick:function(e){this._getDialogNode().removeClass("x-modal-in").hide(),this._getOverlayNode().removeClass("x-modal-overlay-visible"),n.Util.enableTouchMove(document.body);var r={source:this,button:t(e.target).attr("value")};l.type.Prompt==this.type&&r.button=="ok"&&(r.input=this._getInputNode().val()),this.fireEvent("onClose",r),s.removeLayerIndex(this._getDialogNode()),"function"==typeof this.callback&&this.callback(r);switch(r.button){case"ok":this.fireEvent("onOK",r);break;case"cancel":this.fireEvent("onCancel",r);break;case"yes":this.fireEvent("onYes",r);break;case"no":this.fireEvent("onNo",r)}},show:function(e){e=e||{},this.callback=null,"function"==typeof e.callback&&(this.callback=e.callback),this.set(e);var t=this._getDialogNode();this.height!==""&&t.height(this.height);var r={marginTop:-t.outerHeight()/2+"px"};this.width!==""&&(t.width(this.width),r.marginLeft=-t.outerWidth()/2+"px"),t.css(r),n.Util.disableTouchMove(document.body),this._getOverlayNode().addClass("x-modal-overlay-visible"),t.show().addClass("x-modal-in"),s.setLayerIndex(t)}}),l.type={OK:"OK",OKCancel:"OKCancel",YesNo:"YesNo",YesNoCancel:"YesNoCancel",Prompt:"Prompt"},l.result={ok:"ok",cancel:"cancel",yes:"yes",no:"no"},n.Component.addOperations(l,{show:{label:"",method:function(e){return this.owner.show(e.option)}}}),n.Component.register(i,l),l}),define("$model/UI2/system/components/justep/dataOperation/dataOperation.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/windowDialog/js/receiveMapping",["require"],function(e){var t=function(e,t){if(t)e.clear();else{var n=e.confirmDelete;try{e.confirmDelete=!1,e.deleteAllData()}finally{e.confirmDelete=n}}},n=function(e,t,n,r){$.isArray(t)&&t.length>0&&e.newData({defaultValues:t,disableRecordChange:n,index:r})},r=function(e,t,n,r,s){var o=t.from,u=t.to;if(!o||o===""||!u||u==="")return;var a=i(n[r],o);"function"==typeof e.setValue?e.setValue(u,a,s):e[u]=a},i=function(e,t){if(!e)return;return"function"==typeof e.val?e.val(t):e[t]},s=function(e,t,n){var r=[],s=e.locfrom;for(var o=0,u=s.length;o<u;o++)r.push(i(n[t],s[o]));return r},o=function(e){var t=e.__mapping_def__;if(!t){var n=e.$domNode;t={mappings:[],locfrom:[],locto:[]},t.dataID=n.find("result").attr("concept"),t.operation=n.find("result").attr("operation"),n.find("mapping").each(function(){var e=$(this),n=e.attr("locator")==="true";n&&(t.locfrom.push(e.attr("from")),t.locto.push(e.attr("to")));var r={};r.from=e.attr("from"),r.to=e.attr("to"),t.mappings.push(r)}),e.__mapping_def__=t}return t},u={receiveByMapping:function(e,i,u){if(!e||!i)return;var a=u&&u.insPos;$.isArray(i)||(i=[i]);var f=o(e),l=e.getModel(),c,h,p,d=f.mappings;if(!f.dataID||f.dataID===""||!f.operation||f.operation==="")return;var v=l.comp(f.dataID);if(!v)return;var m=[];f.disableRecordChange&&v.disableRecordChange();try{if(f.operation==="new"){for(c=0;c<i.length;c++){p={};for(h=0;h<d.length;h++)r(p,d[h],i,c);m.push(p)}n(v,m,f.disableRecordChange,a)}else if(f.operation=="edit"){for(c=0;c<i.length;c++){var g=v.find(f.locto,s(f,c,i),!1,!1,!1);if(g&&g.length>0)for(var y=0;y<g.length;y++)for(h=0;h<d.length;h++)r(v,d[h],i,c,g[y]);else{p={};for(h=0;h<d.length;h++)r(p,d[h],i,c);m.push(p)}}n(v,m,f.disableRecordChange,a)}else if(f.operation=="clear"){t(v,f.disableRecordChange);for(c=0;c<i.length;c++){p={};for(h=0;h<d.length;h++)r(p,d[h],i,c);m.push(p)}n(v,m,f.disableRecordChange,a)}else{if(f.operation!="modify")return;for(c=0;c<i.length;c++)for(h=0;h<d.length;h++)r(v,d[h],i,c)}}finally{v.enabledRecordChange()}}};return u}),define("$model/UI2/system/components/justep/windowDialog/windowDialog.config",["require"],function(e){return{properties:{src:"string",process:"string",activity:"string",showTitle:"boolean",forceRefreshOnOpen:"boolean",title:"string",status:"string",width:"string",height:"string",top:"string",left:"string",routable:"boolean",resizable:"boolean"},events:["onLoad","onSend","onOpen","onClose","onReceive","onLoadError","onReceived"],binds:{}}}),define("$model/UI2/system/components/justep/windowDialog/windowDialog",["require","$UI/system/resources/system.res","jquery","$UI/system/lib/justep","../dialog/dialog","../windowContainer/windowContainer","$UI/system/lib/route/routeUtil","./js/receiveMapping","./windowDialog.config"],function(e){e("$UI/system/resources/system.res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../dialog/dialog"),i=e("../windowContainer/windowContainer"),s=e("$UI/system/lib/route/routeUtil"),o=e("./js/receiveMapping"),u=e.normalizeName("./windowDialog"),a=e("./windowDialog.config"),f=r.extend({getConfig:function(){return a},constructor:function(e){this.src="",this.process="",this.activity="",this.forceRefreshOnOpen=!1,this._compose=null,this._composeOK=t.Deferred(),this.callParent(e)},dispose:function(){if(this._activeHandle){var e=this.getModel();e.off(n.ModelBase.ACTIVE_EVENT,this._activeHandle)}this._compose&&this._compose.free(),this.callParent()},doInit:function(e,t){this.callParent(e,t);var r=this.$domNode.attr("xid");r||(r=n.UUID.createUUID(),this.$domNode.attr("xid",r));var s={owner:this,src:this.src,process:this.process,activity:this.activity};s.xid="_compose_"+r+"_",this._compose=new i(s),this._compose.on(i.LOAD_EVENT,function(){this._loaded=!0,this._composeOK.resolve(),this.fireEvent(i.LOAD_EVENT,{source:this}),this.initRouter()},this);var o=this,u=this.getModel();this._activeHandle=function(e){var t=o.getInnerModel();t&&t&&t.fireEvent(n.ModelBase.ACTIVE_EVENT,{source:t})},u.on(n.ModelBase.ACTIVE_EVENT,this._activeHandle)},initRouter:function(){if(!this.routable)return;this._compose.off("onRouteStatePublish"),this._compose.on("onRouteStatePublish",function(e){this.addRouteInnerItem("",e.hashbang,e.isReplace)},this)},doRoute:function(e,t,n){if(!this.routable)return;if(e===""){var r,i,o=this;if(n=="enter")if(s.containeInnerState(t)){var u=s.getParamValue(t);i=s.getInnerStateValue(t);try{r=JSON.parse(u)}catch(a){}this.open(r),this._composeOK&&this._composeOK.done(function(){var e=o._compose.getInnerModel();e.postMessage({type:"routeState",newUrl:i})})}else{try{r=JSON.parse(t)}catch(a){}this.open(r)}else n=="leave"?this.close():n=="update"&&(i=s.getInnerStateValue(t),this._composeOK&&this._composeOK.done(function(){var e=o._compose.getInnerModel();e.postMessage({type:"routeState",newUrl:i})}))}},addRouteItem:function(e,n){if(!this.routable)return;var r=this.getModel().$routeState,i=this.$domNode.attr("xid");if(e=="open")try{var s=t.extend(!0,{},n);s.params&&delete s.params.data,r.addState(i,"",JSON.stringify(s)),r.publishState()}catch(o){}else e=="close"&&(r.removeState(i,"",""),r.publishState(!0))},addRouteInnerItem:function(e,t,n){if(!this.routable)return;var r=this.getModel().$routeState,i=this.$domNode.attr("xid");this.opened&&(r.addInnerState(i,"",t),r.publishState())},propertyChangedHandler:function(e,t,n){switch(e){case"src":case"process":case"activity":t!=n&&this._inited&&(this._loaded=!1,this._compose&&(this._compose.setSrc(this.src),this._compose.setProcess(this.process),this._compose.setActivity(this.activity)));break;default:this.callParent(e,t,n)}},receiverSend:function(e){e&&(e.sender=e.source,e.source=this,this.fireEvent("onReceive",e),o.receiveByMapping(this,e.data),this.fireEvent("onReceived",e))},send:function(e,t){if(e){var n={source:this,data:e,ext:t};this.fireEvent("onReceive",n),o.receiveByMapping(this,n.data,n.ext),this.fireEvent("onReceived",n)}},render:function(){this.callParent()},_refresh:function(e){this._compose&&(this._composeOK=t.Deferred(),this._compose.setSrc(this.src),this._compose.setProcess(this.process),this._compose.setActivity(this.activity),this._compose.refresh(null,e))},_setDialogParam:function(e){},getInnerModel:function(){return this._compose.getInnerModel()},_open:function(e){var t=e?e.data:undefined,r=e?e.params:{},i={source:this,data:t,params:r};this.hasListener("onSend")&&(this.fireEvent("onSend",i),t=i.data,r=i.params),r||(r={}),r.data||(r.data=t),e&&this.set(e);if(!n.Bind.isBound(this._compose.domNode)){var s=this._getBodyNode()[0];this._compose.setCSS({height:"100%",position:"relative"}),this._compose.setParams(r),n.Component.addComponent(s,this._compose)}else this.forceRefreshOnOpen||!this._loaded?this._refresh(r):(this._compose.setParams(r),this._compose.load());if(this._composeOK){var o=this;this._composeOK.done(function(){o._setDialogParam(e);var t=o._compose.getInnerModel();if(t){t.fireEvent("onResize",{source:o._compose});if(!o.showTitle&&o.status==="maximize"){var n=o.getModel();o._model_title=n.getTitle();var r=o.title||t.getTitle()||"";n.setTitle(r)}}})}},close:function(){var e=this.getModel();e&&e.setTitle(this._model_title||"");var t=this.getInnerModel();t&&t.fireEvent(n.ModelBase.INACTIVE_EVENT,{source:t}),this.callParent(),e.fireEvent(n.ModelBase.ACTIVE_EVENT,{source:e}),t&&t.fireEvent("onClose",{source:t})},open:function(e){if(this._viewLoaded)this.callParent(e);else{var t=this,n=arguments.callee,r=n.$owner.superclass,s=n.$name,o=r[s],u=arguments,a=function(){o.apply(t,u),t._viewLoaded=!0,t._compose.off(i.VIEW_LOAD_EVENT,a)};this._compose.on(i.VIEW_LOAD_EVENT,a)}this._open(e)}});return n.Component.addOperations(f,{open:{label:"打开",argsDef:[{name:"option",displayName:n.Message.getMessage(n.Message.JUSTEP231098)}],method:function(e){return this.owner.open(e.option)}},close:{label:"关闭",method:function(e){return this.owner.close()}}}),n.Component.register(u,f),f}),define("$model/UI2/system/components/justep/dataOperation/dataOperation",["require","jquery","$UI/system/lib/justep","$UI/system/components/justep/data/data","$UI/system/components/justep/data/restData","./dataOperation.config","$UI/system/components/justep/windowDialog/windowDialog","$UI/system/resources/system.res","w!$UI/system/components/justep/dataOperation/plugin/iframeFunc.w"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/data/data"),i=e("$UI/system/components/justep/data/restData"),s=e.normalizeName("./dataOperation"),o=e("./dataOperation.config"),u=n.Express,a=e("$UI/system/components/justep/windowDialog/windowDialog");e("$UI/system/resources/system.res"),e("w!$UI/system/components/justep/dataOperation/plugin/iframeFunc.w");var f=n.ModelComponent.extend({constructor:function(e,t){this.callParent(),this._init(e,t)},_init:function(e,t){this.setModel(e),e.registerComponent(t,this),e.resolvedComponent(t)},getConfig:function(){return o},setValue:function(e,t,i,s){var o=this.getModel(),u=typeof e=="string"?o.comp(e):e;if(!(u instanceof r)){var a=new n.Message(n.Message.JUSTEP231153,e);throw n.Error.create(a)}s instanceof r.Row&&s.data!=u&&(s=undefined),typeof s=="string"?u.setValueByID(t,i,s):u.setValue(t,i,s)},filedValues:function(e,i){var s=this.getModel(),o=typeof e=="string"?s.comp(e):e;if(!(o instanceof r)){var a=new n.Message(n.Message.JUSTEP231153,e);throw n.Error.create(a)}if(t.isArray(i))for(var u=0;u<i.length;u++)o.setValue(i[u].filed,i[u].value)},allSetValue:function(e,t,i){var s=this.getModel(),o=typeof e=="string"?s.comp(e):e;if(!(o instanceof r)){var u=new n.Message(n.Message.JUSTEP231153,e);throw n.Error.create(u)}o.each(function(e){e.row.val(t,i)})},refreshByGET:function(e,i,s){var o=s.source;if(o instanceof r){var u=t.Deferred();s.promise=u.promise(),t.ajax({type:"GET",url:e,dataType:"json",async:!i,success:function(e){o.loadData(e),u.resolve()},error:function(){u.reject();var t=new n.Message(n.Message.JUSTEP231142,e);throw n.Error.create(t)}})}},_getResult:function(e,t){var n=this.getModel(),i=[];return e instanceof r&&e.eachByPeek(function(e){var r=e.row,s={$model:n,$row:r};(!(t instanceof u)||u.eval(t,r,s))&&i.push(r)}),i},saveReturn:function(e,n,i){var s=this.getModel();if(e instanceof r){var o=n||-1;o="string"==typeof o?parseInt(o):o;var u=this,a=function(){t.isFunction(s.owner.send)&&s.owner.send(u._getResult(e,i),{insPos:o}),s.owner.close()};e.isChanged()?e.saveData({onSuccess:a}):a()}else s.owner.close()},_createWinDlg:function(e,i,s){var o=this.getModel(),u=t.extend({},s.dlgOption,{showTitle:n.Browser.isPC,forceRefreshOnOpen:!0,src:s.src,xid:e,status:n.Browser.isPC?"normal":"maximize",parentNode:o.getRootNode()}),f=new a(u);if(i){var l=i instanceof r?i:o[i];if(l instanceof r){var c=l.idColumn,h={dataID:i,operation:"edit",mappings:[],locfrom:[c],locto:[c],disableRecordChange:!0};for(var p in l.defCols)h.mappings.push({from:p,to:p});f.__mapping_def__=h}}return f},openWindowDialog:function(e,t,n){var i=this.getModel(),s=i.comp(e);s||(s=this._createWinDlg(e,t,n));var o=t instanceof r?t:i.comp(t);if(o&&o.className){n.params||(n.params={});var u=o.className+".id";n.params.hasOwnProperty(u)||(n.params[u]=o.getRowID())}s.open(n)},deleteData:function(e,t,n){if(e instanceof r){var i=this.getModel(),s=[];t instanceof u?(e.eachByPeek(function(e){var n=e.row,r={$model:i,$row:n};(!(t instanceof u)||u.eval(t,n,r))&&s.push(n)}),s.length>0&&e.deleteData(s,{async:!0,confirm:n})):e.deleteData(null,{async:!0,confirm:n})}},saveData:function(e){e instanceof i?e.saveAllData():e instanceof r&&e.saveData()},openWebPage:function(e,t){e&&(e.substring(0,4).toLowerCase()!=="http"&&(e="http://"+e),t=t||"window","window"===t?window.open(e,"_system"):n.Shell.showPage({iframeFunc:e,url:"$UI/system/components/justep/dataOperation/plugin/iframeFunc.w"}))},_get$domNode:function(e){var t=this.getModel();return t.getElementByXid(e)},setCSS:function(e,n){var r=this._get$domNode(e);t(r).css(n||{})},addClass:function(e,n){if(n){var r=this._get$domNode(e);t(r).addClass(n)}},removeClass:function(e,n){if(n){var r=this._get$domNode(e);t(r).removeClass(n)}},toggleClass:function(e,n){if(n){var r=this._get$domNode(e);t(r).toggleClass(n)}}});return n.Component.addOperations(f,{setValue:{label:"赋值",argsDef:[{name:"data",displayName:n.Message.getMessage(n.Message.JUSTEP231137),required:!0},{name:"col",displayName:n.Message.getMessage(n.Message.JUSTEP231139),required:!0},{name:"value",displayName:n.Message.getMessage(n.Message.JUSTEP231140),required:!0},{name:"row",displayName:n.Message.getMessage(n.Message.JUSTEP231138)}],method:function(e,t){var n=e.row||(t&&t.$object&&t.$object instanceof r.Row?t.$object:undefined),i=e.data||n.data;return this.owner.setValue(i,e.col,e.value,n)}},allSetValue:{label:"所有行赋值",argsDef:[{name:"data",displayName:n.Message.getMessage(n.Message.JUSTEP231137),required:!0},{name:"col",displayName:n.Message.getMessage(n.Message.JUSTEP231139),required:!0},{name:"value",displayName:n.Message.getMessage(n.Message.JUSTEP231140),required:!0}],method:function(e){return this.owner.allSetValue(e.data,e.col,e.value)}},filedValues:{label:"多列赋值",argsDef:[{name:"data",displayName:n.Message.getMessage(n.Message.JUSTEP231137),required:!0},{name:"values",displayName:"值数组",required:!0}],method:function(e){return this.owner.filedValues(e.data,e.values)}},refreshByGET:{label:n.Message.getMessage(n.Message.JUSTEP231136),argsDef:[{name:"url",displayName:"url",required:!0},{name:"sync",displayName:n.Message.getMessage(n.Message.JUSTEP231141)}],method:function(e,t){return this.owner.refreshByGET(e.url,e.sync,t.$event)}},saveReturn:{label:"保存并返回",argsDef:[{name:"data",displayName:"数据"},{name:"index",displayName:"新增插入位置"},{name:"filter",displayName:"返回数据过滤"}],method:function(e,t){var n=e.filter,i=e.data instanceof r?e.data:t.$model[e.data]||r.getMainData(t.$model);n&&"string"==typeof n&&(n=new u(n)),this.owner.saveReturn(i,e.index,n)}},deleteData:{label:"删除",argsDef:[{name:"data",displayName:"数据"},{name:"filter",displayName:"删除数据条件"},{name:"force",displayName:"禁止提示"}],method:function(e,t){var i=e.force===undefined?undefined:typeof e.force=="string"?"true"!==e.force:!e.force,s=e.filter;s&&"string"==typeof s&&(s=new u(s));var o=e.data instanceof r?e.data:t.$model[e.data];if(t.$object&&t.$object instanceof r.Row&&o instanceof r&&t.$object.data===o)t.$object.data.deleteData([t.$object],{async:!0,confirm:i});else if(o instanceof r)this.owner.deleteData(o,s,i);else{if(!r.getMainData(t.$model)){var a=new n.Message(n.Message.JUSTEP231153);throw n.Error.create(a)}this.owner.deleteData(r.getMainData(t.$model),s,i)}}},saveData:{label:"保存",argsDef:[{name:"data",displayName:"数据"}],method:function(e,t){var n=e.filter;n&&"string"==typeof n&&(n=new u(n));var i=e.data instanceof r?e.data:t.$model[e.data];i instanceof r?this.owner.saveData(i):r.getMainData(t.$model)&&this.owner.saveData(r.getMainData(t.$model),n)}},openWindowDialog:{label:"打开子页面",argsDef:[{name:"url",displayName:"页面源"},{name:"params",displayName:"参数"},{name:"receData",displayName:"数据对象"},{name:"option",displayName:"对话框配置"}],method:function(e,n){var i={src:e.url,params:e.params||{},dlgOption:e.option||{}},s,o,u,a,f;if(e.receData)s=e.receData,o=r.$(n.$model,s),n.$object&&n.$object.data&&o===n.$object.data&&(n.$object.data.className||n.$object.data.concept)&&t.isFunction(n.$object.getID)?(o=n.$object.data,u=o.className||o.concept,i.params[u+".id"]=n.$object.getID(),s=o.xid,o.master&&o.master.masterData instanceof r&&(a=o.master.masterData,f=a.getCurrentRow(!0),f&&(i.params[u+".master.id"]=f.getID(),o.master.relation&&(i.params[u+".master.column"]=o.master.relation)))):(u=o.className||o.concept,f=o.getCurrentRow(!0),f&&(i.params[u+".id"]=f.getID()),o.master&&o.master.masterData instanceof r&&(a=o.master.masterData,f=a.getCurrentRow(!0),f&&(i.params[u+".master.id"]=f.getID(),o.master.relation&&(i.params[u+".master.column"]=o.master.relation))));else if(r.getMainData(n.$model)){var l=r.getMainData(n.$model);if(l instanceof r){var c=l.getCurrentRow(!0);c&&(u=l.className||l.concept,i.params[u+".id"]=c.getID()),s=l.xid,l.master&&l.master.masterData instanceof r&&(a=l.master.masterData,f=a.getCurrentRow(!0),f&&(i.params[u+".master.id"]=f.getID(),l.master.relation&&(i.params[u+".master.column"]=l.master.relation)))}}if(n.$event){var h;n.$event.source&&n.$event.source.$domNode?h="_"+n.$event.source.$domNode.attr("xid")+"_dlg_":n.$event.currentTarget?h="_"+t(n.$event.currentTarget).attr("xid")+"_dlg_":h=(new Date).getTime(),h&&this.owner.openWindowDialog(h,s,i)}}},openPage:{label:"打开新页面",argsDef:[{name:"url",displayName:"页面"},{name:"params",displayName:"参数"},{name:"data",displayName:"数据对象"}],method:function(e,i){var s=e.params||{},o,u,a,f,l;if(e.data)f=e.data,l=r.$(i.$model,f),i.$object&&i.$object.data&&l===i.$object.data&&(i.$object.data.className||i.$object.data.concept)&&t.isFunction(i.$object.getID)?(l=i.$object.data,o=l.className||l.concept,s[o+".id"]=i.$object.getID(),l.master&&l.master.masterData instanceof r&&(u=l.master.masterData,a=u.getCurrentRow(!0),a&&(s[o+".master.id"]=a.getID(),l.master.relation&&(s[o+".master.column"]=l.master.relation)))):(o=l.className||l.concept,a=l.getCurrentRow(!0),a&&(s[o+".id"]=a.getID()),l.master&&l.master.masterData instanceof r&&(u=l.master.masterData,a=u.getCurrentRow(!0),a&&(s[o+".master.id"]=a.getID(),l.master.relation&&(s[o+".master.column"]=l.master.relation))));else if(r.getMainData(i.$model)){var c=r.getMainData(i.$model);if(c instanceof r){var h=c.getCurrentRow(!0);h&&(o=c.className||c.concept,s[o+".id"]=h.getID()),c.master&&c.master.masterData instanceof r&&(u=c.master.masterData,a=u.getCurrentRow(!0),a&&(s[o+".master.id"]=a.getID(),c.master.relation&&(s[o+".master.column"]=c.master.relation)))}}n.Shell.showPage(e.url,s)}},openWebPage:{label:"打开外部页面",argsDef:[{name:"url",displayName:"网页地址"},{name:"kind",displayName:"打开模式"}],method:function(e,t){this.owner.openWebPage(e.url,e.kind)}},setCSS:{label:"设置样式",argsDef:[{name:"selector",displayName:"选择器"},{name:"style",displayName:"样式"}],method:function(e,t){this.owner.setCSS(e.selector,e.style)}},addClass:{label:"添加Class",argsDef:[{name:"selector",displayName:"选择器"},{name:"clazz",displayName:"样式class"}],method:function(e,t){this.owner.addClass(e.selector,e.clazz)}},removeClass:{label:"移除Class",argsDef:[{name:"selector",displayName:"选择器"},{name:"clazz",displayName:"样式class"}],method:function(e,t){this.owner.removeClass(e.selector,e.clazz)}},toggleClass:{label:"切换Class",argsDef:[{name:"selector",displayName:"选择器"},{name:"clazz",displayName:"样式class"}],method:function(e,t){this.owner.toggleClass(e.selector,e.clazz)}},loadData:{label:"加载数据",argsDef:[{name:"data",displayName:"数据组件"},{name:"rows",displayName:"数据"},{name:"append",displayName:"增量模式"},{name:"override",displayName:"覆盖模式"}],method:function(e,i){if(e.data){var s=e.data;"string"==typeof s&&(s=r.$(i.$model,s));if(s instanceof r){var o=e.rows||[],u=e.append,a=e.parent,f=e.index,l=e.override,c=s.loadData(o,u,a,f,l);t.isArray(c)&&c.length>0&&s.to(c[0])}else n.Util.hint("加载数据时指定的数据组件["+e.data+"]不存在")}else n.Util.hint("加载数据操作必须指定数据组件")}}}),n.Component.register(s,f),f}),define("$model/UI2/system/components/justep/restDataExcel/importExcel.config",["require"],function(e){return{properties:{data:"string",datePattern:"string",dateTimePattern:"string",timePattern:"string"},events:["onBeforeImport","onSuccess","onError","onUploadStart","onUploadSuccess","onUploadError"],binds:{}}}),define("$model/UI2/system/components/justep/uploader/uploader",[function(){return navigator.userAgent.indexOf("JustepApp")!=-1&&!1?"./uploader-ios":typeof FormData=="function"||typeof FormData=="object"?"./uploader-html5":"./uploader-html4"}(),"require","res!./uploader-ios.js","res!./uploader-html5.js","res!./uploader-html4.js"],function(e,t){return t("res!./uploader-ios.js"),t("res!./uploader-html5.js"),t("res!./uploader-html4.js"),e}),define("$model/UI2/system/components/justep/restDataExcel/importExcel",["require","css!./css/excel","jquery","$UI/system/lib/justep","../uploader/uploader","../data/restData","$UI/system/resources/system.res","./importExcel.config"],function(e){e("css!./css/excel").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../uploader/uploader"),i=e("../data/restData");e("$UI/system/resources/system.res");var s=e.normalizeName("./importExcel"),o=e("./importExcel.config"),u=e.toUrl("/excel/upload"),a=e.toUrl("/excel/import"),f=n.BindComponent.extend({constructor:function(e){this.fileType=".xls,.xlsx",this.data=null,this.datePattern="",this.dateTimePattern="",this.timePattern="",this.callParent(e)},getConfig:function(){return o},dispose:function(){this.callParent()},buildTemplate:function(e){e||(e={}),this.set(e);var n=t('<div class="x-import-excel" component="'+s+'">');return e.xid&&n.attr("xid",e.xid),n},doInit:function(e,t){this.callParent(e,t),this._createUploader(this.domNode)},render:function(){this.callParent()},getData:function(){if(this.data){var e=this.getModel().comp(this.data);return e instanceof i?e:undefined}},_excelFileTest:function(e){if(e){var t=this.fileType.split(","),r=e.file.name,i=r?r.lastIndexOf("."):0;if(i>0){var s=r.substring(i);if(s){s=s.toLowerCase();for(var o=0;o<t.length;o++)if(t[o]==s)return}}e.cancel=!0,n.Util.hint("请选择Excel文件",{type:"danger",delay:8e3})}},_doUploadReady:function(e){this._excelFileTest(e);if(!e.cancel){var t={},n={source:this,param:t};this.fireEvent("onCreateImportParam",n),this.uploader.addData(t),this.fireEvent("onUploadStart",e)}},_doUploadOK:function(e){this.fireEvent("onUploadSuccess",e),this._doImport(e)},_doUploadError:function(e){this.fireEvent("onUploadError",e),n.Util.hint("上传Excel文件失败",{type:"danger",delay:8e3})},_doImport:function(e){var r=e.response.fileName?e.response.fileName:e.response,i=this.getData(),s={excel:r,dataPath:i.className},o=this;t.ajax({type:"POST",dataType:"json",url:a,data:s,error:function(e,t,r){o.fireEvent("onError",{source:o,request:e,textStatus:t,errorThrown:r}),n.Util.hint("导入Excel文件失败",{type:"danger",delay:8e3})},success:function(e,t,r){o.fireEvent("onSuccess",{source:o,response:e});if(e&&e.info){var i=e.info.replace(/\n/g,"<br>");n.Util.hint(i,{type:"warning",delay:0})}}})},_createUploader:function(e){this.uploader=new r(e,{actionUrl:u,autoUpload:!0,requestHeader:{Accept:"application/json"},name:"excel"}),this.uploader.on("onStart",this._doUploadReady,this),this.uploader.on("onSuccess",this._doUploadOK,this),this.uploader.on("onError",this._doUploadError,this)},importExcel:function(){if(!this.getData()){var e=new n.Message(n.Message.JUSTEP231052);throw n.Error.create(e)}var r={source:this,cancel:!1};this.fireEvent("onBeforeImport",r);if(r.cancel)return;t(this.uploader.inputElement).click()}});return n.Component.addOperations(f,{importExcel:{label:n.Message.getMessage(n.Message.JUSTEP231100),icon:"linear linear-indentincrease",method:function(e){return this.owner.importExcel()}}}),n.Component.register(s,f),f}),define("$model/UI2/system/components/justep/restDataExcel/exportExcel.config",["require"],function(e){return{properties:{data:"string",downloadFilename:"string"},events:["onBeforeExport","onSuccess","onError"],binds:{}}}),define("$model/UI2/system/components/justep/restDataExcel/exportExcel",["require","css!./css/excel","jquery","$UI/system/lib/justep","$UI/system/components/justep/docCommon/fileApi","./exportExcel.config"],function(e){e("css!./css/excel").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/docCommon/fileApi"),i=e.normalizeName("./exportExcel"),s=e("./exportExcel.config"),o=e.toUrl("/excel/download"),u=e.toUrl("/excel/export"),a=n.BindComponent.extend({constructor:function(e){this.data=null,this.downloadFilename=null,this.callParent(e)},getConfig:function(){return s},dispose:function(){this.callParent()},buildTemplate:function(e){e||(e={}),this.set(e);var n=t('<div class="x-export-excel" component="'+i+'">');return e.xid&&n.attr("xid",e.xid),n},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n)},doInit:function(e,t){this.callParent(e,t)},render:function(){this.callParent()},getData:function(){if(this.data)return this.getModel().comp(this.data)},exportExcel:function(){var e={source:this,cancel:!1};this.fireEvent("onBeforeExport",e);if(e.cancel)return;this._doExport()},_doExport:function(){var e=this.getData(),i={dataPath:e.className,props:""},s=this;t.ajax({type:"POST",dataType:"json",url:u,data:i,error:function(e,t,r){s.fireEvent("onError",{source:s,request:e,textStatus:t,errorThrown:r}),n.Util.hint("导出Excel文件失败",{type:"danger",delay:8e3})},success:function(e,t,n){s.fireEvent("onSuccess",{source:s,response:e});if(e){var i=s.downloadFilename||e.filename||"导出数据.XLS",u=i.length;if(u<4||".XLS"!==i.substring(u-4).toUpperCase())i+=".XLS";var a=o+"?excel="+encodeURI(e.excel)+"&filename="+encodeURI(i);r.download(a,i),s.fireEvent("onSuccess",{source:s})}}})}});return n.Component.addOperations(a,{exportExcel:{label:n.Message.getMessage(n.Message.JUSTEP231099),icon:"icon-android-download",method:function(e){return this.owner.exportExcel()}}}),n.Component.register(i,a),a}),define("$model/UI2/system/components/justep/restDataFilter/restDataFilterDialog.config",["require"],function(e){return{properties:{restData:"string",showTitle:"boolean",title:"string",status:"string",width:"string",height:"string",top:"string",left:"string",resizable:"boolean"},events:["onLoad","onSend","onOpen","onClose","onReceive","onLoadError","onReceived","onFilter"],binds:{}}}),define("$model/UI2/system/components/justep/restDataFilter/restDataFilterDialog",["require","$UI/system/lib/justep","$UI/system/components/justep/windowDialog/windowDialog","./restDataFilterDialog.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("$UI/system/components/justep/windowDialog/windowDialog"),r=e.normalizeName("./restDataFilterDialog"),i=e("./restDataFilterDialog.config"),s="__user_custom_filter__",o=n.extend({constructor:function(e){this.restData="",this.callParent(e)},getConfig:function(){return i},dispose:function(){this.callParent()},buildTemplate:function(e){this.callParent(e)},doInit:function(t,n){this.src=e.toUrl("./dlg/query.w"),this.callParent(t,n);var r=this;this.on("onSend",function(e){r.doSend(e)}),this.on("onReceived",function(e){r.doFilter(e)})},propertyChangedHandler:function(e,t,n){switch(e){case"restData":if(t!=n){var r=this.getModel();if(r){var i=r.comp(t);i&&(i.setFilter(s,""),i.refreshData())}this._data=null}break;default:this.callParent(e,t,n)}},getData:function(){return this._data||(this._data=this.getModel().comp(this.restData)),this._data},doFilter:function(e){var t=this.getData();if(t){var n={source:this,filter:e.data,cancel:!1};this.fireEvent("onFilter",n),n.cancel||(t.setFilter(s,n.filter),t.refreshData())}},doSend:function(e){e.data=this.getData()}});return t.Component.register(r,o),o}),define("$model/UI2/system/components/justep/request/request.config",["require"],function(e){return{properties:{url:"string",urlExpr:"string",type:"string",dataExpr:"string",async:"boolean",cache:"boolean",dataType:"string",headersExpr:"string",processData:"boolean",timeout:"number",contentType:"string"},events:["onSuccess","onError","onBeforeRequest"],binds:{}}}),define("$model/UI2/system/components/justep/request/request.config",["require"],function(e){return{properties:{url:"string",urlExpr:"string",type:"string",dataExpr:"string",async:"boolean",cache:"boolean",dataType:"string",headersExpr:"string",processData:"boolean",timeout:"number",contentType:"string"},events:["onSuccess","onError","onBeforeRequest"],binds:{}}}),define("$model/UI2/system/components/justep/request/request",["require","jquery","$UI/system/lib/justep","./request.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./request"),i=e("./request.config"),s=n.Express,o=n.BindComponent.extend({constructor:function(e,t){this.callParent(),this.url="",this.urlExpr="",this.type="GET",this.dataExpr="",this.async=!0,this.cache=null,this.dataType="json",this.headersExpr="",this.processData=!0,this.timeout=null,this.contentType=null},getConfig:function(){return i},_processCfg:function(){var e={type:this.type,async:this.async,dataType:this.dataType,processData:this.processData},t=n.Bind.contextFor(this.domNode);return this.urlExpr&&(this._urlExpr instanceof s||(this._urlExpr=new s(this.urlExpr)),this.url=s.eval(this._urlExpr,t.$object,t)||this.url),this.url&&(e.url=this.url),this.cache!==null&&(e.cache=this.cache),this.timeout!==null&&(e.timeout=this.timeout),this.contentType!==null&&(e.contentType=this.contentType),this.dataExpr&&(this._dataExpr instanceof s||(this._dataExpr=new s(this.dataExpr)),e.data=s.eval(this._dataExpr,t.$object,t)),this.headersExpr&&(this._headersExpr instanceof s||(this._headersExpr=new s(this.headersExpr)),e.headers=s.eval(this._headersExpr,t.$object,t)||{}),e},propertyChangedHandler:function(e,t,n){switch(e){case"dataExpr":t!=n&&this._inited&&(this._dataExpr=null);break;case"headersExpr":t!=n&&this._inited&&(this._headersExpr=null);break;case"urlExpr":t!=n&&this._inited&&(this._headersExpr=null);break;default:this.callParent(e,t,n)}},send:function(e){var n=t.extend({},this._processCfg(),e||{}),r=this;n.error=function(e,t,n){r.fireEvent("onError",{source:r,XMLHttpRequest:e,textStatus:t,errorThrown:n})},n.success=function(e,t,n){r.fireEvent("onSuccess",{source:r,data:e,textStatus:t,jqXHR:n})},r.fireEvent("onBeforeRequest",{source:r,options:n});if(!n.url)throw new Error("url是必须的参数");return t.ajax(n)}});return n.Component.addOperations(o,{sendRequest:{label:"发送请求",argsDef:[{name:"options",displayName:"参数"}],method:function(e){return this.owner.send(e.options)}},setRequestOption:{label:"设置请求参数",argsDef:[{name:"cfg",displayName:"参数"}],method:function(e){return this.owner.set(e.cfg)}}}),n.Component.register(r,o),o}),define("$model/UI2/system/components/justep/request/request",["require","jquery","$UI/system/lib/justep","./request.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./request"),i=e("./request.config"),s=n.Express,o=n.BindComponent.extend({constructor:function(e,t){this.callParent(),this.url="",this.urlExpr="",this.type="GET",this.dataExpr="",this.async=!0,this.cache=null,this.dataType="json",this.headersExpr="",this.processData=!0,this.timeout=null,this.contentType=null},getConfig:function(){return i},_processCfg:function(){var e={type:this.type,async:this.async,dataType:this.dataType,processData:this.processData},t=n.Bind.contextFor(this.domNode);return this.urlExpr&&(this._urlExpr instanceof s||(this._urlExpr=new s(this.urlExpr)),this.url=s.eval(this._urlExpr,t.$object,t)||this.url),this.url&&(e.url=this.url),this.cache!==null&&(e.cache=this.cache),this.timeout!==null&&(e.timeout=this.timeout),this.contentType!==null&&(e.contentType=this.contentType),this.dataExpr&&(this._dataExpr instanceof s||(this._dataExpr=new s(this.dataExpr)),e.data=s.eval(this._dataExpr,t.$object,t)),this.headersExpr&&(this._headersExpr instanceof s||(this._headersExpr=new s(this.headersExpr)),e.headers=s.eval(this._headersExpr,t.$object,t)||{}),e},propertyChangedHandler:function(e,t,n){switch(e){case"dataExpr":t!=n&&this._inited&&(this._dataExpr=null);break;case"headersExpr":t!=n&&this._inited&&(this._headersExpr=null);break;case"urlExpr":t!=n&&this._inited&&(this._headersExpr=null);break;default:this.callParent(e,t,n)}},send:function(e){var n=t.extend({},this._processCfg(),e||{}),r=this;n.error=function(e,t,n){r.fireEvent("onError",{source:r,XMLHttpRequest:e,textStatus:t,errorThrown:n})},n.success=function(e,t,n){r.fireEvent("onSuccess",{source:r,data:e,textStatus:t,jqXHR:n})},r.fireEvent("onBeforeRequest",{source:r,options:n});if(!n.url)throw new Error("url是必须的参数");return t.ajax(n)}});return n.Component.addOperations(o,{sendRequest:{label:"发送请求",argsDef:[{name:"options",displayName:"参数"}],method:function(e){return this.owner.send(e.options)}},setRequestOption:{label:"设置请求参数",argsDef:[{name:"cfg",displayName:"参数"}],method:function(e){return this.owner.set(e.cfg)}}}),n.Component.register(r,o),o}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/extendType/js/extendTypeBoolean",["require","$UI/system/components/justep/data/data"],function(e){var t=e("$UI/system/components/justep/data/data"),n=t.ExtendType.extend({constructor:function(e,t,n){this.callParent(e,t,n)}});return n}),define("$model/UI2/system/components/justep/extendType/js/extendTypeEmail",["require","$UI/system/components/justep/data/data"],function(e){var t=e("$UI/system/components/justep/data/data"),n=t.ExtendType.extend({constructor:function(e,t,n){this.callParent(e,t,n),e.addRule(t,{rule:"email",message:"不是email格式"})}});return n}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes.reg",["require","./js/extendTypeBoolean","./js/extendTypeEmail","./js/extendTypeDateTime"],function(e){var t=[{name:"sys.boolean",dataType:"",editor:"$UI/system/components/justep/button/checkbox"},{name:"sys.email",dataType:"String,Text",editor:""},{name:"sys.datetime",dataType:"Date,Time,DateTime",editor:"$UI/system/components/justep/input/input"}],n={"sys.boolean":e("./js/extendTypeBoolean"),"sys.email":e("./js/extendTypeEmail"),"sys.datetime":e("./js/extendTypeDateTime")};for(var r=0,i=t.length;r<i;r++)t[r]["class"]=n[t[r].name];return t}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes",["require","jquery","$UI/system/lib/justep","$UI/system/components/justep/data/data","./commonExtendTypes.config","./commonExtendTypes.reg"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/data/data"),i=e.normalizeName("./commonExtendTypes"),s=e("./commonExtendTypes.config"),o=e("./commonExtendTypes.reg"),u=n.ViewComponent.extend({getConfig:function(){return s},getRegConfig:function(){return o},constructor:function(e){this.callParent(e)},init:function(e,n){this.callParent(e,n);var i=this.getModel(),s=this.getRegConfig();s&&t.isArray(s)&&t.each(s,function(e,t){r.registerExtendType(i,t)})},dispose:function(){var e=this.getModel(),n=this.getRegConfig();n&&t.isArray(n)&&t.each(n,function(t,n){r.unregisterExtendType(e,n.name)}),this.callParent()}});return n.Component.register(i,u),u}),define("$model/UI2/system/components/justep/output/output.config",["require"],function(e){return{properties:{dataType:"string",format:"string"},events:["onRender"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/output/output",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./output.config","$UI/system/components/justep/input/js/decimalFormat"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=t.Bind,r=e.normalizeName("./output"),i=e("./output.config"),s=e("$UI/system/components/justep/input/js/decimalFormat"),o=t.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.value="",this.format="",this.dataType="String"},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-output"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"'":"")+(e.xid?" xid='"+e.xid+"'":"")+" component='"+r+"'"+" ></div>"},doInit:function(e,t){if(n.isObservable(this.ref)&&this.ref.define){var r=this.ref.define.defCol.type;r!==this.dataType&&(this.dataType=r)}if(this.dataType=="DateTime"||this.dataType=="Date"||this.dataType=="Time")this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss"))},render:function(){this.callParent();if(n.isObservable(this.ref)&&this.ref.define){var e=this.ref.define.defCol.type;e!==this.dataType&&(this.dataType=e)}var r=this.value,i;r&&("DateTime"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,"yyyy-MM-ddThh:mm:ss.fff"),i instanceof Date&&(r=t.Date.toString(i,this.format))):"Date"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,t.Date.STANDART_FORMAT_SHOT),i instanceof Date&&(r=t.Date.toString(i,this.format))):"Time"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,"hh:mm:ss"),i instanceof Date&&(r=t.Date.toString(i,this.format))):this.format&&("Integer"==this.dataType||"Long"==this.dataType||"Float"==this.dataType||"Double"==this.dataType||"Decimal"==this.dataType)&&(r=(new s(this.format)).format(r)));if(r===undefined||r===null)r="";var o={source:this,value:this.value,html:r};this.fireEvent("onRender",o),this.domNode.innerHTML=this.parseHTML(o.html)},parseHTML:function(e){return typeof e=="string"?e.replace(/ on/," on "):e},propertyChangedHandler:function(e,t,n){switch(e){case"format":this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss")),t!=n&&(this.needRender=this._inited);break;case"value":t!=n&&this._inited&&(this.fireEvent("onChange",{source:this,originalValue:t,value:n}),this.needRender=!0);break;default:this.callParent(e,t,n)}}});return t.Component.register(r,o),o}),define("$model/UI2/system/components/justep/panel/panel.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/panel/panel",["require","$UI/system/components/justep/common/res","css!./css/panel","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./panel.config"],function(e){function a(e){return e?(e=e.indexOf("%")==-1&&e.indexOf("px")==-1?e+"px":e,e):""}function f(e){return"height:"+a(e)+";"}e("$UI/system/components/justep/common/res"),e("css!./css/panel").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e("jquery"),s=e.normalizeName("./panel"),o=e("./panel.config"),u=r.extend({constructor:function(e){this.baseCls="x-panel",this.useTop=!0,this.useBottom=!0,this.callParent(e),this.backgroundImage=""},getConfig:function(){return o},buildTemplate:function(e){return e.content=e.content||{},e.content.refresh=e.content.refresh!==undefined?e.content.refresh:!1,e.content.load=e.content.load!==undefined?e.content.load:!1,e.top=e.top||{},e.top.visible=e.top.visible!==undefined?e.top.visible:!0,e.top.height=e.top.height!==undefined?e.top.height:"48",e.bottom=e.bottom||{},e.bottom.visible=e.bottom.visible!==undefined?e.bottom.visible:!0,e.bottom.height=e.bottom.height!==undefined?e.bottom.height:"48",n.format("<div xid='{0}' class='{1}' component='{2}'><div class='x-panel-top {3}' style='{4}'>{5}</div><div class='x-panel-content'>{6}</div><div class='x-panel-bottom {7}' style='{8}'>{9}</div></div>",e.xid,this.baseCls,s,e.top.visible?"":"hide",f(e.top.height),e.top.body||"",e.content.body||"",e.bottom.visible?"":"hide",f(e.bottom.height),e.bottom.body||"")},init:function(e,t){this.callParent(e,t),this.$el=i(this.domNode),this.$top=i(">.x-panel-top",this.domNode),this.$content=i(">.x-panel-content",this.domNode),this.$bottom=i(">.x-panel-bottom",this.domNode),this.$top.length===0&&this.$content.css("top",0),this.$bottom.length===0&&this.$content.css("bottom",0);var n=this,r=this.getModel().componentPromise(this.$top[0]),s=this.getModel().componentPromise(this.$content[0]),o=this.getModel().componentPromise(this.$bottom[0]);return i.when(r,s,o).then(function(e,t,r){n.inited()},function(e){alert(e)}),this.setBackgroundImage(this.buildSrc(this.$content.attr("backgroundImage"))),{dependence:!0}},buildSrc:function(t){return t&&t.indexOf("$UI")!=-1&&(t=e.toUrl(t)),t||""},propertyChangedHandler:function(e,t,n){switch(e){case"backgroundImage":this.setBackgroundImage(this.buildSrc(n))}},setBackgroundImage:function(e){this.$content.css("background-image",e?"url("+e+")":""),this.$content.css("backgroundSize","cover")},setHeight:function(e,t){t+="px",i(">.x-panel-"+e,this.$domNode).css("height",t),i(">.x-panel-content",this.$domNode).css(e,t),this.getModel().fireEvent("onResize",{source:this})},getHeight:function(e){return i(">.x-panel-"+e,this.$domNode).css("height")},setVisible:function(e,t){t?i(">.x-panel-"+e,this.$domNode).removeClass("hide"):i(">.x-panel-"+e,this.$domNode).addClass("hide"),e=="top"?t?i(">.x-panel-content",this.$domNode).css("top",i(">.x-panel-top",this.$domNode).height()):i(">.x-panel-content",this.$domNode).css("top",0):t?i(">.x-panel-content",this.$domNode).css("bottom",i(">.x-panel-bottom",this.$domNode).height()):i(">.x-panel-content",this.$domNode).css("bottom",0),this.getModel().fireEvent("onResize",{source:this})},getVisible:function(e){return!i(">.x-panel-"+e,this.$domNode).hasClass("hide")},showTop:function(){this.setVisible("top",!0)},hideTop:function(){this.setVisible("top",!1)},toggleTop:function(){var e=i(">.x-panel-top",this.$domNode).hasClass("hide");this.setVisible("top",e)},showBottom:function(){this.setVisible("bottom",!0)},hideBottom:function(){this.setVisible("bottom",!1)},toggleBottom:function(){var e=i(">.x-panel-bottom",this.$domNode).hasClass("hide");this.setVisible("bottom",e)},get:function(e){return this[e]},remove:function(e){var n=i(".x-panel-"+e,this.$el);n.size()>0&&t.removeNode(n[0])}});return t.register(s,u),u}),define("$model/UI2/system/components/justep/panel/child.config",["require"],function(e){return{properties:{height:"number",visible:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/panel/child",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./child.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./child"),s=e("./child.config"),o=r.extend({constructor:function(e){this.height="48",this.visible=!0,this.___inited=$.Deferred(),this.callParent(e)},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.name=this._getName(),this.owner[this.name]=this,this.callParent(e,n),this.___inited.resolve()},getConfig:function(){return s},_getName:function(){var e=this.$domNode.attr("class");if(e.indexOf("x-panel-top")!=-1)return"top";if(e.indexOf("x-panel-bottom")!=-1)return"bottom";if(e.indexOf("x-panel-left")!=-1)return"left";if(e.indexOf("x-panel-right")!=-1)return"right";if(e.indexOf("x-panel-content")!=-1)return"content"},get:function(e){e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){this[e]=t;if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else{var s=this;this.___inited.then(function(){e="set"+n.camelize(e),s.owner[e]&&s.owner[e](s.name,t)})}},dispose:function(){this.owner=null,this.callParent()},propertyChangedHandler:function(e,t,n){switch(e){case"height":this.set(e,n)}}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/timer/timer.config",["require"],function(e){return{properties:{enabled:"boolean",interval:"number",times:"number"},events:["onTimer","onStop"],binds:{}}}),define("$model/UI2/system/components/justep/timer/timer",["require","$UI/system/lib/justep","./timer.config"],function(e){var t=e("$UI/system/lib/justep"),n=e.normalizeName("./timer"),r=e("./timer.config"),i=t.ViewComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e),this.enabled=!0,this.times=-1,this._pause=!1,this.interval=1e3,this._timerHandle=null},dispose:function(){this.stop(),this.callParent()},buildTemplate:function(e){if(!!e&&!!e.model&&e.model instanceof t.ModelBase)return this.set(e),e.parentNode=e.model.getRootNode(),$("<span "+(e.xid?'xid="'+e.xid+'"':"")+' component="'+n+'" style="display:none;"/>');var r=new t.Message(t.Message.JUSTEP231117);throw t.Error.create(r)},init:function(e,t,n){this.callParent(e,t,n),this.$domNode.hide(),this._inited=!0,this.enabled&&this.start()},stop:function(){this._pause=!1,this.enabled=!1,this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null),this.fireEvent("onStop",{source:this})},start:function(){if(!this._timerHandle){var e=0,t=this;this._timerHandle=setInterval(function(){if(t._pause)return;e++,t.fireEvent("onTimer",{source:t,times:e}),t.times>0&&e>=t.times&&t.stop()},this.interval)}this._pause=!1,this.enabled=!0},pause:function(){this._pause=!0},propertyChangedHandler:function(e,t,n){switch(e){case"enabled":this._inited&&(n?this.start():this.stop());break;default:this.callParent(e,t,n)}}});return t.Component.addOperations(i,{timerStart:{label:"计时器启动",argsDef:[{name:"times",displayName:t.Message.getMessage(t.Message.JUSTEP231149)},{name:"interval",displayName:t.Message.getMessage(t.Message.JUSTEP231150)}],method:function(e){return undefined!==e.times&&this.owner.set("times",e.times),undefined!==e.interval&&this.owner.set("interval",e.interval),this.owner.start()}},timerStop:{label:"计时器停止",argsDef:[],method:function(e){return this.owner.stop()}},timerPause:{label:"计时器暂停",argsDef:[],method:function(e){return this.owner.pause()}}}),t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/code/code.config",["require"],function(e){return{properties:{params:"array"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/code/code",["require","jquery","$UI/system/lib/justep","./code.config","$UI/system/resources/system.res"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./code"),i=e("./code.config");e("$UI/system/resources/system.res");var s=n.ViewComponent.extend({buildTemplate:function(e){var t=new n.Message(n.Message.JUSTEP230073,r);throw n.Error.create(t)},constructor:function(e){this.callParent(e),this.params=[]},getConfig:function(){return i},init:function(e,t){this.callParent(e,t)},getXID:function(){return this.$domNode.attr("xid")},param2Array:function(e){var n=[];return e=e||{},t.each(this.params,function(t,r){n.push(e.hasOwnProperty(r.name)?e[r.name]:r.defaultValue)}),n},exec:function(){var e=this.getModel(),n=this.getXID();return e&&t.isFunction(e[n])?e[n].apply(e,arguments):undefined}});return n.Component.addOperations(s,{exec:{label:n.Message.getMessage(n.Message.JUSTEP231131),argsDef:function(){return this.owner.get("params")},method:function(e){return this.owner.exec.apply(this.owner,this.owner.param2Array(e))}},customOperation:{label:"",argsDef:function(){return this.owner.get("params")},method:function(e){return this.owner.exec.apply(this.owner,this.owner.param2Array(e))}}}),n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/picker/picker.config",["require"],function(e){return{properties:{limit:"number",filter:"string",data:"string",autoLoad:"boolean"},events:["onAfterRender","onChange","onRendered"],binds:{}}}),define("$model/UI2/system/components/justep/picker/picker",["require","css!./css/picker","jquery","$UI/system/lib/justep","./picker.config","$UI/system/components/justep/list/list","$UI/system/components/justep/data/data"],function(e){e("css!./css/picker").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./picker"),i=e("./picker.config"),s=e("$UI/system/components/justep/list/list"),o=e("$UI/system/components/justep/data/data"),u=n.Browser.hasTouch?"touchstart":"mousedown",a=n.Browser.hasTouch?"touchmove":"mousemove",f=n.Browser.hasTouch?"touchend":"mouseup",l=30,c=90,h=40,p=10,d=function(e){return e/(Math.PI/180)},v=n.Browser.isIOS,m=s.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.options={},this.disablePullToRefresh=!0,this.disableInfiniteLoad=!0},dispose:function(){this._afterRenderHandle&&clearTimeout(this._afterRenderHandle),this.callParent()},buildTemplate:function(e){e=e||{};var n=t('<div class="x-picker-inner">  <div class="x-pciker-rule x-pciker-rule-ft"/>  <ul class="x-list-template x-pciker-list">  </ul>  <div class="x-pciker-rule x-pciker-rule-bg"/></div>'),i=t("<li></li>");e["bind-itemText"]&&(i.attr("data-bind","text:"+e["bind-itemText"]),delete e["bind-itemText"]),t("ul.x-list-template",n).append(i),e.template=n,e["class"]||(e["class"]="x-picker");var s=this.callParent(e);return s.attr("component",r),s},doInit:function(e,n){this.lastMoveTime=0,this.lastMoveStart=0,this.stopInertiaMove=!1,this.list=t("ul",this.$domNode),this.findElementItems(),this.visibleRange=c,this.beginAngle=0,this.beginExceed=this.beginAngle-l,this.list.angle=this.beginAngle,this.callParent(e,n)},findElementItems:function(){return this.elementItems=this.$domNode.find("li"),this.elementItems},calcElementItemPostion:function(){this.height=this.$domNode.height(),this.r=this.height/2-p,this.d=this.r*2,v&&this.list.css("webkitTransformOrigin","center center "+this.r+"px"),this.itemHeight=this.elementItems.length>0?this.elementItems[0].offsetHeight:h,0>=this.itemHeight&&(this.itemHeight=h),this.itemAngle=parseInt(this.calcAngle(this.itemHeight*.8)),this.hightlightRange=this.itemAngle/2;var e=this;this.elementItems.each(function(){var n=this,r=e.elementItems.index(n);e.endAngle=e.itemAngle*r,n.angle=e.endAngle,t(n).css("webkitTransformOrigin","center center -"+e.r+"px"),t(n).css("webkitTransform","translateZ("+e.r+"px) rotateX("+ -e.endAngle+"deg)")}),this.endExceed=this.endAngle+l,this.calcElementItemVisibility(this.beginAngle)},calcAngle:function(e){var t=parseFloat(this.r),n;n=t,e=Math.abs(e);var r=parseInt(e/this.d)*180;e%=this.d;var i=(t*t+n*n-e*e)/(2*t*n),s=r+d(Math.acos(i));return s},calcElementItemVisibility:function(e){var n=this;this.elementItems&&this.elementItems.each(function(){var r=this,i=Math.abs(r.angle-e);i<n.hightlightRange?t(r).addClass("highlight"):i<n.visibleRange?(t(r).addClass("visible"),t(r).removeClass("highlight")):(t(r).removeClass("highlight"),t(r).removeClass("visible"))})},setAngle:function(e){this.list.angle=e,this.list.css("webkitTransform","perspective(1000px) rotateY(0deg) rotateX("+e+"deg)"),this.calcElementItemVisibility(e)},_bindEvent:function(){this.callParent();var e=0,t=null,n=this;this.on("onAfterRender",function(e){n.doAfterRender(e)}),this.$domNode.on(u,function(r){r.preventDefault(),n.list.css("webkitTransition",""),t=(r.originalEvent.changedTouches?r.originalEvent.changedTouches[0]:r.originalEvent).pageY,e=n.list.angle,n.updateInertiaParams(r,!0),n[u]=!0}),this.$domNode.on(f,function(e){n[u]=!1,e.preventDefault(),n.startInertiaScroll(e)}),this.$domNode.on("touchcancel",function(e){n[u]=!1,e.preventDefault(),n.startInertiaScroll(e)}),this.$domNode.on(a,function(r){if(n[u]){r.preventDefault();var i=(r.originalEvent.changedTouches?r.originalEvent.changedTouches[0]:r.originalEvent).pageY,s=i-t,o=n.calcAngle(s),a=s>0?e-o:e+o;a>n.endExceed&&(a=n.endExceed),a<n.beginExceed&&(a=n.beginExceed),n.setAngle(a),n.updateInertiaParams(r)}}),this.list.on("click",function(e){var t=e.target;t.tagName=="LI"&&n.setSelectedIndex(n.elementItems.index(t),200)})},updateInertiaParams:function(e,t){var n=this,r=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e.originalEvent;if(t)n.lastMoveStart=r.pageY,n.lastMoveTime=e.timeStamp||Date.now(),n.startAngle=n.list.angle;else{var i=e.timeStamp||Date.now();i-n.lastMoveTime>300&&(n.lastMoveTime=i,n.lastMoveStart=r.pageY)}n.stopInertiaMove=!0},startInertiaScroll:function(e){var t=this,n=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e.originalEvent,r=e.timeStamp||Date.now(),i=(n.pageY-t.lastMoveStart)/(r-t.lastMoveTime);isNaN(i)&&(i=0);var s=i>0?-1:1,o=s*6e-4*-1,u=Math.abs(i/o),a=i*u/2,f=t.list.angle,l=t.calcAngle(a)*s,c=l;f+l<t.beginExceed&&(l=t.beginExceed-f,u=u*(l/c)*.6),f+l>t.endExceed&&(l=t.endExceed-f,u=u*(l/c)*.6);if(l===0){t.endScroll();return}t.scrollDistAngle(r,f,l,u)},scrollDistAngle:function(e,t,n,r){var i=this;i.stopInertiaMove=!1,function(e,t,n,r){var s=13,o=r/s,u=0;(function a(){if(i.stopInertiaMove)return;var e=i.quartEaseOut(u,t,n,o);i.setAngle(e),u++;if(u>o-1||e<i.beginExceed||e>i.endExceed){i.endScroll();return}setTimeout(a,s)})()}(e,t,n,r)},quartEaseOut:function(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t},endScroll:function(){var e=this;if(e.list.angle<e.beginAngle)e.list.css("webkitTransition","150ms ease-out"),e.setAngle(e.beginAngle);else if(e.list.angle>e.endAngle)e.list.css("webkitTransition","150ms ease-out"),e.setAngle(e.endAngle);else{var t=parseInt((e.list.angle/e.itemAngle).toFixed(0));e.list.css("webkitTransition","100ms ease-out"),e.setAngle(e.itemAngle*t)}this.triggerChange()},correctAngle:function(e){var t=this;return e<t.beginAngle?t.beginAngle:e>t.endAngle?t.endAngle:e},doAfterRender:function(e){this.items=this.getBindingObjects()||[];var t=this;this._afterRenderHandle&&clearTimeout(this._afterRenderHandle),this._afterRenderHandle=setTimeout(n.Util.bindModelFn(t.getModel(),function(){t._afterRenderHandle=null,t.findElementItems(),t.calcElementItemPostion(),t.setAngle(t.correctAngle(t.list.angle)),t.fireEvent("onRendered",{source:t})}),0)},getSelectedIndex:function(){return parseInt((this.list.angle/this.itemAngle).toFixed(0))},setSelectedIndex:function(e,t){this.list.css("webkitTransition","");var n=this.correctAngle(this.itemAngle*e);if(t&&t>0){var r=n-this.list.angle;this.scrollDistAngle(Date.now(),this.list.angle,r,t)}else this.setAngle(n);this.triggerChange()},triggerChange:function(e){var t=this;setTimeout(n.Util.bindModelFn(t.getModel(),function(){var n=t.getSelectedIndex(),r=t.items[n];if(r!=t.lastItem||e){var i=t.getData();i instanceof o&&i.to(r);var s={source:t,index:n,item:r};t.fireEvent("onChange",s)}t.lastItem=r}),0)},getSelectedItem:function(){var e=this;return e.items[e.getSelectedIndex()]},setSelectedItem:function(e,t){var n=this;for(var r in n.items){var i=n.items[r];if(i==e){n.setSelectedIndex(r,t);return}}},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n)}});return n.Component.register(r,m),m}),define("$model/UI2/system/components/justep/popOver/popOver.config",["require"],function(e){return{properties:{position:"string",anchor:"string",direction:"string",opacity:"number",dismissible:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/popOver/popOver",["require","$UI/system/components/justep/common/res","css!./css/popOver","$UI/system/lib/justep","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent","./popOver.config","$UI/system/lib/base/layerManager"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/popOver").load();var t=e("$UI/system/lib/justep"),n=e("$UI/system/lib/base/component"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./popOver"),s=e("./popOver.config"),o=e("$UI/system/lib/base/layerManager"),u=r.extend({baseCls:"x-popOver",overlayCls:"x-popOver-overlay",contentCls:"x-popOver-content",constructor:function(){this.position="center",this.anchor=null,this.direction="right-bottom",this.opacity=.5,this.dismissible=!0,this.callParent()},getConfig:function(){return s},buildTemplate:function(e){return null},init:function(e,t){this.$el=$(this.domNode),this.$overlay=$(">."+this.overlayCls,this.$el),this.$content=$(">."+this.contentCls,this.$el),this.callParent(e,t);var n=this;this.$overlay.on("click contextmenu",function(e){e.preventDefault();if(n.dismissible)return n.hide(),!1}),this._resizeFn=function(){n.$el.is(":visible")&&n.pos()},$(window).resize(this._resizeFn)},dispose:function(){t.Browser.isIOS&&(t.Util.enableTouchMove(document.body),t.Util.fixedIosPanel(this.domNode,!1)),$(window).unbind("resize",this._resizeFn),this.callParent()},show:function(){o.setLayerIndex(this.$el),this.$el.css({display:"inline"}),this.pos(),t.Browser.isIOS&&t.Util.fixedIosPanel(this.domNode,!0)},hide:function(){t.Browser.isIOS&&t.Util.fixedIosPanel(this.domNode,!1),this.$el.hide(),o.removeLayerIndex(this.$el)},getAnchorCompNode:function(e){var t=this.anchor;try{t=this.getModel().comp(e).domNode}catch(n){}return t},pos:function(){this.$content.css({margin:"auto",left:"auto",right:"auto",top:"auto",bottom:"auto","max-height":"100%"});var e=this.getAnchorCompNode(this.anchor);e=$(e);var t=$(window).height(),n=$(window).width();if(e.length>0){var r=this.direction||"right-bottom",i=e.offset(),s=e.outerHeight(),o=e.outerWidth(),u=this.$content.outerHeight();i.top-=window.scrollY||0,r==="auto"&&(r="left-",t>=i.top+s+u||u>i.top?r+="bottom":r+="top");switch(r){case"left-top":this.$content.css({bottom:t-i.top,left:i.left,"max-height":i.top});break;case"left-bottom":this.$content.css({top:i.top+s,left:i.left,"max-height":t-i.top-s});break;case"right-top":this.$content.css({bottom:t-i.top,right:n-i.left-o,"max-height":i.top});break;case"right-bottom":this.$content.css({top:i.top+s,right:n-i.left-o,"max-height":t-i.top-s})}return}var a=0;switch(this.position){case"center":this.$content.css({"margin-left":-Math.min(this.$content.width(),n)/2,"margin-top":-Math.min(this.$content.height(),t)/2,top:"50%",left:"50%",right:"auto",bottom:"auto","max-height":t-a});break;case"bottom":this.$content.css({"margin-left":-Math.min(this.$content.width(),n)/2,top:"auto",left:"50%",right:"auto",bottom:a,"max-height":t-a});break;case"left":this.$content.css({"margin-top":-Math.min(this.$content.height(),t)/2,"margin-left":0,top:"50%",left:a,right:"auto",bottom:"auto","max-height":t-a});break;case"right":this.$content.css({"margin-top":-Math.min(this.$content.height(),t)/2,"margin-left":0,top:"50%",left:"auto",right:a,bottom:"auto","max-height":t-a});break;default:this.$content.css({"margin-left":-Math.min(this.$content.width(),n)/2,top:a,left:"50%",right:"auto",bottom:"auto","max-height":t-a})}},propertyChangedHandler:function(e,t,n){switch(e){case"opacity":n=parseFloat(n),isNaN(n)||n>=0&&n<=1&&(this.opacity=n,this.$overlay.css("opacity",n));break;case"dismissible":typeof n=="string"&&(n=n=="true"),this.dismissible=n;break;default:this.callParent(e,t,n)}}});return n.addOperations(u,{show:{label:"显示",icon:null,method:function(e){return this.owner.show()}},hide:{label:"隐藏",icon:null,method:function(e){return this.owner.hide()}}}),n.register(i,u),u}),define("$model/UI2/system/components/justep/picker/popPicker.config",["require"],function(e){return{properties:{opacity:"number"},events:["onOK","onShow","onHide"],binds:{}}}),define("$model/UI2/system/components/justep/picker/popPicker",["require","css!./css/popPicker","$UI/system/lib/justep","$UI/system/lib/base/component","$UI/system/components/justep/popOver/popOver","./picker","./popPicker.config"],function(e){e("css!./css/popPicker").load();var t=e("$UI/system/lib/justep"),n=e("$UI/system/lib/base/component"),r=e("$UI/system/components/justep/popOver/popOver"),i=e("./picker"),s=e.normalizeName("./popPicker"),o=e("./popPicker.config"),u=r.extend({baseCls:"x-popPicker",overlayCls:"x-popPicker-overlay",contentCls:"x-popPicker-content",headerCls:"x-poppicker-header",constructor:function(){this.callParent(),this.position="bottom"},getConfig:function(){return o},buildTemplate:function(e){e.xid||(e.xid=t.UUID.createUUID());var n=$('<div component="'+s+'" class="'+(e["class"]||this.baseCls)+'">'+'<div class="'+this.overlayCls+'"/>'+'<div class="'+this.contentCls+'">'+'<div class="'+this.headerCls+'">'+'  <button class="btn btn-default x-btn-ok">'+t.Message.getMessage(t.Message.JUSTEP231079)+" </button>"+"</div>"+"</div>"+"</div>");return e.xid&&n.attr("xid",e.xid),e.style&&n.attr("style",e.style),n},dispose:function(){this.callParent()},init:function(e,t){this.callParent(e,t);var n=this.getHeader$(),r=this;n.size()>0&&(n.append('<div class="x-poppicker-clear"/>'),n.children(".x-btn-ok").on("click",function(e){r.OKClick(e)}))},addRouteItem:function(e){var t=this.getModel().$routeState,n=this.$domNode.attr("xid");e=="show"?(t.addState(n,"",""),t.publishState(!0)):e=="hide"&&(t.removeState(n,"",""),t.publishState(!0))},doRoute:function(e,t,n){e===""&&(n=="enter"?this.show():n=="leave"&&this.hide())},OKClick:function(e){var t={source:this,cancel:!1};this.fireEvent("onOk",t),t.cancel||this.hide()},pos:function(){this.callParent(),this.$content.css({bottom:"0"})},show:function(){this.callParent(),this.addRouteItem("show"),this.$domNode.addClass("x-active");var e={source:this};this.fireEvent("onShow",e)},hide:function(){this.callParent(),this.$domNode.removeClass("x-active");var e={source:this};this.fireEvent("onHide",e),this.addRouteItem("hide")},getHeader$:function(){return this.$domNode.find("."+this.headerCls+":first")},getContent$:function(){return this.$domNode.find("."+this.contentCls+":first")},getInnerPickers:function(){var e=[],t=this.getModel();return this.$domNode.find(".x-picker").each(function(){e.push(t.comp(this))}),e},addPicker:function(e){var t;e instanceof i?t=e:t=new i(e),n.addComponent(this.getContent$()[0],t);var r=this.$domNode.find(".x-picker");return r.addClass("x-picker"+(r.length>1?"-"+r.length:"")),t},propertyChangedHandler:function(e,t,n){switch(e){default:}this.callParent(e,t,n)}});return n.register(s,u),u}),define("$model/UI2/system/components/justep/datePicker/datePicker.config",["require"],function(e){return{properties:{opacity:"number",type:"string"},events:["onOK","onShow","onHide"],binds:{}}}),define("$model/UI2/system/components/justep/datePicker/datePicker",["require","$UI/system/components/justep/common/res","css!./css/datePicker","jquery","$UI/system/lib/justep","$UI/system/components/justep/picker/popPicker","./datePicker.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/datePicker").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/picker/popPicker"),i=e.normalizeName("./datePicker"),s=e("./datePicker.config"),o=r.extend({constructor:function(){this.callParent(),this.type="datetime",this.min=null,this.max=null,this._yearValue=n.Bind.observable(2016),this._monthValue=n.Bind.observable(1),this._dayValue=n.Bind.observable(1),this._hourValue=n.Bind.observable(0),this._minuteValue=n.Bind.observable(0),this._secondValue=n.Bind.observable(0)},getConfig:function(){return s},dispose:function(){var e=["year","month","day","hour","minute","second"],n=this;t.each(e,function(e,t){n["_set"+t+"PickerValueHandle"]&&clearTimeout(n["_set"+t+"PickerValueHandle"])}),this.callParent()},buildTemplate:function(e){return this.callParent(e)},propertyChangedHandler:function(e,t,n){this.$domNode&&this.$domNode.attr(e,n)},OKClick:function(e){var t={source:this,cancel:!1,value:this.getValue()};this.fireEvent("onOk",t),t.cancel||this.hide()},_createTitle:function(){this.getContent$().append('<div class="x-poppicker-title">    <h5 class="x-year">'+n.Message.getMessage(n.Message.JUSTEP231504)+"</h5>"+'    <h5 class="x-month">'+n.Message.getMessage(n.Message.JUSTEP231502)+"</h5>"+'    <h5 class="x-day">'+n.Message.getMessage(n.Message.JUSTEP231503)+"</h5>"+'    <h5 class="x-hour">'+n.Message.getMessage(n.Message.JUSTEP231505)+"</h5>"+'    <h5 class="x-minute">'+n.Message.getMessage(n.Message.JUSTEP231506)+"</h5>"+'    <h5 class="x-second">'+n.Message.getMessage(n.Message.JUSTEP231507)+"</h5>"+"</div>")},_createPickers:function(){if(!this._isPickersCreated){var e=this;this._createTitle(),this._dayData=n.Bind.computed(function(){var t=e._yearValue.get(),r=e._monthValue.get();if(t&&r){var i=[],s=e._dayValue.peek(),o=n.Date.MaxDay(t,r);o<s&&(e._dayValue.set(o),e._setPickerValue("day",o));for(var u=1;u<=o;u++)i.push(n.String.zeros(u,2));return e._dayComp&&e._dayComp.doAfterRender(),i}return[]}),this._yearData=n.Bind.computed(function(){var t=e._yearValue.get(),n=[],r=e._getMaxYear(),i=e._getMinYear();for(var s=0;s<40;s++){var o=t+s-20;o>=i&&o<=r&&n.push(o)}return n}),this._monthData=[];for(var t=1;t<=12;t++)this._monthData.push(n.String.zeros(t,2));this._hourData=[];for(t=0;t<24;t++)this._hourData.push(n.String.zeros(t,2));this._minuteData=[],this._secondData=[];for(t=0;t<60;t++){var r=n.String.zeros(t,2);this._minuteData.push(r),this._secondData.push(r)}var i=this.getModel();i.__justep__||(i.__justep__={}),i.__justep__.datepicker||(i.__justep__.datepicker={});var s=this.$domNode.attr("xid");s||(s=n.UUID.createUUID()),i.__justep__.datepicker[s+"_dayData_"]=this._dayData,i.__justep__.datepicker[s+"_monthData_"]=this._monthData,i.__justep__.datepicker[s+"_yearData_"]=this._yearData,i.__justep__.datepicker[s+"_hourData_"]=this._hourData,i.__justep__.datepicker[s+"_minuteData_"]=this._minuteData,i.__justep__.datepicker[s+"_secondData_"]=this._secondData,this._yearComp=this.addPicker({"class":"x-picker x-year",data:'$model.__justep__.datepicker["'+s+'_yearData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._yearComp._value=this._yearValue,this._monthComp=this.addPicker({"class":"x-picker x-month",data:'$model.__justep__.datepicker["'+s+'_monthData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._monthComp._value=this._monthValue,this._dayComp=this.addPicker({"class":"x-picker x-day",data:'$model.__justep__.datepicker["'+s+'_dayData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._dayComp._value=this._dayValue,this._hourComp=this.addPicker({"class":"x-picker x-hour",data:'$model.__justep__.datepicker["'+s+'_hourData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._hourComp._value=this._hourValue,this._minuteComp=this.addPicker({"class":"x-picker x-minute",data:'$model.__justep__.datepicker["'+s+'_minuteData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._minuteComp._value=this._minuteValue,this._secondComp=this.addPicker({"class":"x-picker x-second",data:'$model.__justep__.datepicker["'+s+'_secondData_"]',"bind-itemText":"$object",onChange:this._doChange.bind(this)}),this._secondComp._value=this._secondValue,this._isPickersCreated=!0,this.updatePickerValue()}},_getMaxYear:function(){var e=9999;return this.max instanceof Date&&(e=this.max.getFullYear()),e},_getMinYear:function(){var e=0;return this.min instanceof Date&&(e=this.min.getFullYear()),e},_doChange:function(e){var t=e.item;if(t){e.source._value.set(t),this.updatePickerValue();var r=this;setTimeout(n.Util.bindModelFn(r.getModel(),function(){r._updatePickerValueByMaxAndMin()}),1)}},_updatePickerValueByMaxAndMin:function(){var e=this.getValue();e instanceof Date&&(this.min instanceof Date&&e.getTime()<this.min.getTime()?this.setValue(this.min):this.max instanceof Date&&e.getTime()>this.max.getTime()&&this.setValue(this.max))},setValue:function(e){if(e instanceof Date){this._createPickers();if(this._isPickersCreated){if(this.type=="datetime"||this.type=="date")this._yearValue.set(e.getFullYear()),this._monthValue.set(e.getMonth()+1),this._dayValue.set(e.getDate());if(this.type=="datetime"||this.type=="time")this._hourValue.set(e.getHours()),this._minuteValue.set(e.getMinutes()),this._secondValue.set(e.getSeconds());this.updatePickerValue()}}},getValue:function(){if(this._isPickersCreated){if(this.type=="date")return n.Date.fromString(this._getPickerValue("year")+this._getPickerValue("month")+this._getPickerValue("day"),"yyyyMMdd");if(this.type=="datetime")return n.Date.fromString(this._getPickerValue("year")+this._getPickerValue("month")+this._getPickerValue("day")+this._getPickerValue("hour")+this._getPickerValue("minute")+this._getPickerValue("second"),"yyyyMMddhhmmss");if(this.type=="time")return n.Date.fromString(this._getPickerValue("hour")+this._getPickerValue("minute")+this._getPickerValue("second"),"hhmmss")}},_setPickerValue:function(e,n){var r=this["_"+e+"Comp"];if(r){var i=0;t.each(r.items,function(e,t){if(t==n)return i=e,!1}),r.setSelectedIndex(i)}},_getPickerValue:function(e){var t=this["_"+e+"Comp"];if(t){var n=t.getSelectedItem();return n||""}return""},updatePickerValue:function(){this._updatePickerValue("year"),this._updatePickerValue("month"),this._updatePickerValue("day"),this._updatePickerValue("hour"),this._updatePickerValue("minute"),this._updatePickerValue("second")},_updatePickerValue:function(e){var t=this["_"+e+"Comp"];if(t){var r=this;this["_set"+e+"PickerValueHandle"]&&clearTimeout(this["_set"+e+"PickerValueHandle"]),this["_set"+e+"PickerValueHandle"]=setTimeout(n.Util.bindModelFn(r.getModel(),function(){r["_set"+e+"PickerValueHandle"]=null,r._setPickerValue(e,r["_"+e+"Value"].peek())}),1)}},show:function(){this._createPickers(),this.callParent()}});return n.Component.addOperations(o,{show:{label:"",method:function(e){return this.owner.show()}}}),n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/row/row",["require","css!./css/row","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent"],function(e){e("css!./css/row").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/viewComponent"),r=e.normalizeName("./row");return t.register(r,n),n}),define("$model/UI2/system/components/justep/scrollView/scrollView.config",["require"],function(e){return{properties:{hScroll:"boolean",vScroll:"boolean",hScrollbar:"boolean",vScrollbar:"boolean",fadeScrollbar:"boolean",hideScrollbar:"boolean",bounce:"boolean",lockDirection:"boolean",checkDOMChanges:"boolean",snap:"string",scrollbarClass:"string",pullDownLabel:"string",pullDownMoveLabel:"string",pullDownLoadingLabel:"string",pullUpLabel:"string",pullUpMoveLabel:"string",pullUpLoadingLabel:"string",noMoreLoadLabel:"string",autoPullUp:"boolean",autoAppend:"boolean",recycleSelector:""},events:["onScrollMove","onScrollEnd","onPullDown","onPullUp"]}}),define("$model/UI2/system/components/justep/scrollView/scrollView",["require","$UI/system/components/justep/common/res","$UI/system/lib/base/component","./lib/iScrollLite","./lib/iscroll","jquery","$UI/system/lib/base/viewComponent","./scrollView.config","css!./css/scrollView"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/base/component"),n=e("./lib/iScrollLite"),r=e("./lib/iscroll").iScroll,i=e("jquery"),s=e("$UI/system/lib/base/viewComponent"),o=e.normalizeName("./scrollView"),u=e("./scrollView.config");e("css!./css/scrollView").load();var a=s.extend({getConfig:function(){return u},set:function(e){var t=this;i.each(e,function(e,n){t.hasOwnProperty(e)||(t[e]=undefined)}),this.callParent(e)},buildTemplate:function(e){return e=e||{},i('<div class="x-scroll"><div class="x-scroll-content"></div></div>').data("config",e).attr("component",o)},dispose:function(){this.scroller&&this.scroller.destroy(),this.callParent()},init:function(e,t){var s=this;this.pullDownLabel="下拉刷新",this.pullDownMoveLabel="松开刷新",this.pullDownLoadingLabel="加载中....",this.pullUpLabel="加载更多",this.pullUpMoveLabel="释放加载",this.pullUpLoadingLabel="加载中....",this.noMoreLoadLabel="已经到最后.",this.autoPullUp=!0,this.autoAppend=!0,this.recycleSelector="",this.callParent(e,t),this.$rootEle=i(this.domNode).parent(),this.$rootEle.addClass("x-scroll-view"),this.$scrollEle=this.$rootEle.find(">.x-scroll"),this.$scrollEle.find(">.x-pull-down").length===0&&this.$scrollEle.css("top","0"),this.getModel()._status>=3?__justep.cssReady(function(){s.render()}):this.getModel().on("onModelConstructDone",function(){__justep.cssReady(function(){s.render()})},this),this.getModel().on("onScrollRefresh",function(e){this.$rootEle.find(i(e.source.$rootEle)).length>0&&this.refresh()},this),this.useIscrollLite=!0,justep.Browser.isYuanXin&&(this.useIscrollLite=!1,this.$scrollEle.addClass("x-iscoll5"),n=r)},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n);if(e=="pullDownLabel"){if(this.$puEle&&this.$pdEle.hasClass("x-pull-down")){var r=this.$scrollEle.find(".x-pull-down>.x-pull-down-label");r.text(n)}}else if(e=="pullUpLabel"&&this.$puEle&&this.$puEle.hasClass("x-pull-up")){var i=this.$scrollEle.find(".x-pull-up>.x-pull-up-label");i.text(n)}},render:function(){var e=this,t=this.$rootEle.parent().outerHeight(!0),r=this.$rootEle.outerHeight(!0),s=this.$scrollEle.outerHeight(!0);r==s&&r>t&&this.$rootEle.css("height","100%"),this.$rootEle.css("position")!="absolute"?(e.$rootEle.css("position")!="absolute"&&e.$rootEle.css({position:"relative"}),this.$scrollEle.css("position")==="static"&&this.$scrollEle.css({position:"relative"})):this.$scrollEle.css("position")==="static"&&this.$scrollEle.css({width:"100%",top:"0",position:"absolute"}),this.$scrollEle.height()<=50&&(this.$rootEle.hasClass("x-full")||(this.$rootEle.addClass("x-full"),this.$scrollEle.height()<=50&&this.$rootEle.removeClass("x-full")));var o=this.$domNode.data("config")||{};if(typeof MutationObserver=="function"){var u=this.$scrollEle.find(".x-scroll-content"),a=new MutationObserver(function(t){e.refresh()}),f=u.find("div,ul");for(var l=0;l<Math.min(f.length,3);l++)a.observe(f.get(l),{childList:!0});o.checkDOMChanges=!1}else o.checkDOMChanges=!0;o.autoPullUp=this.autoPullUp;var c={hideScrollbar:!0,onRefresh:function(){return e.fireEvent("onScrollRefresh",{source:e})},onScrollMove:function(){return e.fireEvent("onScrollMove",{source:e})},onScrollEnd:function(t){return e.fireEvent("onScrollEnd",{source:e,scrollType:t})},recycleSelector:this.recycleSelector};o=i.extend(c,o),this.scroller=new n(this.$rootEle.get(0),o),this.getModel().on("reflow",function(e){(i(e).find(this.$rootEle).length>0||i(e).is(this.$rootEle))&&this.refresh(!0)},this),this.$scrollEle.find(">.x-pull-down").length>0&&this.pullDown(function(){var e={source:this},t=[];this.fireEvent("onPullDown",e),e.dtd&&(t.push(e.dtd),e.dtd=null),this.getModel()&&this.getModel().fireEvent("onPullDown",e),e.dtd&&t.push(e.dtd);var n=i.Deferred();return i.when.apply(i,t).done(function(){n.resolve()}).fail(function(){n.reject()}),n.promise()}),this.$scrollEle.find(">.x-pull-up").length>0&&this.pullUp(function(e){this.noMoreLoad=!1;var t=[],n={source:this,noMoreLoad:!1};n.dtd&&(t.push(n.dtd),n.dtd=null),this.fireEvent("onPullUp",n),n.dtd&&t.push(n.dtd),this.getModel()&&this.getModel().fireEvent("onPullUp",n),n.noMoreLoad?(this.noMoreLoad=!0,this.scroller.noMoreElement=!0):this.scroller.noMoreElement=!1;var r=i.Deferred();return i.when.apply(i,t).done(function(){r.resolve()}).fail(function(){r.reject()}),r.promise()}),e.getModel().fireEvent("onScrollRefresh",{source:this}),this.$scrollEle.find(">.x-pull-down").length>0&&(this.scroller.options.topOffset=50,this.$scrollEle.find(">.x-pull-down").show()),this.refresh(!0)},scrollTo:function(e){var t=this;if(this.scroller){var n=this.scroller.refresh();n&&n.done?n.done(function(){t._scrollTo(e)}):t._scrollTo(e)}},_scrollTo:function(e){var t=this;typeof e!="number"&&(e==="top"?e=0:e==="end"&&(e=-t.scroller.maxScrollY)),t.scroller&&t.useIscrollLite?t.scroller.scrollTo(e):t.scroller.scrollTo(0,-e)},scrollToElement:function(e){this.scroller.scrollToElement(e)},refresh:function(e){var t=i.Deferred();if(this.scroller){var n=this;if(n.getModel()){if(n.$pdEle&&n.$pdEle.length>0){var r=n.$pdEle.outerHeight(!0);r===0&&(r=50),n.scroller.options.topOffset=r,n.scroller.minScrollY=-r}n.$pdEle&&n.$pdEle.length>0&&setTimeout(function(){n.$pdEle.css("opacity","0.99")},200),n.$puEle&&n.$puEle.length>0&&setTimeout(function(){n.$puEle.css("opacity","0.99")},200);var s=n.scroller.refresh(e);s&&s.done?s.done(function(){t.resolve()}):t.resolve(),n.getModel().fireEvent("onScrollRefresh",{source:n})}}return t.promise()},pullDown:function(e){this.$pdEle=this.$scrollEle.find(">.x-pull-down"),this.$pdiEle=this.$scrollEle.find(".x-pull-down>.x-pull-down-img"),this.$pulEle=this.$scrollEle.find(".x-pull-up>.x-pull-up-label"),this.$pdEle.length==0&&(this.$pdEle=i('<div class="x-pull-down"><span class="x-pull-down-label">'+this.pullDownLabel+"</span></div>"),this.$scrollEle.prepend(this.$pdEle),this.refresh());var t=this.$pdEle.outerHeight(!0);this.scroller.options.topOffset!==t&&(this.scroller.options.topOffset=t);var n=this,r=this.$pdEle.find(".x-pull-down-label");this._pdRefresh=function(){n.$pdEle.hasClass("x-loading")&&(n.$pdEle.removeClass("x-loading"),n.$pdEle.addClass("x-pull-down"),r.text(this.pullDownLabel)),n.$pdiEle.css({transform:"rotate(0deg) translate3d(0,0,0)"})},this.on("onScrollRefresh",this._pdRefresh),this._pdScrollMove=function(){if(n.scroller.y>-15&&n.scroller.y<5){var e=((n.scroller.y-5)/20+1)*-180;n.$pdiEle.css({transform:"rotate("+e+"deg) translate3d(0,0,0)"})}else n.scroller.y>5&&n.$pdiEle.css({transform:"rotate(-180deg) translate3d(0,0,0)"});n.scroller.y>5&&!n.$pdEle.hasClass("x-flip")?(n.$pdEle.addClass("x-flip"),n.$pdEle.removeClass("x-restore"),n.$pdEle.addClass("x-flip"),n.$pdEle.removeClass("x-restore"),r.text(n.pullDownMoveLabel),n.scroller.minScrollY=0):n.scroller.y<5&&n.$pdEle.hasClass("x-flip")&&(n.$pdEle.removeClass("x-flip"),n.$pdEle.addClass("x-restore"),r.text(n.pullDownLabel),n.scroller.minScrollY=-t)},this.on("onScrollMove",this._pdScrollMove),this._pdScrollEnd=function(t){if(t.scrollType==="pullDown"||this.useIscrollLite==0)if(n.$pdEle.hasClass("x-flip")){n.noMoreLoad=!1,n.$pdEle.removeClass("x-flip"),n.$pdEle.addClass("x-loading"),r.text(n.pullDownLoadingLabel),n.noMoreLoad||(this.scroller.noMoreElement=!1,n.$pulEle.text(n.pullUpLabel));try{var s=e.call(this,t);i.type(s)==="object"?i.when(s).done(function(){n.pullDownFinish()}).fail(function(){n.pullDownError()}):i.type(s)==="boolean"&&(s?n.pullDownFinish(t):n.pullDownError(t))}catch(o){throw n.pullDownError(t),new Error(o)}}else n.$pdEle.hasClass("x-restore")&&(n.$pdEle.removeClass("x-restore"),n.$pdEle.addClass("x-pull-down"),this.refresh())},this.on("onScrollEnd",this._pdScrollEnd)},pullDownFinish:function(e){var t=this;this.refresh().done(function(){t._autoPullUp({type:"scroll"})})},pullDownError:function(e){this.refresh()},pullUp:function(e){this.$puEle=this.$scrollEle.find(">.x-pull-up"),this.$puEle.length==0&&(this.$puEle=i('<div class="x-pull-up"><span class="x-pull-up-label">'+this.pullUpLabel+"</span></div>"),this.$scrollEle.append($puEle),this.refresh());var t=this.$puEle.outerHeight(!0),n=this,r=this.$puEle.find(".x-pull-up-label");this._puRefresh=function(){n.$puEle.hasClass("x-loading")&&(n.$puEle.removeClass("x-loading"),n.$puEle.addClass("x-pull-up")),n.noMoreLoad?r.text(n.noMoreLoadLabel):r.text(n.pullUpLabel)},this.on("onScrollRefresh",this._puRefresh),this._puScrollMove=function(){var e=n.scroller.maxScrollY;e>0&&(e=0),n.scroller.y<e&&n.scroller.y<e-t&&!n.$puEle.hasClass("x-flip")?(n.$puEle.removeClass("x-restore"),n.$puEle.addClass("x-flip"),r.text(n.pullUpMoveLabel)):n.scroller.y>e-t&&n.$puEle.hasClass("x-flip")&&(n.$puEle.removeClass("x-flip"),n.$puEle.addClass("x-restore"),r.text(n.pullUpLabel))},this.on("onScrollMove",this._puScrollMove),this._pullUp=function(t){n.$puEle.addClass("x-loading"),r.text(n.pullUpLoadingLabel);var s=e.call(n,t);i.type(s)==="object"?i.when(s).done(function(){n.pullUpFinish()}).fail(function(){n.pullUpError()}):i.type(s)==="boolean"&&(s?n.pullUpFinish():n.pullUpError())},this._puScrollEnd=function(e){e.scrollType==="pullUp"||this.useIscrollLite==0?n.$puEle.hasClass("x-flip")&&(n.$puEle.removeClass("x-flip"),n._pullUp(e)):e.scrollType==="scroll"&&n._autoPullUp(e)},this.on("onScrollEnd",this._puScrollEnd),n.$puEle.on("click",n._pullUp)},_autoPullUp:function(e){var t=this;this.autoPullUp===!0&&e&&e.scrollType==="scroll"&&Math.abs(Math.abs(t.scroller.y)-Math.abs(t.scroller.maxScrollY))<100&&(t.scroller.maxScrollY===0&&t.autoAppend==1?t._pullUp(e):t.scroller.maxScrollY!=0&&t._pullUp(e))},pullUpFinish:function(e){this.refresh()},pullUpError:function(e){this.refresh()}});return justep.Component.addOperations(a,{reachEndDown:{label:"向下滑动",argsDef:[],method:function(e){this.owner.scroller.scrollNextArea()}},reachEndUp:{label:"向上滑动",argsDef:[],method:function(e){this.owner.scroller.scrollPrevArea()}}}),t.register(o,a),a}),define("$model/UI2/system/components/justep/select/radioGroup.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/radioGroup",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","../button/radio","../data/data","./radioGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../button/radio"),i=e("../data/data"),s=e.normalizeName("./radioGroup"),o=e("./radioGroup.config"),u=n.BindComponent.extend({getConfig:function(){return o},constructor:function(e){this.itemStyle="",this.itemClass="",this._oldItemClass="",this._itemTargetName="span",this.callParent(e)},dispose:function(){this.$domNode.off("click"),this.callParent()},val:function(e){if(arguments.length===0)return this.$domNode.find("input:checked").val();this.$domNode.find("input").each(function(){var n=t(this);n.prop("checked",e==n.val())});var r=n.Bind.isObservable(this.ref)?this.ref.get():this.ref instanceof n.BindComponent.NullValue?"":this.ref;e!==r&&(e!==""||r!==undefined&&r!==null)&&this.val2ref()},_buildForeachTemplate:function(e){var t=new r;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="x-radio-group");var r=t("<span class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+s+"' >"+"</span>");if(e["bind-itemset"]){var i=e["bind-itemset"];i="$model.comp($element)['_getForeachData'].bind($model.comp($element),"+i+")()",r.attr("data-bind","foreach:{data:"+i+",afterRender:$model.comp($element)['_doUpdate'].bind($model.comp($element))}")}var o=this._buildForeachTemplate(e),u="component:{name:'"+o.attr("component")+"'";e["bind-itemsetValue"]&&(u+=",value:"+e["bind-itemsetValue"]),e["bind-itemsetLabel"]&&(u+=",label:"+e["bind-itemsetLabel"]),u+="}",o.attr("data-bind",u);var a=e.name||n.UUID.createUUID();return o.attr("name",a),r.append(o),r},doInit:function(e,r){this.$domNode.on("click",t.proxy(this._doClick,this));var i=this.$domNode.attr("name");i||(i=n.UUID.createUUID()),this.$domNode.children(this._itemTargetName+"[component*='/system/components/justep/button/']").attr("name",i)},_getForeachData:function(e){return e instanceof i?e.datas:e},_doUpdate:function(){this.updateValue(this.ref),this.ref&&(this.updateReadonly(this.ref),this.updateValidation(this.ref)),this._doUpdateCss()},_doUpdateCss:function(){var e=this.itemStyle,n=this.itemClass,r=this._oldItemClass;this.$domNode.children().each(function(){var i=t(this);i.attr({style:e}).removeClass(r).addClass(n)})},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},disabledRender:function(){if(this.$domNode){var e=this.isDisabled();this.$domNode.children("span").each(function(){var t=n.Component.getComponent(this);t&&t.set({disabled:e})})}this.callParent()},propertyChangedHandler:function(e,t,n){if("itemClass"===e||"itemStyle"===e)this._doUpdateCss(),"itemClass"===e&&(this._oldItemClass=t);this.callParent(e,t,n)},_doClick:function(e){e.target.nodeName.toLowerCase()=="input"&&(this.val2ref(),this.fireEvent("onChange",{source:this,value:this.val()}))}});return n.Component.register(s,u),u}),define("$model/UI2/system/components/justep/select/checkboxGroup.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/checkboxGroup",["require","jquery","$UI/system/lib/justep","../button/checkbox","./radioGroup","./checkboxGroup.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../button/checkbox"),i=e("./radioGroup"),s=e.normalizeName("./checkboxGroup"),o=e("./checkboxGroup.config"),u=i.extend({getConfig:function(){return o},val:function(e){if(arguments.length===0){var n=[];return this.$domNode.find("input:checked").each(function(){n.push(t(this).val())}),n.join(" ")}if(null===e||undefined===e)e="";var r=(""+e).split(" ");this.$domNode.find("input").each(function(){var e=t(this);e.prop("checked",-1<t.inArray(e.val(),r))})},_buildForeachTemplate:function(e){var t=new r;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){return e["class"]||(e["class"]="x-checkbox-group"),this.callParent(e)}});return n.Component.register(s,u),u}),define("$model/UI2/system/components/justep/select/select.config",["require"],function(e){return{properties:{optionsAutoLoad:"boolean",disabled:"boolean"},events:["onChange"],binds:{"bind-labelRef":"labelRef","bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/select",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./select.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./select"),r=e("./select.config"),i="ontouchstart"in window,s=i?"touchstart":"mousedown",o=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e),this.disabled=!1,this.options=null,this.optionsAutoLoad=!0,this.optionsCaption="",this.optionsText="",this.optionsValue=""},dispose:function(){this.$domNode.off("optionChange"),this.$domNode.off("change"),this.$domNode.off(s),this.callParent()},val:function(e){var t=this.$domNode.val();if(arguments.length===0)return t;this.$domNode.val(arguments[0])},buildTemplate:function(e){e||(e={});var r=e.model;if(!r&&e.parentNode){var i=t.Bind.contextFor(e.parentNode);r=i&&i.$model}this._createOptionsRender(r),this.set(e),e["class"]||(e["class"]="form-control"),e["bind-optionsLabel"]&&(e["bind-optionsText"]="'"+e["bind-optionsLabel"]+"'",delete e["bind-optionsLabel"]);var s=["bind-optionsCaption","bind-optionsValue"];for(var o=0;o<s.length;o++)e[s[o]]&&(e[s[o]]="'"+e[s[o]]+"'");return e["bind-options"]&&(e["bind-optionsBeforeRender"]="$model.__justep__.selectOptionsBeforeRender.bind($model,$element)",e["bind-optionsAfterRender2"]="$model.__justep__.selectOptionsAfterRender.bind($model,$element)"),"<select class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" ></select>"},doInit:function(e,t,n){this.$domNode.on("optionChange",$.proxy(this._doOptionChange,this)),this.$domNode.on("change",$.proxy(this._doChange,this)),this.$domNode.on(s,$.proxy(this._loadData,this)),this.labelRef=e?e.labelRef:null},doUpdate:function(e,t,n){this.labelRef=e?e.labelRef:null,n.has("options")&&(this.options=n.get("options")),this._addDefaultOption(),this.callParent(e,t)},_createOptionsRender:function(e){var n=e||this.getModel();n.__justep__||(n.__justep__={}),n.__justep__.selectOptionsAfterRender||(n.__justep__.selectOptionsAfterRender=function(e){var n=t.Component.getComponent(e);n&&n._addDefaultOption()}),n.__justep__.selectOptionsBeforeRender||(n.__justep__.selectOptionsBeforeRender=function(e){var n=t.Component.getComponent(e);n&&n._optionsBeforeRender()})},_loadData:function(e){if(this._load)return;if(!this.options)return;if("OPTION"===e.target.tagName.toUpperCase())return;var t;this.optionsAutoLoad&&(t=this.options.owner,t&&!t.autoLoad&&!t.isLoaded()&&(this._load=t.refreshData())),this.ref&&this.updateValue(this.ref)},_optionsBeforeRender:function(){this.$domNode.children("[_default_option_='true']").remove()},_addDefaultOption:function(){if(!this.options)return;var e=this.options.owner,t,n;e&&(this.ref&&this.labelRef?(t=this.ref.get(),n=this.labelRef.get(),n!==undefined&&n!==null&&n!==""?(this._addOption(t,n),this.$domNode.val(t)):t!==undefined&&t!==null&&t!==""?(this._addOption(t,t),this.$domNode.val(t)):this._optionsBeforeRender()):this.ref&&(t=this.ref.get(),t!==undefined&&t!==null&&t!==""?(this._addOption(t,t),this.$domNode.val(t)):this._optionsBeforeRender()))},_addOption:function(e,t){if(!this._optionExistValue(e)){t=null!==t&&undefined!==t?t:"";var n=this.$domNode.children("option[_default_option_=true]");if(n.size()<=0){var r=document.createElement("option");$(r).attr("_default_option_","true"),r.value=e,r.text=t,this.domNode.add(r,null)}else n.attr("value",e).text(t)}},_optionExistValue:function(e){e=e===undefined||e===null?"":e;var t=this.domNode.options;for(var n=t.length-1;n>=0;n--)if(e==t[n].value||e+""==t[n].value)return!0},_getLabel:function(){var e=this.$domNode.prop("selectedIndex");return e>-1?this.$domNode.prop("options")[e].text:undefined},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},_doChange:function(e){this.val2ref(),this._val2ref(this.labelRef,this._getLabel()),this.fireEvent("onChange",{source:this,value:this.val()})},_doOptionChange:function(e){this.updateValue(this.ref)}});return o.createEditor=function(e){if(!e)return;var t={};$.extend(t,e.getParam()),e.bindRef&&(t["bind-ref"]=e.bindRef);var n=["optionsLabel","optionsCaption","optionsValue"];for(var r=0;r<n.length;r++)t[n[r]]&&(t["bind-"+n[r]]=t[n[r]]);return t.options&&(t["bind-options"]="$model."+t.options),new o(t)},t.Component.register(n,o),o}),define("$model/UI2/system/components/justep/numberSelect/js/numberList",["require","$UI/system/resources/system.res","css!../css/numberList","jquery","$UI/system/lib/justep"],function(e){e("$UI/system/resources/system.res"),e("css!../css/numberList").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=n.Object.extend({constructor:function(e,n,r,i,s,o,u,a){this.element=t(e||"body").append("<div/>").children().last().addClass((n||"")+" list-group x-numberlist").get(0),this.move=0,this.input=r,this.setParam(i,s,o,u,a)},dispose:function(){t(this.element).remove()},setParam:function(e,n,r,i,s){t(this.element).empty();var o=this;this.min=e,this.max=n,i=i||7,this.showItem=i,this.showCharSize=r||1,this.canShowAll=this.max-this.min+1<=i,this.canShowAll||this.createChild("-","list-group-item list-group-item-info sub",function(){return o.isFocus=!0,o.start(-1,!0),!1},function(){return o.isFocus=!1,o.stop(),t(o.input).focus(),!1}),this.canShowAll&&(this.showItem=this.max-this.min+1);var u=function(e){return o.isFocus=!0,!1},a=function(e){var n=t(e.target).text(),r=t(o.input).val(n);return o.input.readOnly||r.focus(),o.isFocus=!1,o.hide(),t(o.input).change(),s&&s(n),!1};for(var f=0;f<this.showItem;f++)this.createChild(" ","list-group-item",u,a);this.canShowAll||this.createChild("+","list-group-item list-group-item-info add",function(){return o.isFocus=!0,o.start(1,!0),!1},function(){return o.isFocus=!1,o.stop(),t(o.input).focus(),!1}),this.hide()},doHideEvent:function(e){var t=e.target||e.srcElement;this&&t.parentElement!=this.element&&this.hide()},show:function(){var e=this.input;this.current=parseInt(e.value||this.min),this.refresh();var n=t(e),r=t(this.element);r.css({top:-3e3,left:-3e3}).show();var i=n.offset(),s=i.top-r.outerHeight(!0),o=t(document).height()<i.top+n.outerHeight(!0)+r.outerHeight(!0)&&s>0;r.css({top:o?i.top-r.outerHeight(!0):i.top+n.outerHeight(!0),left:i.left}),this.bodyMDownFunc=this.doHideEvent.bind(this),t("body").on("mousedown touchstart",this.bodyMDownFunc)},hide:function(){t("body").off("mousedown touchstart",this.bodyMDownFunc),t(this.element).hide()},createChild:function(e,n,r,i){var s=t(this.element).append("<a href='#' class='"+n+"'/>").children().last().get(0);t(s).text(e),i?(t(s).bind("mousedown touchstart",r),t(s).bind("mouseup touchend",i)):t(s).bind("click",r)},refresh:function(){var e=t(this.element).children(),r,i,s;if(this.canShowAll){r=this.min;var o=function(e,t){this.element.scrollTop=e.outerHeight()*(t-3)};for(i=0;i<=this.max-this.min;i++){s=n.String.zeros(r++ +"",this.showCharSize),t(e.get(i)).text(s);if(r==this.current&&i>3){var u=t(e.get(i)),a=i;window.setTimeout(o.bind(this,u,a),10)}}}else{var f=parseInt(this.showItem/2),l=this.current;l>=this.max-f?l=this.max-f:l<=this.min+f&&(l=this.min+f),r=l-f-1;for(i=1;i<this.showItem+1;i++)s=n.String.zeros(r+i+"",this.showCharSize),t(e.get(i)).text(s)}},start:function(e){this.move=e,this.run()},stop:function(){this.move=0},run:function(){if(this.move>0&&this.current+3<this.max||this.move<0&&this.current-3>this.min)this.current+=this.move,this.refresh(),setTimeout(this.run.bind(this),60)}});return r}),define("$model/UI2/system/components/justep/numberSelect/numberSelect.config",["require"],function(e){return{properties:{min:"number",max:"number",showItemSize:"number",showCharSize:"number"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/numberSelect/numberSelect",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./js/numberList","./numberSelect.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e("./js/numberList"),r=e.normalizeName("./numberSelect"),i=e("./numberSelect.config"),s=t.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.min=0,this.max=100,this.showItemSize=null,this.showCharSize=null,this.value="",this.callParent(e)},dispose:function(){this.list&&(this.list.dispose(),this.list=null),this.callParent()},val:function(e){if(arguments.length===0)return this.value;this.set({value:e})},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control x-numberSelect"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' "+" ></input>"},doInit:function(e,n){t.Browser.isMobile&&this.$domNode.prop("readonly",!0),this._bindEvent()},_bindEvent:function(){var e=this;this.$domNode.on("click",function(t){e.showList(),e.domNode.select()}).on("keypress",function(t){e.hideList();if(t.keyCode<48||t.keyCode>57)return!1}).on("paste",function(e){return!1}).on("change",function(t){e.doChange()})},showList:function(){this.getList().show()},hideList:function(){this.getList().hide()},getList:function(){return this.list||(this.list=new n(null,null,this.domNode,this.min,this.max,this.showCharSize,this.showItemSize)),this.list},render:function(){this.callParent(),this.$domNode.val(this.value)},doChange:function(e){var t=parseInt(this.$domNode.val());t<this.min&&(t=this.min),t>this.max&&(t=this.max),this.set({value:this.$domNode.val()})},propertyChangedHandler:function(e,t,n){switch(e){case"min":case"max":case"showItemSize":case"showCharSize":this.list&&this.list.setParam(this.min,this.max,this.showCharSize,this.showItemSize);break;case"value":t!=n&&this._inited&&(this.fireEvent("onChange",{source:this,originalValue:t,value:n}),this.val2ref()),this.needRender=this._inited;break;default:this.callParent(e,t,n)}}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/textarea/textarea.config",["require"],function(e){return{properties:{placeHolder:"string",disabled:"boolean",valueUpdateMode:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/textarea/textarea",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./textarea.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./textarea"),i=e("./textarea.config"),s=n.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.placeHolder="",this.valueUpdateMode=null},dispose:function(){this.removeHandlers(),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<textarea class='"+e["class"]+"' "+(e.style?" style='"+e.style+"'":"")+(e.xid?" xid='"+e.xid+"'":"")+" component='"+r+"'"+" ></textarea>"},doInit:function(e,t){this.addHandlers()},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},val:function(e){var t=this.$domNode.val();if(arguments.length===0)return t;var r=e;if(r===undefined||r===null)r="";if(r!=t){var i=this.$domNode;i.val(r),this._inited&&this.fireEvent("onChange",{source:this,value:e});var s=n.Bind.isObservable(this.ref)?this.ref.get():this.ref instanceof n.BindComponent.NullValue?"":this.ref;r!==s&&(r!==""||s!==undefined&&s!==null)&&this.val2ref()}},addHandlers:function(){var e=this,n=t.proxy(this.doChange,this);this.$domNode.on("change",n),typeof this.valueUpdateMode=="string"&&(this.valueUpdateMode=this.valueUpdateMode.split(",")),t.isArray(this.valueUpdateMode)&&t.each(this.valueUpdateMode,function(t,r){r&&e.$domNode.on(r,n)})},removeHandlers:function(){this.$domNode.off("change")},doChange:function(e){this.fireEvent("onChange",{source:this,value:this.$domNode.val()}),this.val2ref()},clear:function(){this.val(null)}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/titleBar/titleBar.config",["require"],function(e){return{properties:{title:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/titleBar/titleBar",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","$UI/system/lib/base/object","$UI/system/lib/justep","./titleBar.config","css!./css/titleBar"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e("$UI/system/lib/base/object"),s=e("$UI/system/lib/justep"),o=e.normalizeName("./titleBar"),u=e("./titleBar.config");e("css!./css/titleBar").load();var a=r.extend({getUrl:function(){return o},constructor:function(e){this.title="",this.callParent(e)},buildTemplate:function(e){return e.right.reverse=e.right.reverse===!0||e.right.reverse===undefined?!0:!1,n.format("<div class='x-titlebar' xid='{0}' componet='{1}'><div class='x-titlebar-left {2}'>{3}</div><div class='x-titlebar-title' style='display:{4}'>{5}</div><div class='x-titlebar-right {6}'>{7}</div></div>",e.xid,o,e.left.reverse?"reverse":"",e.left.body,e.title?"block":"none",e.title||"",e.right.reverse?"reverse":"",e.right.body)},getConfig:function(){return u},init:function(){this.callParent(),this.$left=$(">.x-titlebar-left",this.domNode),this.$right=$(">.x-titlebar-right",this.domNode),this.$title=$(">.x-titlebar-title",this.domNode),this.left=new f({owner:this,name:"left"}),this.right=new f({owner:this,name:"right"})},setTitle:function(e){e?$(">.x-titlebar-title",this.domNode).show():e="",$(">.x-titlebar-title",this.domNode).html(e)},setReverse:function(e,t){typeof t=="string"&&(t=t=="true"),t?$(">.x-titlebar-"+e,this.domNode).addClass("reverse"):$(">.x-titlebar-"+e,this.domNode).removeClass("reverse")},propertyChangedHandler:function(e,t,n){switch(e){case"title":this.setTitle(n);break;default:this.callParent(e,t,n)}}}),f=i.extend({constructor:function(e){s.Util.apply(this,e)},get:function(e){e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.name,t)}});return t.register(o,a),a}),define("$model/UI2/system/components/justep/windowReceiver/windowReceiver.config",["require"],function(e){return{properties:{},events:["onReceive"],binds:{}}}),define("$model/UI2/system/components/justep/windowReceiver/windowReceiver",["require","jquery","$UI/system/lib/justep","./windowReceiver.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=n.ModelBase,i=e.normalizeName("./windowReceiver"),s=e("./windowReceiver.config"),o=n.BindComponent.extend({getConfig:function(){return s},constructor:function(e){this.callParent(e)},dispose:function(){this.getModel().off(r.PARAMS_RECEIVE_EVENT,this._doReceive,this),this.callParent()},buildTemplate:function(e){return e||(e={}),'<span component="'+i+'" '+(e.xid?' xid="'+e.xid+'" ':"")+">"+"</span>"},doInit:function(e,t){this.getModel().on(r.PARAMS_RECEIVE_EVENT,this._doReceive,this)},_doReceive:function(e){var t=this.getModel();n.ModelBase.MODEL_STATUS_LOAD>t.getStatus()?t.on(n.ModelBase.LOAD_EVENT,this.doReceive.bind(this,e)):this.doReceive(e)},getReceiveData:function(){return this.getModel().params},doReceive:function(e){if(e){var n=t.extend({},e);n.data=this.getModel().params?this.getModel().params.data:undefined,n.source=this,n.sender=this.getModel().owner,this.fireEvent("onReceive",n)}},sendData:function(e){var n=this.getModel().owner;n&&(t.isFunction(n.receiverSend)?n.receiverSend({source:this,data:e}):n.send(e))},windowEnsure:function(e){var n=this.getModel().owner;n&&(t.isFunction(n.receiverSend)?n.receiverSend({source:this,data:e}):n.send(e),n.close())},windowCancel:function(){this.getModel().owner&&this.getModel().owner.close()}});return n.Component.addOperations(o,{windowCancel:{label:"",icon:"icon-chevron-left",method:function(e){return this.owner.windowCancel()}},windowEnsure:{label:"",argsDef:[{name:"data",displayName:"返回的数据"}],method:function(e){return this.owner.windowEnsure(e.data)}},sendData:{label:"",argsDef:[{name:"data",displayName:"返回的数据"}],method:function(e){return this.owner.sendData(e.data)}}}),n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/windowRunner/windowRunner.config",["require"],function(e){return{properties:{src:"string",process:"string",activity:"string",title:"string"},events:["onReceive","onSend","onOpen","onClose"],binds:{}}}),define("$model/UI2/system/components/justep/windowRunner/windowRunner",["require","jquery","$UI/system/lib/justep","./windowRunner.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./windowRunner"),i=e("./windowRunner.config"),s=n.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.src="",this.process="",this.activity="",this.title="",this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),'<span component="'+r+'" '+(e.xid?' xid="'+e.xid+'" ':"")+">"+"</span>"},doInit:function(e,t){this.callParent(e,t)},receiverSend:function(e){e&&(e.sender=e.source,e.source=this,this.fireEvent("onReceive",e))},send:function(e){if(e){var t={source:this,data:e};this.fireEvent("onReceive",t)}},getContext:function(){return this.getModel().getContext()},_getPageOption:function(e){var n=t.extend({},e);return n.src&&!n.url&&(n.url=n.src),delete n.params,delete n.data,delete n.src,n.process||(n.process=this.process||this.getContext().getProcess()),n.activity||(n.activity=this.activity||this.getContext().getActivity()),n.title||(n.title=this.title),n.url||(n.url=this.src),n},open:function(e){var t=e?e.data:undefined,r=e?e.params:{};e?this.set(e):e={};var i={source:this,data:t,params:r};this.hasListener("onSend")&&(this.fireEvent("onSend",i),t=i.data,r=i.params),r||(r={}),r.data||(r.data=t);var s=this;return n.Shell.showPage(this._getPageOption(e),r,{owner:this}).then(function(e){var t=e.container.getInnerModel();s.fireEvent("onOpen",{source:s,innerModel:t})})},close:function(){var e=this;return n.Shell.closePage(this._getPageOption()).then(function(){e.fireEvent("onClose",{source:e})})}});return n.Component.addOperations(s,{open:{label:"",method:function(e){return this.owner.open()}},close:{label:"",method:function(e){return this.owner.close()}}}),n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/locker/locker.config",["require"],function(e){return{properties:{mode:"number",R:"number",password:"array",ringColor:"string",fillColor:"string",lineColor:"string",pointColor:"string",SuccessLineColor:"string",SuccessPointColor:"string",ErrorLineColor:"string",ErrorPointColor:"string"},events:["onInput","onCheckSuccess","onCheckError","onPasswordSuccess","onPasswordError"],binds:{}}}),define("$model/UI2/system/components/justep/locker/locker",["require","css!./css/locker","jquery","$UI/system/lib/justep","./locker.config"],function(e){e("css!./css/locker").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./locker"),i=e("./locker.config"),s=n.Browser.hasTouch?"touchstart":"mousedown",o=n.Browser.hasTouch?"touchmove":"mousemove",u=n.Browser.hasTouch?"touchend":"mouseup",a={normal:0,check:1,setPassword:2},f=n.ViewComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.mode=a.normal,this.OffsetX=30,this.OffsetY=30,this.R=26,this.times=4,this.ringColor="#888",this.fillColor="#f3f3f3",this.lineColor="rgb(0,136,204)",this.pointColor="rgb(0,136,204)",this.SuccessLineColor="rgb(20,255,20)",this.SuccessPointColor="rgb(20,255,20)",this.ErrorLineColor="rgb(255,20,20)",this.ErrorPointColor="rgb(255,20,20)",this.pointLocations=[],this.password=[]},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-locker"),"<canvas class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' "+" ></canvas>"},init:function(e,t){this.callParent(e,t),this.ctx=this.domNode.getContext("2d"),this.CW=this.$domNode.innerWidth(),this.CH=this.$domNode.innerHeight(),this.R*=this.times,this.CW*=this.times,this.CH*=this.times,this.OffsetX*=this.times,this.OffsetY*=this.times,this.domNode.width=this.CW,this.domNode.height=this.CH;var n=(this.CW-2*this.OffsetX-this.R*2*3)/2,r=(this.CH-2*this.OffsetY-this.R*2*3)/2;this.pointLocations=this.getPointLocations(n,r),this.draw(),this._bindEvent(),this.__locker_inited=!0},getPointLocations:function(e,t){var n=[];for(var r=0;r<3;r++)for(var i=0;i<3;i++){var s={X:this.OffsetX+i*e+(i*2+1)*this.R,Y:this.OffsetY+r*t+(r*2+1)*this.R};n.push(s)}return n},draw:function(e,t){e=e||[];var n=this.ctx,r=this.pointLocations,i=this.R,s;if(e.length>0){n.beginPath();for(s=0;s<e.length;s++){var o=e[s];n.lineTo(r[o].X,r[o].Y)}n.lineWidth=2*this.times,n.strokeStyle=this.lineColor,n.stroke(),n.closePath();if(t){var u=e[e.length-1],a=r[u];n.beginPath(),n.moveTo(a.X,a.Y),n.lineTo(t.X,t.Y),n.stroke(),n.closePath()}}for(s=0;s<r.length;s++){var f=r[s];n.fillStyle=this.ringColor,n.beginPath(),n.arc(f.X,f.Y,i,0,Math.PI*this.times,!0),n.closePath(),n.fill(),n.fillStyle=this.fillColor,n.beginPath(),n.arc(f.X,f.Y,i-2*this.times,0,Math.PI*this.times,!0),n.closePath(),n.fill(),e.indexOf(s)>=0&&(n.fillStyle=this.pointColor,n.beginPath(),n.arc(f.X,f.Y,i-16*this.times,0,Math.PI*this.times,!0),n.closePath(),n.fill())}},isPointSelect:function(e,t){for(var n=0;n<this.pointLocations.length;n++){var r=this.pointLocations[n],i=Math.abs(r.X-e.elementX),s=Math.abs(r.Y-e.elementY),o=Math.pow(i*i+s*s,.5);if(o<this.R){t.indexOf(n)<0&&t.push(n);break}}},_bindEvent:function(){var e=this.ctx,t=this,r=[],i=!1;this._startHandler=function(e){e.stopPropagation();var n=t.$domNode.offset();e.point=event.changedTouches?event.changedTouches[0]:event,e.point.elementX=(e.point.pageX-n.left)*t.times,e.point.elementY=(e.point.pageY-n.top)*t.times,t.isPointSelect(e.point,r),i=!0},this.$domNode.on(s,t._startHandler),this._moveHanlder=function(n){if(!i)return;n.stopPropagation(),n.preventDefault();var s=t.$domNode.offset();n.point=event.changedTouches?event.changedTouches[0]:event,n.point.elementX=(n.point.pageX-s.left)*t.times,n.point.elementY=(n.point.pageY-s.top)*t.times;var o=n.point;t.isPointSelect(o,r),e.clearRect(0,0,t.CW,t.CH),t.draw(r,{X:o.elementX,Y:o.elementY})},this.$domNode.on(o,t._moveHanlder),this._endHandler=function(s){s.stopPropagation();var o=t.$domNode.offset();s.point=event.changedTouches?event.changedTouches[0]:event,s.point.elementX=(s.point.pageX-o.left)*t.times,s.point.elementY=(s.point.pageY-o.top)*t.times,e.clearRect(0,0,t.CW,t.CH);var u,f;t.mode===a.normal?(t.draw(r),u={source:t,values:r,password:r.join(""),clear:!0},t.fireEvent("onInput",u),u.clear&&t.clear()):t.mode===a.check?(f=t._compPassword(r,t.password),t._draw(r,f),f?(u={source:t,values:r,password:r.join(""),preventDefault:!1,clear:!1},t.fireEvent("onCheckSuccess",u),u.preventDefault||n.Util.hint(n.Message.getMessage(n.Message.JUSTEP231108))):(u={source:t,values:r,preventDefault:!1,clear:!1},t.fireEvent("onCheckError",u),u.preventDefault||n.Util.hint(n.Message.getMessage(n.Message.JUSTEP231109))),u.clear&&t.clear()):t.mode===a.setPassword&&(t._newPassword&&t._newPassword.length>0?(f=t._compPassword(t._newPassword,r),t._draw(r,f),f?(u={source:t,values:r,password:r.join(""),preventDefault:!1,clear:!1},t.fireEvent("onPasswordSuccess",u),u.clear&&t.clear(),u.preventDefault||n.Util.hint(n.Message.getMessage(n.Message.JUSTEP231110))):(u={source:t,values:r,password:r.join(""),preventDefault:!1,clear:!1},t.fireEvent("onPasswordError",u),u.clear&&t.clear(),u.preventDefault||n.Util.hint(n.Message.getMessage(n.Message.JUSTEP231106))),delete t._newPassword):(u={source:t,values:r,password:r.join(""),preventDefault:!1,clear:!0},t.fireEvent("onPasswordFirstSuccess",u),u.clear&&t.clear(),u.preventDefault||(t._newPassword=r,n.Util.hint(n.Message.getMessage(n.Message.JUSTEP231107))))),r=[],i=!1},this.$domNode.on(u,t._endHandler)},_draw:function(e,t){var n=this.lineColor,r=this.pointColor;try{t?(this.lineColor=this.SuccessLineColor,this.pointColor=this.SuccessPointColor):(this.lineColor=this.ErrorLineColor,this.pointColor=this.ErrorPointColor),this.draw(e)}finally{this.lineColor=n,this.pointColor=r}},_compPassword:function(e,n){if(!t.isArray(e)&&!t.isArray(n))return!1;var r=e.length===n.length;if(r)for(var i=0;i<e.length;i++)if(e[i]!=n[i]){r=!1;break}return r},clear:function(){this.ctx&&(this.ctx.clearRect(0,0,this.CW,this.CH),this.draw())},propertyChangedHandler:function(e,n,r){this.callParent(e,n,r),this.__locker_inited&&"R"==e&&(this.R*=this.times),"password"==e&&("string"==typeof r?this.password=r.split(""):t.isArray(r)?this.password=r:this.password=[])}});return n.Component.addOperations(f,{clear:{label:n.Message.getMessage(n.Message.JUSTEP231144),argsDef:[],method:function(e){return this.owner.clear()}},setMode:{label:n.Message.getMessage(n.Message.JUSTEP231145),argsDef:[{name:"mode",displayName:n.Message.getMessage(n.Message.JUSTEP231146),required:!0}],method:function(e){return this.owner.set("mode",e.mode||a.normal)}},setPassword:{label:n.Message.getMessage(n.Message.JUSTEP231147),argsDef:[{name:"password",displayName:n.Message.getMessage(n.Message.JUSTEP231148),required:!0}],method:function(e){var t=e.password;return this.owner.set("password",t)}}}),f.Modes=a,n.Component.register(r,f),f}),define("$model/UI2/system/components/justep/menu/menu.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/menu/menu",["require","$UI/system/components/justep/common/res","css!./css/menu","$UI/system/lib/justep","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent","jquery","$UI/system/components/justep/button/button","./menu.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/menu").load();var t=e("$UI/system/lib/justep"),n=e("$UI/system/lib/base/component"),r=e("$UI/system/lib/base/viewComponent"),i=e("jquery"),s=e.normalizeName("./menu"),o=e("$UI/system/components/justep/button/button"),u=e("./menu.config"),a=r.extend({baseCls:"x-menu",constructor:function(e){this.callParent(e)},getConfig:function(){return u},buildTemplate:function(e){var t=i('<ul component="'+s+'" class="'+(e["class"]||"x-menu dropdown-menu")+'"></ul>');return e.xid&&t.attr("xid",e.xid),t},init:function(e,t){this.callParent(e,t),this.$el=i(this.domNode)},addItem:function(e){e=e||{};var n=i('<li class="x-menu-item"></li>')[0];return t.Component.addNode(this.domNode,n),t.Util.apply(e,{parentNode:n,"class":"btn btn-link"}),new o(e)},removeItem:function(e){var n=this.$domNode.children("li:eq("+e+")");n.length>0&&t.Component.removeNode(n[0])},itemSize:function(){return this.$domNode.children("li").length},clear:function(){this.$domNode.children("li").each(function(){t.Component.removeNode(this)})},addDivider:function(){i('<li class="x-menu-divider divider"></li>').appendTo(this.$el)}});return n.register(s,a),a}),define("$model/UI2/system/components/justep/popMenu/popMenu.config",["require"],function(e){return{properties:{position:"string",anchor:"string",direction:"string",opacity:"number",dismissible:"boolean",autoHidable:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/popMenu/popMenu",["require","$UI/system/components/justep/common/res","css!./css/popMenu","$UI/system/lib/base/component","../popOver/popOver","./popMenu.config","$UI/system/components/justep/menu/menu"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/popMenu").load();var t=e("$UI/system/lib/base/component"),n=e("../popOver/popOver"),r=e.normalizeName("./popMenu"),i=e("./popMenu.config"),s=e("$UI/system/components/justep/menu/menu"),o=n.extend({baseCls:"x-popMenu",overlayCls:"x-popMenu-overlay",contentCls:"x-popMenu-content",autoHidable:!0,constructor:function(){this.callParent()},getConfig:function(){return i},buildTemplate:function(e){var t=$('<div component="'+r+'" class="'+(e["class"]||this.baseCls)+'">'+'<div class="'+this.overlayCls+'"/>'+"</div>");return e.xid&&t.attr("xid",e.xid),new s({parentNode:t[0],"class":"x-menu dropdown-menu "+this.contentCls}),t},init:function(e,t){this.callParent(e,t);var n=this;this.$content.click(function(){n.autoHidable&&n.hide()})},getInnerMenu:function(){return this.getModel().comp(this.$domNode.children("ul."+this.contentCls)[0])},propertyChangedHandler:function(e,t,n){switch(e){default:}this.callParent(e,t,n)}});return t.register(r,o),o}),define("$model/UI2/system/components/justep/wing/child.config",["require"],function(e){return{properties:{width:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/wing/child",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./child.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./child"),s=e("./child.config"),o=r.extend({constructor:function(e){this.callParent(e)},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.name=this._getName(),this.owner[this.name]=this,this.callParent(e,n)},getConfig:function(){return s},_getName:function(){var e=this.$domNode.attr("class");if(e.indexOf("x-wing-left")!=-1)return"left";if(e.indexOf("x-wing-right")!=-1)return"right";if(e.indexOf("x-wing-content")!=-1)return"content"},get:function(e){e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){this[e]=t;if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.name,t)},onAfterSelect:function(){this.owner.show(this.name)},dispose:function(){this.owner.remove(this.name),this.owner=null,this.callParent()}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/wing/wing.config",["require"],function(e){return{properties:{routable:"boolean",animate:"boolean",display:"string",dismissible:"boolean",swipeClose:"boolean",useLeft:"boolean",useRight:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/wing/wing",["require","$UI/system/lib/jquery/transition","$UI/system/lib/base/layerManager","$UI/system/lib/base/component","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./wing.config","$UI/system/components/justep/windowContainer/windowContainer","$UI/system/lib/jquery/transition","css!./css/wing"],function(e){e("$UI/system/lib/jquery/transition");var t=e("$UI/system/lib/base/layerManager"),n=e("$UI/system/lib/base/component"),r=e("$UI/system/lib/justep"),i=e("$UI/system/lib/base/string"),s=e("$UI/system/lib/base/viewComponent"),o=e("jquery"),u=e.normalizeName("./wing"),a=e("./wing.config"),f=e("$UI/system/components/justep/windowContainer/windowContainer");e("$UI/system/lib/jquery/transition"),e("css!./css/wing").load();var l="300",c=s.extend({constructor:function(e){this.baseCls="x-wing",this.animate=!0,this.display="overlay",this.onlyOne=this.display!="overlay",this.dismissible=!1,this.swipeClose=!0,this.leftOpened=!1,this.rightOpened=!1,this.routable=!1,this.leftWidth=l,this.rightWidth=l,this.useLeft=!0,this.useRight=!0,this.callParent(e)},getConfig:function(){return a},buildTemplate:function(e){e.content=e.content||{},e.left=e.left||{},e.left.size=e.left.size!==undefined?e.left.size:l,e.right=e.right||{},e.right.size=e.right.size!==undefined?e.right.size:l,e.routable&&(this.routable=e.routable),e.animate&&(this.animate=e.animate),e.display&&(this.display=e.display),e.dismissible&&(this.dismissible=e.dismissible),e.swipeClose&&(this.swipeClose=e.swipeClose);var t=e.style||"";return i.format("<div xid='{0}' class='{1}' component='{2}' style='{3}'><div class='x-wing-left' width='{4}'></div><div class='x-wing-content'></div><div class='x-wing-right' width='{5}'></div></div>",e.xid,this.baseCls,u,t,e.left.size,e.right.size)},init:function(e,t){this.callParent(e,t),this.$el=o(this.domNode),o(this.domNode).hasClass("x-wing-xs")&&(l="200",this.leftWidth=l,this.rightWidth=l),this.$left=o(">.x-wing-left",this.domNode),this.$content=o(">.x-wing-content",this.domNode),this.$right=o(">.x-wing-right",this.domNode);var n=this;return this.getModel().componentPromise(this.$content[0]).done(function(e){n.inited()}).fail(function(e){alert(e)}),this.animate&&(this.supportTouchSwip(),this.supportTouchSwipHide()),this.$backdrop=this.display!=="compress"?o(">.x-wing-content>.x-wing-backdrop",this.domNode):o(">.x-wing-content>.x-wing-backdrop-none"),this.$backdrop.on("click",function(){if(n.leftOpened||n.rightOpened)n.hideRight(),n.hideLeft()}),{dependence:!0}},addRouteItem:function(e,n){e==="show"?n=="content"?t.addLayerIndex(this.$content.get(0)):n=="left"?t.addLayerIndex(this.$left.get(0)):n=="right"&&t.addLayerIndex(this.$right.get(0)):e==="hide"&&(n=="left"?t.removeLayerIndex(this.$left.get(0)):n=="right"?t.removeLayerIndex(this.$right.get(0)):n=="content"&&t.removeLayerIndex(this.$content.get(0)));if(!this.routable)return;var r=o(this.domNode).attr("xid"),i=this.getModel().$routeState;e==="show"?n=="content"?(i.removeState(r,"left",""),i.removeState(r,"right",""),t.addLayerIndex(this.$content.get(0))):(i.addState(r,n,""),n=="left"?t.addLayerIndex(this.$left.get(0)):n=="right"&&t.addLayerIndex(this.$right.get(0))):e==="hide"&&(i.removeState(r,n),n=="left"?t.removeLayerIndex(this.$left.get(0)):n=="right"?t.removeLayerIndex(this.$right.get(0)):n=="content"&&t.removeLayerIndex(this.$content.get(0)))},publishRouteItem:function(){if(!this.routable)return;var e=this.getModel().$routeState;e.publishState()},doRoute:function(e,t,n){if(!this.routable)return;n=="enter"?e==="left"?this.showLeft():e==="right"&&this.showRight():n=="leave"&&(e==="left"?this.hideLeft():e==="right"&&this.hideRight())},supportTouchSwip:function(){var e=this.$content.width(),t=!1,n=!1,r=!1,i={},s,u,a,f,c,h=this,p,d=!1,v=o("html").hasClass("androidBrowser");this.$content.on("touchstart",function(e){if(!h.animate)return;if(t||h.rightOpened||h.leftOpened)return;e instanceof o.Event&&(e=e.originalEvent),r=!0,n=!1,t=!0,d=!1,s=undefined,i.x=e.type==="touchstart"?e.targetTouches[0].pageX:e.pageX,i.y=e.type==="touchstart"?e.targetTouches[0].pageY:e.pageY,a=(new Date).getTime(),/Android /.test(window.navigator.appVersion)&&!/Chrome\/\d/.test(window.navigator.appVersion)&&(h.$left.hide(),h.$right.hide(),h.$content.hide(),h.$left.css("display",""),h.$content.css("display",""),h.$right.css("display",""))}),this.$content.on("touchmove",function(u){if(!h.animate)return;u instanceof o.Event&&(u=u.originalEvent);if(u.target&&"INPUT"==u.target.tagName&&u.target.getAttribute("type")=="range")return;if(u.touches.length>1)return;var a=h.$content.find(".x-scroll-h");a.each(function(e,t){o(t).find(u.target).length>0&&(u.hasStopedPropagation=!0)});if(u.hasStopedPropagation===!0)return;if(!t||h.rightOpened||h.leftOpened||s)return;var l=u.type==="touchmove"?u.targetTouches[0].pageX:u.pageX,v=u.type==="touchmove"?u.targetTouches[0].pageY:u.pageY;f=Math.abs(l-i.x),c=Math.abs(v-i.y);if(r&&f>c){r=!1,n=!0,l-i.x>0?p="right":p="left";if(p=="right"&&!h.useLeft)return;if(p=="left"&&!h.useRight)return;s=!1,p==="right"?d=i.x-h.$content.offset().left<e:p==="left"&&(d=h.$content.width()-i.x<e);if(!d){n=!1,s=!0;return}u.preventDefault(),u.hasStopedPropagation=!0}else if(r){r=!1,n=!1,s=!0;return}if(!d||!!s)return;u.preventDefault(),u.hasStopedPropagation=!0;var m=0;p==="right"?m=f/h.leftWidth:p==="left"&&(m=f/h.rightWidth);switch(h.display){case"overlay":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),f>h.leftWidth?h.$left.transform("translate3d(0,0,0)"):h.$left.transform("translate3d("+(h.leftWidth*-1+f)+"px,0,0)")):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),f>h.rightWidth?h.$right.transform("translate3d(0,0,0)"):h.$right.transform("translate3d("+(h.rightWidth-f)+"px,0,0)"));break;case"reveal":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),f>h.leftWidth?h.$content.transform("translate3d("+h.leftWidth+"px,0,0)"):h.$content.transform("translate3d("+f+"px,0,0)")):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),f>h.rightWidth?h.$content.transform("translate3d("+h.rightWidth*-1+"px,0,0)"):h.$content.transform("translate3d("+f*-1+"px,0,0)"));break;case"push":p=="right"&&h.$left.length>0?f>h.leftWidth?(h.$content.transform("translate3d("+h.leftWidth+"px,0,0)"),h.$left.transform("translate3d(0,0,0)")):(h.$content.transform("translate3d("+f+"px,0,0)"),h.$left.transform("translate3d("+(h.leftWidth*-1+f)+"px,0,0)")):p=="left"&&h.$right.length>0&&(f>h.rightWidth?(h.$content.transform("translate3d("+h.rightWidth*-1+"px,0,0)"),h.$right.transform("translate3d(0,0,0)")):(h.$content.transform("translate3d("+f*-1+"px,0,0)"),h.$right.transform("translate3d("+(h.rightWidth-f)+"px,0,0)")))}(p=="right"&&h.$left.length>0||p=="left"&&h.$right.length>0)&&h.$backdrop.show()}),this.$content.on("touchcancel touchend",function(e){if(!h.animate)return;if(!t||!n){d=!1,t=!1,n=!1;return}t=!1,n=!1;if(f===0){h.$left.removeClass("active"),h.$right.removeClass("active"),h.$content.transform(""),h.addRouteItem("show","content"),h.publishRouteItem();return}var r=(new Date).getTime()-a;if((r<300&&f>30||r>=300&&f>l/2)&&d){switch(h.display){case"overlay":p=="right"&&h.$left.length>0?(h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem());break;case"reveal":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),h.$content.addClass("on-right"),h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),h.$content.addClass("on-left"),h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem());break;case"push":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),h.$content.addClass("on-right"),h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),h.$content.addClass("on-left"),h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem())}h.$content.transitionEnd(function(){h.$content.transition(0),h.$left.transition(0),h.$right.transition(0)});var i=f/r,s=(l-f)/i;if(f<30||s<100&&f>30)s=200;h.$content.transition(s),h.$left.transition(s),h.$right.transition(s),h.$content.transform(""),h.$left.transform(""),h.$right.transform(""),(p=="right"&&h.$left.length>0||p=="left"&&h.$right.length>0)&&h.$backdrop.show()}else h.$backdrop.hide(),h.$left.removeClass("active"),h.$right.removeClass("active"),h.$content.transform(""),h.$left.transform(""),h.$right.transform(""),h.addRouteItem("show","content"),h.publishRouteItem()})},supportTouchSwipHide:function(){var e=this.$el.width(),t=!1,n=!1,r=!1,i={},s,u,a,f,c,h=this,p;this.$el.on("touchstart",function(e){if(!h.animate)return;if(t||!h.rightOpened&&!h.leftOpened)return;e instanceof o.Event&&(e=e.originalEvent),r=!0,n=!1,t=!0,s=undefined,i.x=e.type==="touchstart"?e.targetTouches[0].pageX:e.pageX,i.y=e.type==="touchstart"?e.targetTouches[0].pageY:e.pageY,a=(new Date).getTime()}),this.$el.on("touchmove",function(e){if(!h.animate)return;e instanceof o.Event&&(e=e.originalEvent);if(e.hasStopedPropagation===!0)return;if(!t||s||!h.rightOpened&&!h.leftOpened)return;var u=e.type==="touchmove"?e.targetTouches[0].pageX:e.pageX,a=e.type==="touchmove"?e.targetTouches[0].pageY:e.pageY;f=Math.abs(u-i.x),c=Math.abs(a-i.y);if(r&&f>c)r=!1,n=!0,u-i.x>0?p="right":p="left",s=!1,e.preventDefault(),e.hasStopedPropagation=!0;else if(r){r=!1,n=!1,s=!0;return}if(!!s)return;e.preventDefault(),e.hasStopedPropagation=!0;var l=0;p==="right"?l=f/h.leftWidth:p==="left"&&(l=f/h.rightWidth);switch(h.display){case"overlay":p=="right"&&h.rightOpened?f>h.rightWidth?h.$right.transform("translate3d("+h.rightWidth+"px,0,0)"):h.$right.transform("translate3d("+f+"px,0,0)"):p=="left"&&h.leftOpened&&(f>h.leftWidth?h.$left.transform("translate3d("+h.leftWidth*-1+"px,0,0)"):h.$left.transform("translate3d("+f*-1+"px,0,0)"));break;case"reveal":p=="right"&&h.rightOpened?f>h.rightWidth?h.$content.transform("translate3d(0,0,0)"):h.$content.transform("translate3d("+(h.rightWidth*-1+f)+"px,0,0)"):p=="left"&&h.$right.length>0&&(f>h.leftWidth?h.$content.transform("translate3d(0,0,0)"):h.$content.transform("translate3d("+(h.rightWidth-f)+"px,0,0)"));break;case"push":p=="right"&&h.rightOpened?f>h.rightWidth?(h.$content.transform("translate3d(0,0,0)"),h.$right.transform("translate3d("+h.rightWidth+"px,0,0)")):(h.$content.transform("translate3d("+(h.rightWidth*-1+f)+"px,0,0)"),h.$right.transform("translate3d("+f+"px,0,0)")):p=="left"&&h.leftOpened&&(f>h.leftWidth?(h.$content.transform("translate3d(0,0,0)"),h.$left.transform("translate3d("+h.leftWidth*-1+"px,0,0)")):(h.$content.transform("translate3d("+(h.leftWidth-f)+"px,0,0)"),h.$left.transform("translate3d("+f*-1+"px,0,0)")))}}),this.$el.on("touchcancel touchend",function(e){if(!h.animate)return;if(!t||!n){t=!1,n=!1;return}t=!1,n=!1;if(f===0)return;var r=(new Date).getTime()-a;r<300&&f>30||r>=300&&f>l/2?(p=="right"&&h.rightOpened?(h.$right.removeClass("active"),h.$content.removeClass("on-left"),h.rightOpened=!1,h.addRouteItem("show","right"),h.publishRouteItem()):p=="left"&&h.leftOpened&&(h.$left.removeClass("active"),h.$content.removeClass("on-right"),h.leftOpened=!1,h.addRouteItem("show","left"),h.publishRouteItem()),h.$backdrop.fadeOut(),h.$content.transform(""),h.$left.transform(""),h.$right.transform("")):(h.$content.transform(""),h.$left.transform(""),h.$right.transform(""))})},setSize:function(e,t){o(">.x-wing-"+e,this.$domNode).css("width",t)},getSize:function(e){return o(">.x-wing-"+e,this.$domNode).css("width")},showLeft:function(e){if(this.useLeft=="false"||!this.useLeft)return;if(this.leftOpened)return;var t=o.support.transition&&!r.Browser.IE;if(this.onlyOne&&this.rightOpened)this.hideRight(this.showLeft);else switch(this.display){case"overlay":var n=this;this.$left.addClass("opening"),this.$backdrop.fadeIn();var i=function(){n.$left.addClass("active"),n.$left.removeClass("opening"),n.leftOpened=!0,n.addRouteItem("show","left"),n.publishRouteItem(),e&&e.call(n)};t?this.$left.animationEnd(i):i();break;case"reveal":var n=this;this.$content.addClass("to-right"),this.$left.addClass("active"),this.$backdrop.fadeIn(),this.$content.animationEnd(function(){n.$content.addClass("on-right"),n.$content.removeClass("to-right"),n.leftOpened=!0,n.addRouteItem("show","left"),n.publishRouteItem(),e&&e.call(n)});break;case"push":var n=this;this.$left.addClass("opening"),this.$left.addClass("active"),this.$content.addClass("to-right"),this.$backdrop.fadeIn(),this.$left.animationEnd(function(){n.$content.addClass("on-right"),n.$content.removeClass("to-right"),n.$left.removeClass("opening"),n.leftOpened=!0,n.addRouteItem("show","left"),n.publishRouteItem(),e&&e.call(n)});break;case"compress":var n=this;this.$left.addClass("opening"),this.$left.addClass("active"),this.$content.addClass("compress-to-right"),this.$backdrop.fadeIn(),this.$left.animationEnd(function(){n.$content.addClass("compress-on-right"),n.$content.removeClass("compress-to-right"),n.$left.removeClass("opening"),n.leftOpened=!0,n.addRouteItem("show","left"),n.publishRouteItem(),e&&e.call(n)})}},hideLeft:function(e){if(!this.leftOpened){e&&e.call(this);return}var t=o.support.transition&&!r.Browser.IE;switch(this.display){case"overlay":var n=this;this.$left.addClass("closing"),this.$backdrop.fadeOut();var i=function(){n.$left.removeClass("closing"),n.$left.removeClass("active"),n._androidBugFix(),n.leftOpened=!1,n.addRouteItem("hide","left"),n.publishRouteItem(),e&&e.call(n)};t?this.$left.animationEnd(i):i();break;case"reveal":var n=this;this.$content.addClass("from-right-to-center"),this.$content.removeClass("on-right"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){n.$left.removeClass("active"),n.$content.removeClass("from-right-to-center"),n._androidBugFix(),n.leftOpened=!1,n.addRouteItem("hide","left"),n.publishRouteItem(),e&&e.call(n)});break;case"push":var n=this;this.$content.addClass("from-right-to-center"),this.$content.removeClass("on-right"),this.$left.addClass("closing"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){n.$left.removeClass("closing"),n.$left.removeClass("active"),n.$content.removeClass("from-right-to-center"),n._androidBugFix(),n.leftOpened=!1,n.addRouteItem("hide","left"),n.publishRouteItem(),e&&e.call(n)});break;case"compress":var n=this;this.$content.addClass("uncompress-from-left"),this.$content.removeClass("compress-on-right"),this.$left.addClass("closing"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){n.$left.removeClass("closing"),n.$left.removeClass("active"),n.$content.removeClass("uncompress-from-left"),n._androidBugFix(),n.leftOpened=!1,n.addRouteItem("hide","left"),n.publishRouteItem(),e&&e.call(n)})}},_androidBugFix:function(){/Android /.test(window.navigator.appVersion)&&(this.$el.get(0).style.overflow="auto",this.$el.offset(),this.$el.get(0).style.overflow="hidden")},toggleLeft:function(){this.leftOpened?this.hideLeft():this.showLeft()},showRight:function(e){if(this.useRight=="false"||!this.useRight)return;if(this.rightOpened)return;var t=o.support.transition&&!r.Browser.IE;if(this.onlyOne&&this.leftOpened)this.hideLeft(this.showRight);else{var n=this;switch(this.display){case"overlay":var n=this;this.$right.addClass("opening"),this.$backdrop.fadeIn();var i=function(){n.$right.addClass("active"),n.$right.removeClass("opening"),n.rightOpened=!0,n.addRouteItem("show","right"),n.publishRouteItem(),e&&e.call(n)};t?this.$right.animationEnd(i):i();break;case"reveal":var n=this;this.$content.addClass("to-left"),this.$right.addClass("active"),this.$backdrop.fadeIn(),this.$content.animationEnd(function(){n.$content.removeClass("to-left"),n.$content.addClass("on-left"),n.rightOpened=!0,n.addRouteItem("show","right"),n.publishRouteItem(),e&&e.call(n)});break;case"push":var n=this;this.$right.addClass("opening"),this.$right.addClass("active"),this.$content.addClass("to-left"),this.$backdrop.fadeIn(),this.$right.animationEnd(function(){n.$content.removeClass("to-left"),n.$content.addClass("on-left"),n.$right.removeClass("opening"),n.rightOpened=!0,n.addRouteItem("show","right"),n.publishRouteItem(),e&&e.call(n)})}}},hideRight:function(e){if(!this.rightOpened){e&&e.call(this);return}var t=o.support.transition&&!r.Browser.IE,n=this;this.rightOpened=!1;switch(this.display){case"overlay":var n=this;this.$right.addClass("closing"),this.$backdrop.fadeOut();var i=function(){n.$right.removeClass("closing"),n.$right.removeClass("active"),n._androidBugFix(),n.addRouteItem("hide","right"),n.publishRouteItem(),e&&e.call(n)};t?this.$right.animationEnd(i):i();break;case"reveal":var n=this;this.$content.addClass("from-left-to-center"),this.$content.removeClass("on-left"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){n.$right.removeClass("active"),n.$content.removeClass("from-left-to-center"),n._androidBugFix(),n.addRouteItem("hide","right"),n.publishRouteItem(),e&&e.call(n)});break;case"push":var n=this;this.$right.addClass("closing"),this.$content.addClass("from-left-to-center"),this.$content.removeClass("on-left"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){n.$content.removeClass("from-left-to-center"),n.$right.removeClass("closing"),n.$right.removeClass("active"),n._androidBugFix(),n.addRouteItem("hide","right"),n.publishRouteItem(),e&&e.call(n)})}},toggleRight:function(){this.rightOpened?this.hideRight():this.showRight()},get:function(e){return this[e]},remove:function(e){o(".x-wing-"+e,this.$el).remove()},show:function(e){switch(e){case"content":this.leftOpened&&this.hideLeft(),this.rightOpened&&this.hideRight();break;case"left":this.leftOpened||this.showLeft();break;case"right":this.rightOpened||this.showRight()}},hide:function(e){switch(e){case"left":this.leftOpened&&this.hideLeft();break;case"right":this.rightOpened&&this.hideRight()}},setDisplay:function(e){this.display=e,o(this.domNode).attr("display",e),this.onlyOne=this.display!="overlay",this.display=="reveal"},setDismissible:function(e){return;var t},propertyChangedHandler:function(e,t,n){switch(e){case"display":this.setDisplay(n);break;case"dismissible":this.setDismissible(n);break;default:this.callParent(e,t,n)}},loadLeftContent:function(e){this.leftCompose=new f({parentNode:this.$left.get(0),src:e})},removeLeftContent:function(){r.Component.removeComponent(this.leftCompose)}});return r.Component.addOperations(c,{toggleLeft:{label:"",method:function(e){return this.owner.toggleLeft()}},toggleRight:{label:"",method:function(e){return this.owner.toggleRight()}}}),n.register(u,c),c}),define("$model/UI2/system/components/justep/barcode/barcodeImage",["require","$UI/system/lib/justep","$UI/system/lib/base/url","css!./css/barcodeImage"],function(e){var t=e("$UI/system/lib/justep"),n=e.normalizeName("$UI/system/components/justep/barcode/barcodeImage"),r=e("$UI/system/lib/base/url");e("css!./css/barcodeImage").load();var i=t.BindComponent.extend({constructor:function(e){this.callParent(e),this.value="",this.type="code93",this.barcodeConfig="{mw:0.6}",this.stretch=!0},buildTemplate:function(e){return e||(e={}),this.set(e),"string"==typeof e["bind-ref"]&&(e["bind-ref"]=e["bind-ref"].replace(/'/g,"&apos;")),e["class"]||(e["class"]="barcodeImage"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+(e.type?" type='"+e.type+"' ":"")+(e.stretch?" stretch='"+e.stretch+"' ":"")+(e.barcodeConfig?" barcodeConfig='"+e.barcodeConfig+"' ":"")+(e["bind-ref"]?" __componentAttrs='ref:"+e["bind-ref"]+"'":"")+" component='"+n+"' "+" >"+"<img id='img"+e.xid+"' src='about:blank' style='vertical-align:middle;'/> "+"</div>"},onRefresh:function(){if(!this.value||this.value===""){this.clear();return}var t=this.$domNode.attr("type")?this.$domNode.attr("type"):"{}",n=this.$domNode.attr("barcodeConfig")?this.$domNode.attr("barcodeConfig"):"{}",i=new r(e.toUrl("$UI/system/components/justep/barcode/server/genBarcode.j"));i.setParam("type",t),i.setParam("code",this.value),i.setParam("config",n),this.setImgSrc(i.toString()),this.fireEvent("onRefresh",{source:this,url:i.toString()})},getContext:function(){return this.getModel().getContext()},setImgSrc:function(e){var t=this._getImgNode();this.stretch=this.$domNode.attr("stretch")=="false"?!1:this.stretch,this.stretch?(t.css({height:"100%",width:"100%"}),t.attr("src",e)):t.attr("src",e),t.show()},_getImgNode:function(){return this.$domNode.children("img")},clear:function(){this._getImgNode().attr("src","about:blank").hide()},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n),this.needRender=!0},render:function(){this.callParent(),this.onRefresh()}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/uploader/uploader-html5",["require","$UI/system/lib/base/object","$UI/system/lib/base/observable","jquery"],function(e){var t=e("$UI/system/lib/base/object"),n=e("$UI/system/lib/base/observable"),r=e("jquery"),i=t.extend({mixins:n,constructor:function(e,t){var i={name:"userfile",data:{},multiple:!1,autoUpload:!0,states:!0,actionUrl:"",uploadMethod:"post",preSignMode:!1,apikey:"",sendFile:!1,accept:"*/*",requestHeader:{},signRequestEnabled:!1,signHeader:"",defaultSuccessCodes:[200,201]},s=this;r.extend(this,r.extend(i,t)),s.callParent(),n.prototype.constructor.call(s),this.$rootElement=r(e),s.buildTarget(),s.buildLoadingElement(),this.inputElement.addEventListener("change",function(){s.onChanged.apply(s,arguments)}),s.enable=!0,s.changeState("browse")}});return i.prototype.setEnable=function(e){e==0?(this.enable=!1,r(this.formElement).css("visibility","hidden")):e==1&&(this.enable=!0,r(this.formElement).css("visibility","visible"))},i.prototype.addData=function(e){r.extend(this.data,e)},i.prototype.buildTarget=function(){this.$rootElement.css("position")!="absolute"&&this.$rootElement.css({position:"relative"});var e=this.multiple?'multiple="multiple"':"";justep.Browser.isWeChat&&(this.accept="image/*");var t='<form style="position:absolute;top:-3px;right:-3px;bottom:-3px;left:-3px;"><input type="file" '+e+' name="userfile" accept="'+this.accept+'"  tabindex="-1" style="cursor: pointer;opacity:0;position: relative;z-index:999;width:100%;height:100%;overflow:hidden;"></form>',n=r(t).appendTo(this.$rootElement),i=this;n.on("click",function(e){var t={cancel:!1,source:i};i.fireEvent("onFileSelect",t),t.cancel&&e.preventDefault()}),this.inputElement=n.find("input").get(0),this.formElement=n.get(0)},i.prototype.dispose=function(){this.$loadingElement&&this.$loadingElement.remove(),this.inputElement&&(r(this.formElement).remove(),r(this.inputElement).remove()),this.$rootElement&&this.$rootElement.off(".uploader")},i.prototype.buildLoadingElement=function(){var e='<span style="display:none"></span>';this.$loadingElement=r(e).appendTo(this.$rootElement)},i.prototype.submit=function(){var e=this;if(e.currentState=="ready"){var t=this.inputElement.files;r.each(t,function(t,n){n.data={};var i={source:e,file:n,cancel:!1};e.fireEvent("onStart",i);if(e.preSignMode)r.ajax({method:"GET",url:e.actionUrl+"/presignedPutObject",data:{objectName:i.file.data.storeFileName},headers:{apiKey:e.apikey}}).done(function(t){e.actionUrl=t,e.uploadMethod="PUT",e.sendFile=!0;if(i.cancel===!0){e.changeState("browse");return}e.doUpload(i.file)});else{if(i.cancel===!0){e.changeState("browse");return}e.doUpload(i.file)}})}},i.prototype.onChanged=function(e){var t=this;if(e.target.files.length>0){var n={file:e.target.files[0],files:e.target.files,cancel:!1};t.fireEvent("onFileSelected",n),n.cancel==1?t.changeState("browse"):t.changeState("ready")}else t.changeState("browse")},i.prototype.changeState=function(e){var t=this;t.currentState=e;switch(e){case"browse":t.$loadingElement.hide(),t.reset();break;case"ready":t.$loadingElement.hide(),t.autoUpload==1&&(r(t.inputElement).hide(),r(t.formElement).hide(),t.submit());break;case"loading":t.$loadingElement.show()}},i.prototype.parseResponse=function(e){if(e.responseXML)return e.responseXML;try{return JSON.parse(e.response)}catch(t){return e.response}},i.prototype.doUpload=function(e){var t=this;t.changeState("uploading");var n=new XMLHttpRequest;n.upload&&n.upload.addEventListener&&(n.upload.onprogress=function(n){if(n.lengthComputable){var r=n.loaded/n.total*100;t.fireEvent("onProgress",{originalevent:n,file:e,percentComplete:r.toFixed(0)+"%"})}},n.onreadystatechange=function(n){if(this.readyState===4){if(Array.prototype.indexOf.call(t.defaultSuccessCodes,parseInt(this.status))!=-1){var r=t.parseResponse(this);t.fireEvent("onSuccess",{response:r,originalevent:n,data:e.data,file:e},e.name)}else t.fireEvent("onError",{status:this.status,originalevent:n,data:e.data,file:e});t.changeState("browse")}},n.upload.onerror=function(n){t.fireEvent("onError",{status:this.status,statusText:this.statusText,originalevent:n,data:e.data})}),n.open(t.uploadMethod,t.actionUrl),r.each(t.requestHeader,function(e,t){n.setRequestHeader(e,t)}),t.signRequestEnabled==1?t.signRequest(n,function(n){t.getForm(e).then(function(e){n.send(e)})}):t.getForm(e).then(function(e){n.send(e)})},i.prototype.isImage=function(e){var t=/\.([^.]+)$/,n=t.exec(e)?RegExp.$1.toLowerCase():"";return Boolean(n)&&"jpg,jpeg,png,gif,bmp".indexOf(n)>-1},i.prototype.getForm=function(e){var t=this,n=r.Deferred(),i=[];return this.isImage(e.name)&&e.compress!=0&&this.compress&&i.push({name:"compress",params:{width:800,fieldName:t.name}}),this.fireEvent("onPlugin",{plugins:i,file:e,source:this}),this.execPlugins(e,i,n),n.promise().then(function(n){return t._getForm(n,e)})},i.prototype.execPlugins=function(t,n,r){var i=this;if(n.length==0){r.resolve(t);return}var s=n.shift();e([function(){return 0===s.name.indexOf("$UI")?s.name:"./plugins/"+s.name+"/"+s.name+"Plugin"}()],function(e){var o=e.exec.call(e,t,s.params);o=o.then(function(e){n.length>0?i.execPlugins(e,n,r):r.resolve(e)}),o.fail&&(o.catch=o.fail),o.catch(function(e){r.reject(e)})})},i.prototype._getForm=function(e,t){return this.sendFile?e:(formData=new FormData,formData.append(this.name,e,t.name),r.each(this.data,function(e,t){formData.append(e,t)}),t.data&&r.each(t.data,function(e,t){formData.append(e,t)}),formData)},i.prototype.reset=function(){var e=this;r(e.formElement).show(),r(e.inputElement).show(),e.formElement.reset()},i.prototype.signRequest=function(e,t){var n=this,r=n.getSignHeader();n.signProvider(function(n){e.setRequestHeader(r,n),t(e)},function(e){n.fireEvent("onSignProviderError",{msg:"Request signing is failed! "+e})})},i.prototype.dataURItoBlob=function(e){var t;e.split(",")[0].indexOf("base64")>=0?t=atob(e.split(",")[1]):t=unescape(e.split(",")[1]);var n=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length);for(var i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:n})},i.prototype.signProvider=function(e,t){e("default-token")},i}),define("$model/UI2/system/components/justep/loadingBar/loadingBar",["require","jquery","$UI/system/lib/base/object","$UI/system/lib/portal/shell","css!./loadingBar"],function(e){var t=e("jquery"),n=e("$UI/system/lib/base/object"),r=e("$UI/system/lib/portal/shell");e("css!./loadingBar").load();var i=n.extend({constructor:function(){var e=this;t("<div id='x-default-loadingbar' loadingnum = '0' class='waiting'><dt/><dd/></div>").appendTo("body"),t("<div id='x-default-overlay' class='x-default-overlay'></div>").appendTo("body"),this.$loadingBarNode=t("#x-default-loadingbar"),this.$loadingOverlayNode=t("#x-default-overlay"),this.$loadingOverlayNode.on("click",function(){setTimeout(function(){e.$loadingOverlayNode.removeClass("x-default-overlay-open")},100)}),t(document).ajaxStart(function(){e.start()}),t(document).ajaxStop(function(){e.stop()}),t(document).ajaxError(function(){e.stop()}),r.on("onStartLoading",function(t){e.start(t&&t.isWithOverlay)}),r.on("onStopLoading",function(t){e.stop()})},start:function(e){var t=this,n=parseInt(t.$loadingBarNode.attr("loadingnum"));t.$loadingBarNode.attr("loadingnum",n+1),e&&t.$loadingOverlayNode.addClass("x-default-overlay-open"),t.$loadingBarNode.fadeIn(100,function(){n===0&&t.$loadingBarNode.width(40+Math.random()*30+"%")})},stop:function(){var e=this;setTimeout(function(){var t=parseInt(e.$loadingBarNode.attr("loadingnum"));e.$loadingBarNode.attr("loadingnum",t-1),t<=1&&(e.$loadingOverlayNode.removeClass("x-default-overlay-open"),e.$loadingBarNode.width("101%").fadeOut(500,function(){e.$loadingBarNode.width("1%")}))},100)}});return new i}),define("$model/UI2/system/components/justep/printHtml/printHtml.config",["require"],function(e){return{properties:{target:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/printHtml/printHtml",["require","$UI/system/lib/route/router","$UI/system/lib/justep","./printHtml.config"],function(e){var t=e("$UI/system/lib/route/router"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./printHtml"),i=e("./printHtml.config"),s=function(e){e.onmouseover&&(e.onmouseover=null),e.onmouseout&&(e.onmouseout=null),e.onclick&&(e.onclick=null)},o=function(e){var n="location=yes,statusbar=no,directories=no,menubar=no,resizable=yes,scrollbars=yes,titlebar=no,toolbar=no,dependent=no";e&&(e.width&&(n+=",width="+e.width),e.height&&(n+=",height="+e.height),e.screenX&&(n+=",screenX="+e.screenX),e.screenY&&(n+=",screenY="+e.screenY)),t.revertVls();var r=window.open("","_blank",n);if(!r)throw new Error("当前正在打印，请稍候再试！");return r.doc=r.document,r},u=function(e){$(e).find("div.x-richTextarea").each(function(){var e=$(this).css({height:"auto"});e.find("div.edui-toolbar").hide(),e.find("div.edui-body-container").css({height:"auto"})}),$(e).find("table").each(function(){s(this)}),$(e).find("div").each(function(){s(this)}),$(e).find("span").each(function(){s(this)}),$(e).find("div.x-grid").each(function(){a(this)});var t=$(e).find("select");for(var n=0;n<t.length;n++){var r=t[n],i=r.getAttribute("value"),o=$(r).find("option");for(var u=o.length-1;u>=0;u--){var f=o[u];f.value==i?f.setAttribute("selected","true"):$(f).remove()}}},a=function(e){$(e.parentNode).css({height:"auto"}),$("div.x-grid-bdiv",e).css({height:"auto"}).children("div").css({height:"auto"})},f=function(e,t){"string"==typeof t&&(t=[t]);var r="";$(e.getRootNode()).find("style").each(function(){r+=l(this)});for(var i=0;i<t.length;i++){var s=$(e.getElementByXid(t[i])),o=s.find("input");for(var a=0;a<o.length;a++){var f=o[a];f.value!==null&&f.value!==""&&f.setAttribute("value",f.value),(f.type=="radio"||f.type=="checkbox")&&f.checked&&f.setAttribute("checked","true")}var c=s.find("select");for(var a=0;a<c.length;a++){var h=c[a];h.setAttribute("value",h.value)}var p=s.find("textarea");for(a=0;a<p.length;a++){var d=$(p[a]),v=d.val();v!==null&&v!==""&&d.html(v)}if(n.Browser.IE)for(var i=0;i<s.length;i++)r+=s[i].outerHTML;else r+=$("<div></div>").append(s.clone()).html()}var m=document.createElement("div");return $(m).html(r),u(m),r=$(m).html(),$(m).empty().remove(),r},l=function(e){var t=$("<div></div>").append($(e).clone());return t.html()},c=function(e){var t="<head><title>"+e.popTitle+"</title>";return $(document).find("meta").each(function(){t+=l(this)}),$(document).find("link").filter(function(){return $(this).attr("rel").toLowerCase()=="stylesheet"}).each(function(){t+='<link type="text/css" rel="stylesheet" href="'+$(this).attr("href")+'" >'}),t+="</head>",t},h=function(){return $("html",document).attr("class")},p=function(e){return n.Browser.IE&&e?"<OBJECT id=wb height=0 width=0 classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' name=wb></OBJECT>":""},d=function(e,r,i,s){if(!r){n.System.showMessage((new n.Message(n.Message.JUSTEP231072,r)).getMessage());return}var u={closeWin:!0,popTitle:""},a={};$.extend(a,u,s);var l,d=new o(a);l=d.doc,l.open(),l.write("<!DOCTYPE html> <html class='"+h()+"'>"+c(a)+"<body class='x-print-html' "+(n.Browser.IE&&i?"onload='try{window.loaded = true;wb.execWB(7,1);}catch(e){alert(\"ActiveX未能正常加载\");}'":"onload='window.loaded = true;'")+">"+p(i)+f(e,r)+(a.appendHtml||"")+"</body>"+"</html>"),l.close();var v=function(){if(d.loaded){if(!n.Browser.IE||!i)d.focus(),d.print();a.closeWin&&window.setTimeout(function(){d.close()},1),t.ignoreVls()}else window.setTimeout(function(){v()},500)};v()},v=n.ViewComponent.extend({constructor:function(){this.callParent(),this.target="window"},getConfig:function(){return i},buildTemplate:function(e){return null},init:function(e,t){this.callParent(e,t)},print:function(e,t){d(this.getModel(),e||this.target,!1,t)},preview:function(e,t){d(this.getModel(),e||this.target,!0,t)}});return n.Component.addOperations(v,{print:{label:n.Message.getMessage(n.Message.JUSTEP231103),icon:null,method:function(e){return this.owner.print()}},preview:{label:n.Message.getMessage(n.Message.JUSTEP231104),icon:null,method:function(e){return this.owner.preview()}}}),n.Component.register(r,v),v}),define("$model/UI2/system/components/justep/keyNavigator/keyNavigator.config",["require"],function(e){return{properties:{},events:["reachEndUp","reachEndDown","reachEndLeft","reachEndRight"],binds:{}}}),define("$model/UI2/system/components/justep/keyNavigator/keyNavigator",["require","$UI/system/lib/base/component","$UI/system/lib/base/browser","$UI/system/lib/base/viewComponent","jquery","./keyNavigator.config","$UI/system/lib/keyNavigator/keyNavigator","$UI/system/lib/justep"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/browser"),r=e("$UI/system/lib/base/viewComponent"),i=e("jquery"),s=e.normalizeName("./keyNavigator"),o=e("./keyNavigator.config"),u=e("$UI/system/lib/keyNavigator/keyNavigator"),a=e("$UI/system/lib/justep"),f=r.extend({constructor:function(e){this.callParent(e)},getConfig:function(){return o},init:function(e,t){this.callParent(e,t),this.$domNode=i(this.$domNode),this.selector=this.$domNode.attr("selector"),this.keepSourceGroupXids=this.$domNode.attr("keepSourceGroupXids"),this.mergeWeight=parseInt(this.$domNode.attr("mergeWeight")||"1"),this.cavarageWeight=parseInt(this.$domNode.attr("cavarageWeight")||"1"),this.distanceWeight=parseInt(this.$domNode.attr("distanceWeight")||"1"),this.angleWeight=parseInt(this.$domNode.attr("angleWeight")||"1"),u.config({focusableSelector:this.selector,keepSourceGroupXids:this.keepSourceGroupXids,mergeWeight:this.mergeWeight,cavarageWeight:this.cavarageWeight,distanceWeight:this.distanceWeight,angleWeight:this.angleWeight}),this.reachEnd()},reachEnd:function(){var e=this;u.on("reachEnd",function(t){var n=t.from,r=t.direction;r=="down"&&e.fireEvent("reachEndDown",{source:e,from:n,direction:r}),r=="up"&&e.fireEvent("reachEndup",{source:e,from:n,direction:r}),r=="left"&&e.fireEvent("reachEndLeft",{source:e,from:n,direction:r}),r=="right"&&e.fireEvent("reachEndRight",{source:e,from:n,direction:r})})}});return a.Component.register(s,f),f}),define("$model/UI2/system/components/justep/swiperView/swiperView.config",["require"],function(e){return{properties:{},events:["reachEnd"],binds:{}}}),define("$model/UI2/system/components/justep/swiperView/swiperView",["require","$UI/system/lib/base/component","$UI/system/lib/base/browser","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","$UI/system/components/justep/swiperView/js/swiper.min","$UI/system/lib/base/observable","css!$UI/system/components/justep/swiperView/css/swiper.min","jquery","./swiperView.config","$UI/system/lib/keyNavigator/keyNavigator","$UI/system/lib/justep"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/browser"),r=e("$UI/system/lib/base/string"),i=e("$UI/system/lib/base/viewComponent");e("$UI/system/components/justep/swiperView/js/swiper.min");var s=e("$UI/system/lib/base/observable");e("css!$UI/system/components/justep/swiperView/css/swiper.min").load();var o=e("jquery"),u=e.normalizeName("./swiperView"),a=e("./swiperView.config"),f=e("$UI/system/lib/keyNavigator/keyNavigator"),l=e("$UI/system/lib/justep"),c=i.extend({mixins:s,constructor:function(e){s.prototype.constructor.call(this),this.callParent(e)},getConfig:function(){return a},buildTemplate:function(e){},init:function(e,t){this.callParent(e,t);var n=this;this.$domNode=o(this.domNode),this.loopTerm=this.$domNode.attr("loopTerm"),this.slidesPerView=this.$domNode.attr("slidesPerView"),this.slidesPerColumn=this.$domNode.attr("slidesPerColumn"),this.pagination=this.$domNode.attr("pagination"),this.spaceBetween=this.$domNode.attr("spaceBetween"),this.paginationType=this.$domNode.attr("paginationType"),this.directionButton=this.$domNode.attr("directionButton"),this.id=this.$domNode.attr("id");if(this.loopTerm){var r=null;r=this.$domNode.find("[xid="+this.loopTerm+"]").length>0?this.$domNode.find("[xid="+this.loopTerm+"]"):this.$domNode.find("."+this.loopTerm+" ");if(!(r.length>0))throw new Error("错误：SwiperView组件没有找到必要的循环项");r.addClass("swiper-slide"),r.parent().addClass("swiper-wrapper"),r.parent().parent().addClass("swiper-container")}var i=this.$domNode.find(".swiper-container");i.length==0&&(i=this.$domNode),this.pagination=="true"&&i.append('<div class="swiper-pagination"></div>'),this.directionButton=="true"&&i.append('<div class="swiper-button-prev x-focusable"></div><div class="swiper-button-next x-focusable"></div>'),this.autoLayout&&this.$domNode.find(selector),this.$domNode.on("afterRenderList",function(){n.renderTimmer&&clearTimeout(n.renderTimmer),n.renderTimmer=setTimeout(function(){n.initSwiper()},100)}),this.initSwiper(),this.initEvent()},initSwiper:function(){var e="#"+this.id+" .swiper-container";o(e).length==0&&(e="#"+this.id+""),this.swiper=new Swiper(e,{pagination:""+e+" .swiper-pagination",slidesPerView:parseInt(this.slidesPerView),slidesPerColumnFill:"row",slidesPerColumn:parseInt(this.slidesPerColumn),spaceBetween:parseInt(this.spaceBetween),prevButton:""+e+" .swiper-button-prev",nextButton:""+e+" .swiper-button-next"})},initEvent:function(){var e=this;n.isTV&&f.on("reachEnd",function(t){var n=t.from,r=t.to,i=t.direction,s=parseInt(e.slidesPerView)+(r?1:0);if(e.$domNode.find(n).length>0)if(i=="right"){e.swiper.isEnd&&e.fireEvent("reachEnd",{source:e,from:n,to:r,direction:i});for(var o=1;o<s;o++)e.swiper.slideNext()}else if(i=="left"){e.swiper.isBeginning&&e.fireEvent("reachEnd",{source:e,from:n,to:r,direction:i});for(var o=1;o<s;o++)e.swiper.slidePrev()}})}});return l.Component.register(u,c),c}),define("$model/UI2/system/components/justep/user/user.config",["require"],function(e){return{properties:{appPath:"string",data:"string",tplcs:"string",autoLogin:"boolean",logoutAfterToLogin:"boolean",useOtherLogin:"boolean",loginSuccessHint:"boolean"},events:["onLogin","onLogout","onRegister"],binds:{}}}),define("$model/UI2/system/components/justep/user/js/uaa",["require","jquery","$UI/system/lib/justep"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r="/uaa",i="",s="/sms",o=!1,u=null,a={},f=".ogn",l="justep.ogn.root",c="root",h=function(e){var n=["uaa.offline_token","approvals.me","user_attributes","cloud_controller.read","roles","oauth.approvals","cloud_controller_service_permissions.read","scim.me","openid","uaa.user","profile","cloud_controller.write","password.write","scim.userids","scim.read","acme","acme.dev",l],r=[],i=[],s={names:r,objs:i};return t.each(e,function(e,t){var s=t.display;n.indexOf(s)<0&&(t.name=decodeURI(s),r.push(t.name),i.push(t))}),s},p=function(e){var t={};return t};Date.prototype.pattern=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12===0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},n={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+n[this.getDay()+""]));for(var r in t)(new RegExp("("+r+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e};var d=function(e){e.name=decodeURI(e.name.formatted||e.name.givenName||e.userName),e._emails=e.emails,e.email=e.emails&&e.emails[0]&&e.emails[0].value||"";if(t.isArray(e.groups)){e._groups=e.groups;var n=h(e.groups);e.groups=n.names,e.groupObjs=n.objs}e._meta=e.meta,e.createTime=new Date(e.meta.created),e._phoneNumbers=e.phoneNumbers,e.phone=e.phoneNumbers&&e.phoneNumbers[0]&&e.phoneNumbers[0].value||""},v=function(e){var t=e.name||"",n={id:e.id,userName:e.userName,name:{formatted:t,givenName:t},emails:[{value:e.email||"default@mail.com",primary:!0}],phoneNumbers:[e.phone]};return e.active!==undefined&&(n.active=e.active),e.verified!==undefined&&(n.verified=e.verified),e.origin!==undefined&&(n.origin=e.origin),e.externalId!==undefined&&(n.externalId=e.externalId),e.password!==undefined&&(n.password=e.password),e.avatarUrl!==undefined&&(n.avatarUrl=e.avatarUrl),e.description!==undefined&&(n.description=e.description),e.data2&&(n.data2=e.data2),e.data3&&(n.data3=e.data3),e.data4&&(n.data4=e.data4),e.data5&&(n.data5=e.data5),e.data6&&(n.data6=e.data6),e.data7&&(n.data7=e.data7),e.data8&&(n.data8=e.data8),e.data9&&(n.data9=e.data9),e.data10&&(n.data10=e.data10),e.data11&&(n.data11=e.data11),e.data12&&(n.data12=e.data12),e.data13&&(n.data13=e.data13),e.data14&&(n.data14=e.data14),undefined!==e.data15&&(n.data15=e.data15),undefined!==e.data16&&(n.data16=e.data17),e.data17 instanceof Date?n.data17=e.data17.toISOString():e.data17&&(n.data17=e.data17),e.data18 instanceof Date?n.data18=e.data18.toISOString():e.data18&&(n.data18=e.data18),n},m=function(e){e.displayName=decodeURI(e.displayName),e.name=e.displayName,e.createTime=new Date(e.meta.created),e.description=="_user_create_"&&(e.description="")},g=function(e){var t=e.name||"",n={id:e.id,displayName:t,type:e.type||"default"};return e.description&&(n.description=e.description),e.members&&(n.members=e.members),e.data1&&(n.data1=e.data1),e.data2&&(n.data2=e.data2),undefined!==e.data3&&(n.data3=e.data3),e.data4 instanceof Date?n.data4=e.data4.toISOString():e.data4&&(n.data4=e.data4),n},y=function(e){var t={400:"400 请求无效JSON格式或缺少的字段",401:"401 无效的Token",403:"403 没有权限",404:"404 不存在",406:"406 Acceptable",409:"409 已经存在",504:"504 网关请求超时"};return t[e]||e+" 未知错误"},b=function(e,t){var n=t.name.formatted?decodeURI(t.name.formatted||t.name.givenName||t.userName):t.name;return{id:e.id+"@"+t.id,userId:t.id,name:n,code:t.userName,fcode:e.fcode+"/"+t.id,parent:e.id}},w={has:function(e){return e&&!e.startsWith("--")},getCurrentUser:function(){return u},exist:function(e,n){var i=t.Deferred(),s='userName eq "{0}" or emails co "{0}" or phoneNumbers co "{0}"',o={filter:s},u=p();return u.Accept="application/json",t.ajax({method:"GET",url:r+"/ids/Users",dataType:"json",contentType:"application/json",headers:u,data:o}).done(function(e){var r=t.isArray(e.resources)&&e.resources.length>0;if(n&&t.isArray(e.resources)){var s=0;t.each(e.resources,function(e,t){t.id!==n&&s++}),r=s>0}i.resolve(r)}).fail(function(e){i.resolve(!1)}),i.promise()},phoneNumExist:function(e){var n=t.Deferred(),i='phoneNumber eq "'+e+'"',s={filter:i},o=p();return o.Accept="application/json",t.ajax({method:"GET",cache:!1,url:r+"/ids/Users",dataType:"json",contentType:"application/json",headers:o,data:s}).then(function(e){n.resolve(t.isArray(e.resources)&&e.resources.length>0)},function(e){n.reject(e)}),n.promise()},isLogined:function(){return o},sendVerifyCode:function(e,n){var r=p();return r.Accept="application/json",t.ajax({method:"POST",url:s+"/verifyCode",xhrFields:{withCredentials:!0},contentType:"application/json",headers:r,data:JSON.stringify({template:e,phone:n})})},resetPassword:function(e,n,i){var s=p();return s.Accept="application/json",t.ajax({method:"POST",url:r+"/reset_password",xhrFields:{withCredentials:!0},headers:s,data:{code:n,tel:e,password:i}})},oauth2Register:function(e){var n=p();n.Accept="application/json",n.openid=e.openId;var i=v(e);return t.ajax({method:"POST",url:r+"/Users/registerOAuth2User",xhrFields:{withCredentials:!0},dataType:"json",contentType:"application/json",headers:n,data:JSON.stringify(i)})},register:function(e,n){var i=p();i.Accept="application/json",i.code=n,i.tel=e.userName,i.openid=e.openId;var s=v(e);return t.ajax({method:"POST",url:r+"/Users/register",xhrFields:{withCredentials:!0},dataType:"json",contentType:"application/json",headers:i,data:JSON.stringify(s)})},checkLogin:function(){var e=t.Deferred();if(!w.isLogined()){var n=this;t.ajax({method:"GET",url:r+"/userinfo",dataType:"json",cache:!1,xhrFields:{withCredentials:!0}}).done(function(t){t&&t.error?e.reject(t.error):w.getUser(t.user_id).then(function(t){n.loginAfter(t),e.resolve(t)},function(t){e.reject(t)})}).fail(function(t){e.reject(t)})}else e.resolve(u);return e.promise()},login:function(e,n){var r=t.Deferred(),s=this;return t.ajax({method:"POST",url:i+"/login",dataType:"json",xhrFields:{withCredentials:!0},headers:{Accept:"application/json"},data:{username:e,password:n}}).done(function(e){e&&e.error?r.reject(e.error):w.getUser(e.user_id).then(function(e){s.loginAfter(e),r.resolve(e)},function(e){r.reject(e)})}).fail(function(e){r.reject(e)}),r.promise()},loginAfter:function(e){e.user_name=e.userName,o=!0,u=e},checkThirdPartyLoginResult:function(e){e===null?(o=!1,u=null):(console.log("checkThirdPartyLoginResult:"),console.log(e),o=!0,u=e)},logout:function(){var e=t.Deferred();return t.ajax({url:i+"/logout",xhrFields:{withCredentials:!0},dataType:"text",cache:!1}).done(function(t){u=null,o=!1,n.Util.deleteCookie("X-Uaa-JWT","/"),e.resolve(t)}).fail(function(t){e.reject(t)}),e.promise()},changePassword:function(e,n){var i=t.Deferred();return w.isLogined()?x().then(function(s){var o=p(s.access_token);o.Accept="application/json",t.ajax({method:"PUT",xhrFields:{withCredentials:!0},url:r+"/Users/"+u.id+"/password",dataType:"json",contentType:"application/json",headers:o,processData:!1,data:JSON.stringify({oldPassword:e,password:n})}).then(function(e){i.resolve(e)},function(e){i.reject(y(e.status))})},function(){i.reject("token error")}):i.reject({errorCode:"NOT_LOGINED"}),i.promise()},listGroups:function(e){e=e||{},e.filter=(e.filter?e.filter+" and ":"")+"type pr";var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"GET",url:r+"/Groups",dataType:"json",contentType:"application/json",headers:s,data:e}).done(function(e){var r=[];t.isArray(e.resources)&&t.each(e.resources,function(e,t){if(t.type||t.description==="_user_create_")m(t),r.push(t)}),e.resources=r,n.resolve(e)}).fail(function(e){n.reject(y(e.status))})}),n.promise()},getGroups:function(e){var n=t.Deferred();return this.listGroups(e).then(function(e){n.resolve(e.resources)},function(e){n.reject(e)}),n.promise()},getCustomGroups:function(){return this.getGroups({filter:'type eq "default"'})},getUsers:function(e){return this.listUsers(e)},listUsers:function(e){e=e||{};var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"GET",url:r+"/Users",dataType:"json",contentType:"application/json",headers:s,data:e}).done(function(e){t.isArray(e.resources)&&t.each(e.resources,function(e,t){d(t)}),n.resolve(e)}).fail(function(e){n.reject(y(e.status))})}),n.promise()},createUser:function(e){e=v(e);var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"POST",url:r+"/Users",dataType:"json",contentType:"application/json",processData:!1,headers:s,data:JSON.stringify(e)}).then(function(e){d(e),n.resolve(e)},function(e){n.reject(y(e.status))})}),n.promise()},createGroup:function(e){typeof e=="string"&&(e={name:e}),e=g(e);var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"POST",url:r+"/Groups",dataType:"json",contentType:"application/json",processData:!1,headers:s,data:JSON.stringify(e)}).then(function(e){m(e),n.resolve(e)},function(e){n.reject(y(e.status))})}),n.promise()},updateGroup:function(e){var n=e.meta.version;e=g(e);var i=t.Deferred();return x().then(function(s){var o=p(s.access_token);o.Accept="application/json",o["If-Match"]=n,t.ajax({method:"PUT",url:r+"/Groups/"+e.id,dataType:"json",contentType:"application/json",processData:!1,headers:o,data:JSON.stringify(e)}).then(function(e){m(e),i.resolve(e)},function(e){i.reject(y(e.status))})}),i.promise()},updateUser:function(e){var n=e.meta.version;e=v(e);var i=t.Deferred();return x().then(function(s){var o=p(s.access_token);o.Accept="application/json",o["If-Match"]=n,t.ajax({method:"PUT",url:r+"/Users/"+e.id,dataType:"json",contentType:"application/json",processData:!1,headers:o,data:JSON.stringify(e)}).then(function(e){d(e),i.resolve(e)},function(e){i.reject(y(e.status))})}),i.promise()},updateCurrentUserAvatarUrl:function(e){u;var t={};return t.avatarUrl=e,w.updateCurUser(t)},updateCurUser:function(e){var n=t.Deferred();if(w.isLogined()){var r=w.getCurrentUser();r?e?(e.id=r.id,e.meta||(e.meta={}),e.meta.version=r.meta.version,w.updateUser(e).then(function(e){w.loginAfter(e),n.resolve(e)},function(e){n.reject(e)})):n.resolve(r):n.reject("请先登录")}else n.reject("请先登录");return n.promise()},getUser:function(e){var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"GET",url:r+"/Users/"+e,headers:s}).then(function(e){d(e),n.resolve(e)},function(e){n.reject(y(e.status))})}),n.promise()},getGroup:function(e){var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"GET",url:r+"/Groups/"+e,headers:s}).then(function(e){m(e),n.resolve(e)},function(e){n.reject(y(e.status))})}),n.promise()},getUserByName:function(e){var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"GET",url:r+"/ids/Users?filter=userName+eq+%22"+e+"%22",headers:s}).then(function(e){n.resolve(e.resources[0])},function(e){n.reject(y(e.status))})}),n.promise()},deleteGroup:function(e){var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"DELETE",url:r+"/Groups/"+e,headers:s}).then(function(e){n.resolve(e.id)},function(e){n.reject(e)})}),n.promise()},addMember:function(e,n,i){var s={origin:"uaa",type:i||"USER",value:n},o=t.Deferred();return x().then(function(n){var i=p(n.access_token);i.Accept="application/json",t.ajax({method:"POST",url:r+"/Groups/"+e+"/members",dataType:"json",contentType:"application/json",processData:!1,headers:i,data:JSON.stringify(s)}).then(function(e){o.resolve(e)},function(e){o.reject(y(e.status))})}),o.promise()},removeMember:function(e,n){var i=t.Deferred();return x().then(function(s){var o=p(s.access_token);o.Accept="application/json",t.ajax({method:"DELETE",url:r+"/Groups/"+e+"/members/"+n,dataType:"json",contentType:"application/json",processData:!1,headers:o}).then(function(e){i.resolve(e)},function(e){i.reject(y(e.status))})}),i.promise()},listMember:function(e,n,i){i=i||{},i.returnEntities=n?!0:!1;var s=t.Deferred();return x().then(function(o){var u=p(o.access_token);u.Accept="application/json",t.ajax({method:"GET",url:r+"/Groups/"+e+"/members",headers:u,data:i}).then(function(e){if(n)e.resources.length>0&&t.each(e.resources,function(e,t){t.type==="USER"?(d(t.entity),t.name=t.entity.name):t.type==="GROUP"&&(m(t.entity),t.name=t.entity.name)}),s.resolve(e);else{var r=[];e.resources.length>0&&t.each(e.resources,function(e,t){r.push(t.value)}),s.resolve(r)}},function(e){s.reject(y(e.status))})}),s.promise()},deleteUser:function(e){var n=t.Deferred();return x().then(function(i){var s=p(i.access_token);s.Accept="application/json",t.ajax({method:"DELETE",url:r+"/Users/"+e,headers:s}).then(function(e){n.resolve(e)},function(e){n.reject(e)})}),n.promise()},_getGroupRoot:function(e){var n=t.Deferred();if(a[e])n.resolve(a[e]);else{var r=this,i={filter:'displayName eq "'+e+'"'};this.getGroups(i).then(function(i){if(t.isArray(i)&&i.length>0)a[e]=i[0],n.resolve(a[e]);else{var s={type:e,name:e,code:c,fcode:"/"+c};r.createGroup(s).then(function(t){a[e]=s,n.resolve(a[e])},function(e){n.reject(e)})}},function(e){n.reject(e)})}return n.promise()},_createOgn:function(e,n){var r=t.Deferred(),i=this,s=function(){i.createGroup(e).then(function(e){r.resolve(e)},function(e){r.reject(e)})};return n?n.then(function(t){e.parent=t.id,e.fcode=t.fcode+"/"+e.code,s()},function(e){r.reject(e)}):s(),r.promise()},_getOgnsByParent:function(e){var n=t.Deferred(),r={filter:'parent+eq+"'+e+'"'};return this.getGroups(r).then(function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise()},_getOgns:function(e,n){var r=t.Deferred(),i=this,s=function(e){t.when(i._getOgnsByParent(e.id),n?i.listMember(e.id):t({}).promise()).then(function(n,i){n=n||[],t.isArray(i)&&t.each(i).each(function(t){if(t.type==="USER"){var r=t.entity;n.push(b(e,r))}}),r.resolve(n)},function(e){r.reject(e)})};return t.isFunction(e.then)?e.then(function(e){s(e)},function(e){r.reject(e)}):s(e),r.promise()},getOgnRoot:function(){return this._getGroupRoot(l)},cresteOgn:function(e,t){var n=!t||t.name===l,r=(n?"":t.fcode)||"";return e.fcode=r+"/"+e.code,e.type=f,n||(e.parent=t.id),this._createOgn(e,n?this.getOgnRoot():null)},deleteOgn:function(e){return this.deleteGroup(e)},updateOgn:function(e){return this.updateGroup(e)},getOgns:function(e,t){return t=t!==!1,e?this._getOgns(e,t):this._getOgns(this.getOgnRoot(),t)},addUserMember:function(e,n){var r=t.Deferred();return this.addMember(e.id,n.id).then(function(){r.resolve(b(e,n))},function(e){r.reject(e)}),r.promise()},deleteUserMember:function(e){if(e){var n=e.split("@");if(n.legnth>=2)return this.removeMember(n[0],n[1])}return t.Deferred().reject("无效的id").promise()},createOrg:function(e,n,i){var s={displayName:e,description:n,members:[{origin:"uaa",type:"USER",value:i}]},o=t.Deferred();return x().then(function(e){var n=p(e.access_token);n.Accept="application/json",t.ajax({method:"POST",url:r+"/Groups",dataType:"json",contentType:"application/json",processData:!1,headers:n,data:JSON.stringify(s)}).then(function(e){m(e);var t={id:e.id,displayName:e.displayName,discription:e.discription};o.resolve(t)},function(e){o.reject(y(e.status))})}),o.promise()}},E=t.Deferred(),S=function(){E.resolve({})},x=function(){return E.promise()};return S(),w}),define("$model/UI2/system/components/justep/user/user",["require","$UI/system/lib/base/store","$UI/system/lib/justep","$UI/system/components/justep/windowDialog/windowDialog","./js/uaa","./user.config"],function(e){function a(t,r){r=r||"$UI/system/components/justep/user";var i=n.String.format(u[t],r);return e.toUrl(i)}var t=e("$UI/system/lib/base/store"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/windowDialog/windowDialog"),i=e("./js/uaa"),s=e.normalizeName("./user"),o=e("./user.config"),u={login:"{0}/userDialog/login.a",register:"{0}/userDialog/register.a",userInfo:"{0}/userDialog/user.a",changePassword:"{0}/userDialog/changePassword.a",forgetPassword:"{0}/userDialog/forgetPassword.a"},f=[15,52,60,66,12,11,98,35],l=function(e,t){var n="",r=t.length;for(var i=0;i<e.length;i++)n+=String.fromCharCode(e.charCodeAt(i)^t[i%r]);return n},c,h=function(){if(c)return c;var e=t.get("app_loginData");if(e)return e=l(e,f),c=JSON.parse(e),c},p=function(e){e=JSON.stringify(e),t.set("app_loginData",l(e,f)),c=null},d=function(){c=null,t.set("app_loginData",l("{}",f))},v=function(){var e=h();return!e||!e.name||!e.password},m=n.Bind.observable(!1),g=0,y=0,b=n.BindComponent.extend({getDlgUrl:function(e){return a(e,this.getAppPath())},getConfig:function(){return o},constructor:function(e){this.appPath=null,this.autoLogin=!0,this.logoutAfterToLogin=!0,this.useOtherLogin=!1,this.data=null,this.tplcs="",this.loginSuccessHint=!0,this.callParent(e)},dispose:function(){var e=this.getModel();this.isLoginedChangeHandle&&this.isLoginedChangeHandle.dispose(),e&&this.updateUserDataHandle&&e.off("onUpdateUserData",this.updateUserDataHandle),this.callParent()},buildTemplate:function(e){},hint:function(e,t){this.loginSuccessHint&&n.Util.hint(e||"",{type:t||"success"})},doInit:function(e,t,n){this.callParent(e,t,n);var r=this,s=function(e){var t=r.getData();if(t){var n={isLogined:e};e&&($.extend(n,r.getUser()),n.group=n.groups),t.loadData([n]),t.first()}},o=function(e){s(e),e?g>0&&r.fireEvent("onLogin",{source:r}):y>0&&r.fireEvent("onLogout",{source:r})};this.autoLogin&&this.checkThirdPartyLoginResult(),this.isLoginedChangeHandle=m.subscribe(o),m.peek()?o(!0):i.checkLogin().then(function(){r._doLoginAfter()}),this.updateUserDataHandle=function(e){s(e.logined)},this.getModel().on("onUpdateUserData",this.updateUserDataHandle)},doUpdate:function(e,t,n){this.callParent(e,t,n)},getData:function(){if(this.data)return this.getModel().comp(this.data)},getAppPath:function(){var e=this.getConfig();return this.appPath||e.appPath},_createWinDlg:function(e){var t=this.getModel(),n={showTitle:!1,src:e.src,parentNode:t.getRootNode()},i=new r(n);return i},openWindowDialog:function(e){this.dlg||(this.dlg=this._createWinDlg(e)),this.dlg.open(e)},_doLoginAfter:function(){g++,y=0,this.dlg&&this.dlg.close(),m.set(!0)},_doLogoutAfter:function(){y++,g=0,m.set(!1),n.Util.hint("注销成功!",{type:"success"})},_doRegisterAfter:function(){n.Util.hint("注册成功!",{type:"success"}),this.fireEvent("onRegister",{source:this})},thirdPartyLogin:function(e){console.log("thirdPartyLogin("+e+")");var t=$("[xid='tplc_"+e+"']").attr("xid");t||(t=$("span[component='"+n.String.format("$UI/comp/{0}/components/{0}/{0}",e)+"']").attr("xid"));if(t){var r=this.getModel().comp(t);r?r.openAuthUrl(window.location.href):n.Util.hint("找不到名为【"+e+"】的第三方组件!")}else n.Util.hint("找不到名为【"+e+"】的第三方组件!")},checkThirdPartyLoginResult:function(){if(this.useOtherLogin===!0&&this.tplcs!==null&&typeof this.tplcs=="string"&&this.tplcs.length>4){var e=this.tplcs.split(" ")[0],t=$("[xid='tplc_"+e+"']").attr("xid");t||(console.log("Cannot get xid of TPLC!!!!!!"),t=$("span[component='"+n.String.format("$UI/comp/{0}/components/{0}/{0}",e)+"']").attr("xid"),t||(console.log("Use class to find component "+e),t=$("."+e).attr("xid")),console.log(e+"'s xid:"+t));if(t){e=this.getModel().comp(t);if(e){var r=e.getUserInfo();i.checkThirdPartyLoginResult(r),r&&this._doLoginAfter()}else{var s=this;setTimeout(function(){s.checkThirdPartyLoginResult()},1e3)}}}},showLogin:function(e){this.checkThirdPartyLoginResult(),this.isLogined()?this._doLoginAfter():(this.autoLogin||e.autoLogin)&&!v()?this.login(h()):(e=e||{},e.src=this.getDlgUrl("login"),e.data||(e.data={}),e.data.userComp=this,this.openWindowDialog(e))},afterLoginAutoLogin:function(e){this.checkThirdPartyLoginResult(),!this.isLogined()&&!v()&&this.login(h())},showUserInfo:function(e){this.isLogined()?(e=e||{},e.src=this.getDlgUrl("userInfo"),e.data||(e.data={}),e.data.userComp=this,this.openWindowDialog(e)):this.showLogin(e)},showRegister:function(e){e=e||{},e.src=this.getDlgUrl("register"),e.data||(e.data={}),e.data.userComp=this,this.openWindowDialog(e)},showChangePassword:function(e){this.isLogined()?(e=e||{},e.src=this.getDlgUrl("changePassword"),e.data||(e.data={}),e.data.userComp=this,this.openWindowDialog(e)):n.Util.hint("登录后才能修改密码!",{type:"danger"})},login:function(e){var t=this;return i.login(e.name,e.password).then(function(){p(e),t._doLoginAfter(),t.hint("登录成功!")},function(e){JSON.parse(e.responseJSON.message).error_description.indexOf("Your account has been locked because of too many failed attempts to login")!=-1?n.Util.hint("由于多次输入错误，该帐号已被锁定，请半个小时后重试!",{type:"danger"}):n.Util.hint("登录失败,确定用户名密码或者验证码是否正确!",{type:"danger"}),d(),t.showLogin()})},logout:function(){var e=this;return i.logout().then(function(){e._doLogoutAfter(),d(),e.logoutAfterToLogin&&e.showLogin()})},changePassword:function(e,t){return i.changePassword(e,t).then(function(){d(),n.Util.hint("密码修改成功！",{type:"success"})},function(e){n.Util.hint("密码修改失败!",{type:"danger"})})},oauth2Register:function(e){var t=this;return e.active=!0,i.oauth2Register(e).then(function(){i.login(e.userName,e.password).then(function(){p({name:e.userName,password:e.password}),t._doLoginAfter(),console.log("oauth2Register OK")},function(){n.Util.hint("登录失败,确定用户名密码是否正确!",{type:"danger"}),d()})},function(e){n.Util.hint("注册失败！"+e.status,{type:"danger"})})},register:function(e){var t=this;return e.active=!0,i.register(e,e.code).then(function(n){p({name:e.userName,password:e.password||n.password}),t._doRegisterAfter(),t.showLogin({autoLogin:!0})},function(e){var t=e.status==="409";n.Util.hint("注册失败！"+(t?"手机已经被注册":""),{type:"danger"})})},sendVerifyCode:function(e,t){return i.sendVerifyCode(e,t).then(function(){n.Util.hint("发送验证码成功！",{type:"success"})},function(e){n.Util.hint("发送验证码失败！",{type:"danger"})})},resetPassword:function(e,t,r){return i.resetPassword(e,t,r).then(function(){n.Util.hint("重置密码成功！",{type:"success"})},function(e){n.Util.hint("重置密码失败，验证码无效或者新旧密码相同！",{type:"danger"})})},isLogined:function(){return i.isLogined()},getUser:function(){return b.getCurrentUser()},updateCurUser:function(e){var t=this.getModel(),r=$.Deferred();if(this.isLogined()&&b.getCurrentUser()){var s=this;i.updateCurUser(e).then(function(){t&&t.fireEvent("onUpdateUserData",{source:s,logined:!0}),r.resolve()},function(e){n.Util.hint("更新用户信息失败！"+(e||""),{type:"danger"}),r.reject()})}else n.Util.hint("请先登陆再更新用户信息！",{type:"danger"}),r.reject();return r.promise()}});return b.getLoginedObservable=function(){return m},b.getCurrentUser=function(){return i.getCurrentUser()},n.Component.addOperations(b,{login:{label:"",argsDef:[],method:function(e){return this.owner.showLogin()}},afterLoginAutoLogin:{label:"",argsDef:[],method:function(e){return this.owner.afterLoginAutoLogin()}},logout:{label:"",argsDef:[],method:function(e){return this.owner.logout()}},register:{label:"",argsDef:[],method:function(e){return this.owner.showRegister()}},showUser:{label:"",argsDef:[],method:function(e){return this.owner.showUserInfo()}},changePassword:{label:"",argsDef:[],method:function(e){return this.owner.showChangePassword()}},updateCurUser:{label:"",argsDef:[{name:"user",displayName:"用户数据"}],method:function(e){var t={};if($.isArray(e.user)&&e.user.length>0)for(var n=0;n<e.user.length;n++)t[e.user[n].filed]=e.user[n].value;return this.owner.updateCurUser(t)}}}),b.phoneReg=/^[1][0-9][0-9]{9}$/,b.phoneHint="手机号码格式不正确!",b.emailReg=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,b.emailHint="邮箱格式不正确!",b.passwordReg=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9a-zA-Z]{6,16}$/,b.passwordHint="请输入由6-16位字母和数字的组合的密码!",b.bindTimmer=function(t,n,r,i){t.loopSecond=n,t.waittime=n;var s=t;t.mytimer=function(){s.waittime<=0?(s.set({disabled:!1,label:r}),this.waittime=n):(s.set({disabled:!0,label:i+"("+s.waittime+")"}),s.waittime--,setTimeout(function(){s.mytimer()},1e3))}},b.phoneNumExist=function(e){return i.phoneNumExist(e)},n.Component.register(s,b),b}),define("$model/UI2/system/components/justep/user/js/oauth2",["require","jquery"],function(e){var t=e("jquery"),n="",r=function(e,n){var r=t.Deferred();return t.ajax({method:n,url:e}).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()},i=function(e,t){return r(e+"/oauth2-client/weixin-login?referrer_url="+e+"|"+t,"GET")},s=function(e,n){var i=e+"/weixinthird/param/getWXLoginAppid",s="";t.ajax({method:"GET",url:i,async:!1}).done(function(e){s=e.data}).fail(function(e){s=""});var o=t.Deferred();if(s!=""){var u=e+"/oauth2-client/weixin-mp-login?referrer_url="+n;return i=e+"/weixinthird/oauth2/buildComponentAuthorizationUrl?appid="+s+"&state="+escape(u),r(i,"POST")}return o.reject("获取appId失败"),o.promise()},o=function(e,t){return r(e+"/oauth2-client/qq-login?referrer_url="+e+"|"+t,"GET")},u=function(e,t){return r(e+"/oauth2-client/weibo-login?referrer_url="+e+"|"+t,"GET")},a=function(e){var r=t.Deferred();return t.ajax({method:"POST",url:n+"/users",headers:{Accept:"application/json"},data:e}).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()},f=function(e,r){var i=t.Deferred(),s=this;return t.ajax({method:"POST",url:n+"/login",headers:{Accept:"application/json"},data:{username:e,password:r}}).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)}),i.promise()};return{getWeiXinAuthUrl:i,getWeiXinPublicAuthUrl:s,getQQAuthUrl:o,getWeiBoAuthUrl:u,addUserToUaa:a,login:f}}),define("$model/UI2/system/components/justep/request/serviceRequest.config",["require"],function(e){return{properties:{service:"string",serviceUrl:"string",type:"string",async:"boolean",cache:"boolean",dataType:"string",headersExpr:"string",processData:"boolean",timeout:"number",contentType:"string"},events:["onSuccess","onError","onBeforeRequest"],binds:{}}}),define("$model/UI2/system/components/justep/request/serviceRequest",["require","jquery","$UI/system/lib/justep","$UI/system/resources/system.res","./serviceRequest.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep");e("$UI/system/resources/system.res");var r=e.normalizeName("./serviceRequest"),i=e("./serviceRequest.config"),s=n.Express,o=n.BindComponent.extend({constructor:function(e,t){this.callParent(),this.service="",this.serviceUrl="",this.actionUrl="",this.defParams={},this.params={},this.userParams={},this.type="GET",this.async=!0,this.cache=null,this.dataType="json",this.headersExpr="",this.processData=!0,this.timeout=null,this.contentType=null,this._paramExprs={}},getConfig:function(){return i},loadParamsDef:function(){var e=this;t("param",this.$domNode).each(function(){var n=t(this),r=n.attr("name"),i=n.attr("value");r&&i&&(e.params[r]=i)})},doInit:function(e,t){this.callParent(e,t),this.loadParamsDef()},_getParamValue:function(e,t){if(this.userParams.hasOwnProperty(e.name))return this.userParams[e.name];var n=this.params[e.name];if(n){var r=this._paramExprs[n];return r instanceof s||(r=new s(n),this._paramExprs[n]=r),s.eval(r,t.$object,t)}},_processParams:function(e,r){var i={},s=this,o={},u={};t.each(this.defParams,function(t,a){var f=s._getParamValue(a,e);if(f!==null&&f!==undefined)a.kind==="PathVariable"?i[t]=f:a.kind==="RequestHeader"?r.headers[t]=f:a.kind==="RequestParam"?u[t]=f:a.kind==="RequestBody"?o=f:o[t]=f;else if(a.required){var l=new n.Message(n.Message.JUSTEP231151,s.service,t);throw n.Error.create(l)}});var a=this.actionUrl;t.isPlainObject(i)&&!t.isEmptyObject(i)&&a&&t.each(i,function(e,t){a=a.replace("{"+e+"}",t)});if(t.isPlainObject(u)&&!t.isEmptyObject(u)&&a){var f=a.indexOf("?")>=0;a=a+(f?"&":"?")+t.param(u)}return{actionUrl:a,params:o}},_processCfg:function(){var e={type:this.type,async:this.async,dataType:this.dataType,processData:this.processData};this.cache!==null&&(e.cache=this.cache),this.timeout!==null&&(e.timeout=this.timeout),this.contentType!==null&&(e.contentType=this.contentType);var r=n.Bind.contextFor(this.domNode);this.headersExpr?(this._headersExpr instanceof s||(this._headersExpr=new s(this.headersExpr)),e.headers=s.eval(this._headersExpr,r.$object,r)||{}):e.headers={};var i=this._processParams(r,e),o=i.actionUrl;return e.url=this.serviceUrl+(o[0]==="/"?"":"/")+o,e.data=i.params,(e.type||"get").toLowerCase()!=="get"&&"application/json"===e.contentType&&t.isPlainObject(e.data)&&(e.data=JSON.stringify(e.data)),e},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n)},send:function(e){this.set({userParams:e||{}});var n=this._processCfg(),r=this;return n.error=function(e,t,n){r.fireEvent("onError",{source:r,XMLHttpRequest:e,textStatus:t,errorThrown:n})},n.success=function(e,t,n){r.fireEvent("onSuccess",{source:r,data:e,textStatus:t,jqXHR:n})},r.fireEvent("onBeforeRequest",{source:r,options:n}),t.ajax(n)}});return n.Component.addOperations(o,{sendServiceRequest:{label:"发送请求",argsDef:[{name:"params",displayName:"参数"}],method:function(e){return this.owner.send(e.params)}},setParams:{label:"设置请求参数",argsDef:[{name:"params",displayName:"参数"}],method:function(e){return this.owner.set({userParams:e.params||{}})}}}),n.Component.register(r,o),o}),define("$model/UI2/system/components/justep/button/radioPC.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/radioPC",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./radioPC.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./radioPC"),i=e("./radioPC.config"),s=n.BindComponent.extend({_defaultClass:"radio",_type:"radio",getConfig:function(){return i},constructor:function(e){this.callParent(e),this.label=null,this.name=null,this.checkedValue=undefined,this.uncheckedValue=undefined,this.value=null,this.checked=!1,this.on(n.ViewComponent.DATA_CHANGED,function(e){if("ref"==e.name)return;var t={};t[e.name]=e.value,this.set(t)},this)},dispose:function(){this._getInput().off("change",this._clickHandle),this.callParent()},val:function(){if(arguments.length===0)return this.value;this.value=arguments[0],this._getInput().prop("checked",this.checkedValue===undefined?!!this.value:this.checkedValue==this.value).val(this.value)},_buildInput:function(e){var n=t("<input"+(e.name?" name='"+e.name+"'":"")+(e.checked?" checked":"")+" type='"+this._type+"'/>");return undefined!==e.value&&n.attr("value",e.value),n},_buildLabel:function(e){var n=t("<label></label>");n.append(this._buildInput(e));var r=t("<span></span>");return e.label&&r.text(e.label),n.append(r),n},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]=this._defaultClass);var n=t("<div"+(e["class"]?" class='"+e["class"]+"'":"")+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"'>"+"</div>");return n.append(this._buildLabel(e)),n},doInit:function(e,t){var r=this._getInput();this._clickHandle=this._doClick.bind(this),r.on("change",this._clickHandle);var i=this.$domNode.attr("name");i&&r.attr("name",i);if(e&&!e.hasOwnProperty("ref")){var s={};n.Bind.isObservable(e.value)&&(s.value=e.value.get()),n.Bind.isObservable(e.label)&&(s.label=e.label.get()),this.set(s)}},doUpdate:function(e,t){e&&(e.hasOwnProperty("ref")?(this.updateValue(e.ref),this.updateReadonly(e.ref)):this.updateReadonly(e.value))},_doClick:function(e){var t=this._getInput()[0].checked;this.value=this.checkedValue===undefined?t:t?this.checkedValue:this.uncheckedValue!==undefined?this.uncheckedValue:null,this.fireEvent("onChange",{source:this,checked:t,value:this.value}),this.val2ref()},_getInput:function(){return this.$domNode.find("label>input")},_getLabel:function(){return this.$domNode.find("label>span")},get:function(e){return"checked"===e?this._getInput().prop("checked"):this.callParent(e)},disabledRender:function(){this.$domNode&&this._getInput().attr("disabled",this.isDisabled())},propertyChangedHandler:function(e,t,n){switch(e){case"label":t!=n&&this.$domNode&&this._getLabel().text(n);break;case"value":t!=n&&this.$domNode&&this.val(n);break;case"checked":t!=n&&this.$domNode&&this._getInput().prop("checked",n);break;default:this.callParent(e,t,n)}}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/checkboxPC.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/checkboxPC",["require","$UI/system/lib/justep","./radioPC","./checkboxPC.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./radioPC"),r=e.normalizeName("./checkboxPC"),i=e("./checkboxPC.config"),s=n.extend({_defaultClass:"checkbox",_type:"checkbox",getConfig:function(){return i},getDisplayHtml:function(e){return s.getDisplayHtml(e)}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/select/checkboxGroupPC.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/checkboxGroupPC",["require","$UI/system/lib/justep","../button/checkboxPC","./checkboxGroup","./checkboxGroupPC.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("../button/checkboxPC"),r=e("./checkboxGroup"),i=e.normalizeName("./checkboxGroupPC"),s=e("./checkboxGroupPC.config"),o=r.extend({getConfig:function(){return s},constructor:function(e){this.callParent(e)},_buildForeachTemplate:function(e){var t=new n;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="");var t="<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" data-bind='foreach:"+e.itemset+"' "+" component='"+i+"' >"+this._buildForeach(e)+"</div>";return delete e["bind-itemset"],delete e["bind-itemsetValue"],delete e["bind-itemsetLabel"],t}});return t.Component.register(i,o),o}),define("$model/UI2/system/components/justep/select/radioGroupPC.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/radioGroupPC",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","../button/radioPC","./radioGroup","./radioGroupPC.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../button/radioPC"),i=e("./radioGroup"),s=e.normalizeName("./radioGroupPC"),o=e("./radioGroupPC.config"),u=i.extend({getConfig:function(){return o},constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},_buildForeachTemplate:function(e){var t=new r;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="");var r=t("<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+s+"' >"+"</div>");e["bind-itemset"]&&r.attr("data-bind","foreach:{data:"+e["bind-itemset"]+",afterRender:$model.comp($element)['_doUpdate'].bind($model.comp($element))}");var i=this._buildForeachTemplate(e),o="component:{name:'"+i.attr("component")+"'";e["bind-itemsetValue"]&&(o+=",value:"+e["bind-itemsetValue"]),e["bind-itemsetLabel"]&&(o+=",label:"+e["bind-itemsetLabel"]),o+="}",i.attr("data-bind",o);var u=e.name||n.UUID.createUUID();return i.attr("name",u),r.append(i),r}});return n.Component.register(s,u),u}),define("$model/UI2/system/components/fragment/btnNavBar/btnNavBar",["require","css!./css/btnNavBar","jquery","$UI/system/lib/justep"],function(e){e("css!./css/btnNavBar").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./btnNavBar"),i=n.ViewComponent.extend({constructor:function(e){this.vercialImage="",this.selectedImage="",this.callParent(e)},init:function(e,t){var n=this;this.callParent(e,t),this.$domNode.on("childChanged",function(e,t){t.attrName=="class"&&t.type=="styleChanged"&&(n.showVercialLine(n.vercialImage,t.value),n.showUnderLine(n.selectedImage,t.value))})},showVercialLine:function(t,r){r.indexOf("x-btnNavBar-vlImage")>=0?t?this.$domNode.find(".x-btnNavBar-vl").css("background","url("+e.toUrl(t)+") no-repeat"):n.Util.hint("分隔线样式为图片时，需要设置分隔线图片",{type:"danger"}):this.$domNode.find(".x-btnNavBar-vl").css("background","none")},showUnderLine:function(t,r){if(r.indexOf("x-btnNavBar-ulImage")>=0&&!t){n.Util.hint("选中样式为图片时，需要设置选中图片",{type:"danger"});return}var i;document.all?i="rules":document.getElementById&&(i="cssRules");for(var s=0;s<document.styleSheets.length;s++)for(var o=0;o<document.styleSheets[s][i].length;o++)document.styleSheets[s][i][o].selectorText==".x-btnNavBar-ulImage .btn.active"&&(r.indexOf("x-btnNavBar-ulImage")>=0?t&&(document.styleSheets[s][i][o].style.background="url("+e.toUrl(t)+") bottom center no-repeat"):document.styleSheets[s][i][o].style.background="none")},propertyChangedHandler:function(e,t,n){switch(e){case"vercialImage":t!=n&&this.$domNode&&this.showVercialLine(n,this.$domNode.attr("class"));break;case"selectedImage":t!=n&&this.$domNode&&this.showUnderLine(n,this.$domNode.attr("class"));break;default:this.callParent(e,t,n)}}});return n.Component.register(r,i),i});